!function(e){function t(o){if(i[o])return i[o].exports;var r=i[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="/",t(0)}([function(e,t,i){i(1),i(2),i(96),i(97),i(98),i(99),i(100),i(101),i(102),i(103),i(104),i(105),i(106),i(107),i(108),i(109),i(110),i(111),i(112),i(115),i(118),i(119),i(120),i(121),i(122),i(123),i(124),i(125),i(126),i(127),i(128),i(129),i(130),i(131),i(133),i(134),i(135),i(137),i(138),i(139),i(141),i(142),i(143),i(144),i(146),i(154),i(185),i(192),i(206)},function(e,t,i){window.API_URL="/api/",window.FACEBOOK_APP_ID=0x8ad14e6cdb59,window.CURRENT_URL=window.location.href,window.URL_FACEBOOK_SHARE_COUNT="https://api.facebook.com/method/links.getStats?urls=",window.URL_OPEN_SHARE_COUNT="https://opensharecount.com/count.json?url=",window.URL_TWITTER_TWEET="https://twitter.com/intent/tweet?",window.TEXT_TWWET_TITLE="Health and Wellness Social Network",window.TEXT_TWWET_HASHTAG="HealthLink"},function(e,t,i){angular.module("kw.core",["ui.router","angularFileUpload"]).constant("API_URL",API_URL).constant("PAGE_AUTH_STATUSES",{OK:"OK",NOT_LOGGED_IN:"NOT_LOGGED_IN",LACK_OF_PERMISSIONS:"LACK_OF_PERMISSIONS"}).config(["$httpProvider",function(e){e.defaults.headers.common={"Content-Type":"application/json"}}]).run(["PagePermissionService",function(e){e.start()}]),i(3),i(4),i(5),i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(18),i(19),i(21),i(23),i(24),i(25),i(26),i(28),i(29),i(31),i(32),i(34),i(35),i(37),i(38),i(40),i(41),i(43),i(44),i(46),i(47),i(48)},function(e,t){function i(e){Error.call(this,e),this.name="UserNotFoundError",this.message=e,Error.captureStackTrace?Error.captureStackTrace(this,i):this.stack=(new Error).stack}function o(e){Error.call(this,e),this.name="LackOfPermissionsError",this.message=e,Error.captureStackTrace?Error.captureStackTrace(this,o):this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),o.prototype=Object.create(Error.prototype),window.UserNotFoundError=i,window.LackOfPermissionsError=o},function(e,t){function i(){function e(){var e,t;if("undefined"!=typeof document.hidden)e="hidden",t="visibilitychange";else if("undefined"!=typeof document.msHidden)e="msHidden",t="msvisibilitychange";else{if("undefined"==typeof document.webkitHidden)return null;e="webkitHidden",t="webkitvisibilitychange"}return{hidden:e,visibilityChange:t}}return{getVisibilityApiEventNames:e}}angular.module("kw.core").factory("CoreUtils",i)},function(e,t){!function(){function e(e,t,i){var o=this;o.onError=function(e){return e},o.req=function(i,r,n){var a={method:r,url:i},s=angular.extend(a,n||{});return new t(function(t,i){e(s).then(function(e){var o=e.data;200==o.status?t(o):i(o)},function(e){i(e)})}).catch(function(e){throw o.onError(e),e})},o.apiReq=function(e,t,r){var n={};localStorage.sessionId&&(n.headers=angular.extend({Authorization:localStorage.sessionId},r.headers));var a=angular.extend(n,r||{});return o.req(i+e,t,a)},o.get=function(e,t,i){var r=angular.extend({params:t},i||{});return o.apiReq(e,"GET",r)},o.post=function(e,t,i){var r=angular.extend({data:t},i||{});return o.apiReq(e,"POST",r)},o.delete=function(e,t,i){var r=angular.extend({data:t},i||{});return o.apiReq(e,"DELETE",r)},o.put=function(e,t,i){var r=angular.extend({data:t},i||{});return o.apiReq(e,"PUT",r)}}e.$inject=["$http","$q","API_URL"],angular.module("kw.core").service("ApiRequest",e)}()},function(e,t){angular.module("kw.core").factory("CurrentUser",["$q","$timeout","ApiRequest","GlobalEventsManager","CoreUtils","PAGE_AUTH_STATUSES",function(e,t,i,o,r,n){function a(e,t){localStorage.clear();var i=document[r.getVisibilityApiEventNames().hidden];i?window.close():location.href="/login"}var s=null,l=null,c=!1;return o.on("logout",a),{isRestored:function(){return c},restore:function(){var t=this;return null!==l?l.promise:(l=e.defer(),s?(l.resolve(s),l.promise):(i.get("auth/identity").then(function(e){var i=e.user;i.role=i.role.name,t.setIdentity(i),l.resolve(s),l=null},function(e){l.reject(!1)}).finally(function(){c=!0,l=null}),l.promise))},isAuthenticated:function(){return!!s},getIdentity:function(){return s},setIdentity:function(e){s=e},setAvatar:function(e){s&&(s.avatar=e)},getAvatar:function(){return s&&s.avatar},isAdmin:function(){return!!s&&"admin"===s.role},logout:function(){return i.post("auth/logout").then(function(e){return o.emit("logout"),e})},getUser:function(){return this.restore()},authorize:function(e){return 0===e.length?n.OK:s?e.indexOf(s.role)===-1?n.LACK_OF_PERMISSIONS:n.OK:n.NOT_LOGGED_IN}}}])},function(e,t){angular.module("kw.core").service("GlobalEventsManager",["$rootScope",function(e){function t(e,t){return JSON.stringify({event:e,data:t})}function i(e){var t=JSON.parse(e);return{event:t.event,data:t.data}}var o="globalEvent",r={};window.addEventListener("storage",function(t){if(t.key===o){var r=i(t.newValue);e.$emit(r.event,r.data)}}),this.on=function(t,i){e.$on(t,i);r[t]||(r[t]=[]),r[t].push(i)},this.emit=function(i,r){r=r||{},console.log("emit: "+i,r),e.$emit(i,r),localStorage.setItem(o,t(i,r))},this.off=function(e,t){var i=r[e].indexOf(t);i>=0&&(r[e][i](),r[e].splice(i,1),console.log("unsubscribed"))}}])},function(e,t){angular.module("kw.core").factory("InfiniteScrollService",function(){return function(e,t){function i(e){e=e||{},p=e.params||{},c=e.records||[],d=!1,u=!1,m=0}function o(){if(!d){var i=angular.extend(p,{offset:m});return i.order=i.order||"desc",d=!0,e.search(i).then(function(e){return Array.prototype.unshift.apply(c,e.entities),m+=e.entities.length,u=m>=e.count,c}).catch(function(e){t&&t(e)}).finally(function(){d=!1})}}function r(){return c}function n(){return 0===c.length&&d===!1}function a(){return d}function s(){return!u}function l(){return i(),o()}var c,d,u,m,p;return i(),{init:i,getRecords:r,noRecords:n,isLoading:a,paginationVisible:s,loadMore:o,reload:l}}})},function(e,t){angular.module("kw.core").service("NotificationManager",["$timeout",function(e){function t(t){var r=t.ts,n=i.notifications.indexOf(t);i.notifications.splice(n,1),o[r]&&(e.cancel(o[r]),delete o[r])}var i=this,o={};return i.notifications=[],i.addToQueue=function(r,n){var a=Math.random();r=r||("success"===n?"Ok":"Something went wrong");var s={msg:r,type:n,ts:a};i.notifications.push(s),o[a]=e(function(){t(s)},3e3)},i.success=function(e){i.addToQueue(e,"success")},i.danger=function(e){i.addToQueue(e,"danger")},i.removeQueueMemberById=function(e){t(i.notifications[e])},i}])},function(e,t){angular.module("kw.core").service("PagePermissionService",["CurrentUser","$rootScope","$state","PAGE_AUTH_STATUSES","GlobalEventsManager",function(e,t,i,o,r){function n(t,n,a,s){var l=n.data||{},c=l.roles||[],d=l.isPublic||!1;if(document.title=n.data.siteTitle,!e.isRestored()||!d)if(e.isRestored()){var u=e.authorize(c);switch(u){case o.NOT_LOGGED_IN:case o.LACK_OF_PERMISSIONS:default:location.href="/login";break;case o.OK:}}else t.preventDefault(),e.restore().then(function(e){i.go(n.name,a),r.emit("userLogged")},function(e){return d?void i.go(n.name,a):void r.emit("logout")})}this.start=function(){t.$on("$stateChangeStart",n)}}])},function(e,t){angular.module("kw.core").factory("PagerFactory",function(){return function(e,t){function i(i){if(!a)return a=!0,e.search({offset:i>=0?i:0,order:"desc",limit:d}).then(function(e){var t=+e.offset+e.entities.length;return c=+e.offset,n=e.entities,l=c<=0,s=t>=+e.count,n}).catch(function(e){t&&t(e)}).finally(function(e){return a=!1,e})}function o(t){return e.delete(t.id).then(function(e){var i=n.indexOf(t);return e&&i>=0&&(n.splice(i,1),c-=1),e})}function r(e){l&&n.unshift(e),c+=1}var n=[],a=!1,s=!1,l=!0,c=0,d=20;return{removeRecord:o,addRecord:r,load:i,getRecords:function(){return n},isLoading:function(){return a},loadNext:function(){return i(c+d)},loadPrev:function(){return i(c-d)},isNextDisabled:function(){return a||s},isPrevDisabled:function(){return a||l}}}})},function(e,t){angular.module("kw.core").factory("ResourceService",["ApiRequest",function(e){return function(t,i){var o,r={};return o={find:function(i,o){return e.get(t+"/"+i,{field:o})},search:function(i){return e.get(t,i||{})},create:function(i){return e.post(t,i)},update:function(i,o){return e.put(t+"/"+i,o)},delete:function(i){return e.delete(t+"/"+i)},autocomplete:function(i,o){return e.get(t+"/autocomplete",{field:i,q:o}).then(function(e){return e.entities},function(e){console.log(e)})},save:function(e){return e.id?this.update(e.id,e):this.create(e)}},i&&(r=i.call(o,e,t)),angular.extend(r,o)}}])},function(e,t){function i(e,t){return function(i){i=i||{};var o=new e({url:t+"media/private/upload"});for(var r in i)o[r]&&(o[r]=i[r]);return o}}i.$inject=["FileUploader","API_URL"],angular.module("kw.core").factory("NetworkImageUploader",i)},function(e,t){angular.module("kw.core").factory("ZiggeoUploader",["ApiRequest",function(e){function t(e,t,i){var o=new ZiggeoApi.V2.Recorder({element:document.getElementById(t),attrs:{height:this.recorderSettings.height,theme:this.recorderSettings.theme,themecolor:this.recorderSettings.themeColor,"input-bind":i,responsive:this.recorderSettings.responsive}});o.activate(),this.embedding=ZiggeoApi.V2.Player.findByElement(document.getElementById(t)),this.embedding.on("verified",function(){e.saveVideo(o.get("video"))}),this.embedding.on("upload_progress",e.videoUploadProgress),this.embedding.on("error",e.videoError)}var i={theme:"modern",themeColor:"green",responsive:!0,height:240};return function(){return{createRecorder:t,recorderSettings:i}}}])},function(e,t){angular.module("kw.core").directive("attachmentControl",function(){return{restrict:"E",scope:{heading:"@",btnClass:"@",bodyClass:"@",btnFor:"@"},link:function(e,t,i){var o=$(t);i.heading&&o.on("click",".attachment-control-btn",function(e){o.toggleClass("active"),$(e.target).toggleClass("active")})},transclude:!0,replace:!0,template:'\t                <div class="attachment-control">\t                    <div class="attachment-control-body {{bodyClass}}">\t                        <div class="attachment-control-heading">{{heading}}</div>\t                        <div class="attachment-control-content" ng-transclude></div>\t                    </div>\t                    <label class="btn btn-sm attachment-control-btn {{btnClass}}" for="{{btnFor}}"></label>\t                </div>'}})},function(e,t,i){angular.module("kw.core").directive("customTextInput",function(){return{restrict:"E",require:"^form",scope:{placeholder:"@",customClass:"@",ngModel:"=",required:"@",name:"@",min:"@",max:"@",specialChars:"@"},template:i(17),link:function(e,t,i,o){var r={minLetters:1,specialChars:" ._-",maxLetters:null};e.requiredStatus="undefined"!=typeof e.required,e.requiredMessage="This field is required.";var n=function(e){var t=e.trim().split("");if(0===t.length)return".";var i=" and ";return t.forEach(function(e,t,o){i+=t<o.length-1?'"'+e+'",':'"'+e+'" '+(o.length>1?"symbols":"symbol")+"."}),i},a=function(e,t,i){if(t<=0&&i<=0)return!0;var o=e.match(/[a-zA-Z]/g);return!!o&&!(o.length<t||o.length>i&&null!==i)},s=function(e){return e.indexOf(" ")>-1?", spaces":""},l=function(e,t){var i="at least ";return 0===e&&1===t?"not more than "+t+" character.":0===e&&t>1?"not more than "+t+" characters.":1===e&&null===t?i+e+" character.":e>1&&null===t?i+e+" characters.":e>1&&t>0?i+e+" and not more than "+t+" characters.":t>0?i+e+" and not more than "+t+" characters.":void 0};e.form=o,e.inputForm=e.form[e.name];var c=r.specialChars,d=r.minLetters,u=r.maxLetters;angular.isUndefined(e.specialChars)||(c=e.specialChars);var m="^[a-zA-Z0-9"+c+"]+$";e.pattern=new RegExp(m),e.patternMessage="Field can contain numbers, letters"+s(c)+n(c),!angular.isUndefined(e.min)&&e.min>0&&(d=e.min),!angular.isUndefined(e.max)&&e.max>0&&(u=e.max),e.letterMessage="Field must contain "+l(d,u),e.inputForm.$validators.letters=function(t,i){return!!e.inputForm.$isEmpty(t)||!!a(t,d,u)}}}})},function(e,t){e.exports='<div class=input-container> <input type=text name={{name}} placeholder={{placeholder}} class={{customClass}} ng-model=ngModel ng-required=requiredStatus ng-pattern=pattern /> <div ng-show="inputForm.$invalid && inputForm.$dirty"> <span class=text-danger ng-show=inputForm.$error.required>{{requiredMessage}}</span> <span class=text-danger ng-show=inputForm.$error.pattern>{{patternMessage}}</span> <span class=text-danger ng-show=inputForm.$error.letters>{{letterMessage}}</span> </div> </div>'},function(e,t,i){i(19),angular.module("kw.core").component("mediaset",{controller:"MediasetController",template:i(20),bindings:{mset:"=",loader:"=",retryItemUpload:"&",discardUploadedItem:"&"}})},function(e,t){!function(){function e(e,t,i,o,r,n){var a=this;a._NotificationManager=n,a.mediaItemsRoot=t,a.videoUploader=new r,a.currentMediasetLength=0,a.breakpoints=[{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}],a.galleryOptions={fadeDuration:.7,resizeDuration:.5,fitImageInViewPort:!0,positionFromTop:20,showImageNumberLabel:!1,alwaysShowNavOnTouchDevices:!1,wrapAround:!1},a.hasMediasetChanged=function(){return"undefined"!=typeof a.mset&&a.mset.length>0&&(a.mset.length===a.currentMediasetLength||(a.currentMediasetLength=a.mset.length,!1))},a.showGallery=function(t){a.loader||(a.images=s(a.mset),e.open(a.images,t,a.galleryOptions))},a.removeItem=function(e){var t={delete_file:!0,file_folder:"private",id:a.mset[e].mediaitemId};o.removeItem(t).then(function(t){a.mset[e].path&&a.discardUploadedItem({item:a.mset[e]}),a.mset.splice(e,1),a._NotificationManager.addToQueue("Item successfully removed!","success")},function(e){a._NotificationManager.addToQueue("An error ocurred while trying to remove the selected item. Please try again.","danger")})},a.formatMediaItemPath=function(e){return e.path?a.mediaItemsRoot+e.path+c(e,"md")+"/"+l(e):""};var s=function(e){return e.map(function(e){return{src:a.mediaItemsRoot+e.path+"/"+l(e),thumb:a.mediaItemsRoot+e.path+c(e,"md")+"/"+l(e)}})},l=function(e){return e.meta_data&&e.meta_data.length>0?e.meta_data[0].extension:""},c=function(e,t){var i="-";if(e.meta_data&&e.meta_data.length>0){var o=e.meta_data[0].meta_data.sizes;return o.indexOf(t)>-1?i+o[o.indexOf(t)]:i+o[0]}return""};i.$on("Ziggeo.Show.Recorder",function(e,t){a.showRecorder=!0,setTimeout(function(){a.videoUploader.createRecorder(t,"ziggeo-video-recorder","videotoken")})}),i.$on("Ziggeo.Hide.Recorder",function(){a.showRecorder=!1})}e.$inject=["lightbox","mediaItemsRoot","$scope","MediaItemsService","ZiggeoUploader","NotificationManager"],angular.module("kw.core").controller("MediasetController",e)}()},function(e,t){e.exports='<div class=mediaset-container> <div ng-hide=$ctrl.mset.length ng-if=$ctrl.loader> There\'s no media attached to this post. </div> <slick class="slider single-item" ng-if=$ctrl.hasMediasetChanged() responsive=$ctrl.breakpoints slides-to-show=3 slides-to-scroll=1> <div ng-repeat="img in $ctrl.mset"> <div ng-if=$ctrl.loader class=mediaset-remove ng-click=$ctrl.removeItem($index)> <i class="fa fa-trash-o"></i> </div> <div ng-if=$ctrl.loader class=mediaset-uploaded ng-show="img.status == \'uploaded\'"> <i class="fa fa-check"></i> </div> <div ng-if=$ctrl.loader class=mediaset-uploaded ng-show="img.status == \'uploading\'"> <i class="fa fa-refresh fa-spin fa-fw"></i> </div> <div ng-if=$ctrl.loader class=mediaset-failed ng-show="img.status == \'failed\'" ng-click="$ctrl.retryItemUpload({item: img})"> <i class="fa fa-warning"></i> </div> <img ng-if="!$ctrl.loader && img.file_type == \'image\'" class=mediaset-image ng-click=$ctrl.showGallery($index) ng-src="{{img.src ? img.src : $ctrl.formatMediaItemPath(img)}}"> <div ng-if="$ctrl.loader && img.file_type == \'image\'" class=mediaset-img-preview ng-style=img.bgStyle()></div> <ziggeoplayer ng-if="img.file_type == \'video\'" ziggeo-video={{img.path}} ziggeo-theme=minimalist ziggeo-themecolor=green ziggeo-playfullscreenonmobile=true ziggeo-responsive=true></ziggeoplayer> </div> </slick> <div id=ziggeo-video-recorder ng-if=$ctrl.showRecorder></div> <div class=mediaset-clearboth></div> </div>'},function(e,t,i){i(21),angular.module("kw.core").component("mediasetLoader",{controller:"MediasetLoaderController",template:i(22),bindings:{mset:"=",uploadFileByItem:"=",type:"<"}})},function(e,t){e.exports='<div class=mediaset-loader-container ng-if="$ctrl.type == \'image\'"> <attachment-control ng-click=$ctrl.attachImage() btn-class=btn-blue btn-for=postEditorUploader></attachment-control> <input id=postEditorUploader type=file nv-file-select="" uploader=$ctrl.imageUploader multiple=multiple class=hidden /> <div class=mediaset-bottom></div> </div> <div class="mediaset-loader-container video-recorder" ng-if="$ctrl.type == \'video\' && !$ctrl.videoUploadEnabled()"> <input id=videotoken type=hidden ng-model=$ctrl.videotoken ng-change=$ctrl.videoUploaded() class=hidden name=videotoken /> <attachment-control ng-click=$ctrl.toggleVideo() btn-class=btn-orange></attachment-control> <div class=mediaset-bottom></div> </div>'},function(e,t){!function(){function e(e,t,i,o){function r(){var t=e({onSuccessItem:function(e,t){var i=s.getItemInMediasetById(e.id);i&&t.entity&&(i.path=t.entity.path,i.mediaitemId=t.entity.id,i.metadata=t.entity.meta_data,i.status="uploaded")},onProgressAll:function(e){s.showProgress=!0,s.progress=e},onBeforeUploadItem:function(e){},onAfterAddingFile:function(e){n(e._file,function(t){s.imgOrientation=t,loadImage(e._file,function(t){var i=new FileReader;i.id=++s.mediasetCounter,i.onload=function(i){var o=document.createElement("canvas"),r=o.getContext("2d");o.height=t.naturalHeight,o.width=t.naturalWidth;var n=t.height,a=t.width;switch(s.imgOrientation){case 1:r.drawImage(t,0,0,a,n);break;case 2:r.translate(a,0),r.scale(-1,1),r.drawImage(t,0,0,a,n);break;case 3:r.translate(a,n),r.rotate(Math.PI),r.drawImage(t,0,0,a,n);break;case 4:r.translate(0,n),r.scale(1,-1),r.drawImage(t,0,0,a,n);break;case 5:r.rotate(Math.PI/2),r.scale(1,-1),r.drawImage(t,0,0,a,n);break;case 6:r.rotate(Math.PI/2),r.translate(0,-n),r.drawImage(t,0,0,a,n);break;case 7:r.rotate(Math.PI/2),r.translate(a,-n),r.scale(-1,1),r.drawImage(t,0,0,a,n);break;case 8:r.rotate(-Math.PI/2),r.translate(-a,0),r.drawImage(t,0,0,a,n);break;default:r.drawImage(t,0,0,a,n)}s.imgBase64=o.toDataURL(),s.imageUploader.uploadItem(e),s.mset.push({localId:this.id,src:s.imgBase64,bgStyle:function(){return{backgroundImage:"url('"+this.src+"')"}},file_type:"image",status:"uploading",path:""})},i.readAsDataURL(e._file),e.id=s.mediasetCounter},{orientation:t,canvas:!0})})},onErrorItem:function(e){var t=s.getItemInMediasetById(e.id);t&&(t.status="failed")},onWhenAddingFileFailed:function(e){},onCancelItem:function(e){}});return t}function n(e,t){console.log(e);var i=new FileReader;i.onload=function(e){var i=new DataView(e.target.result);if(65496!=i.getUint16(0,!1))return t(-2);for(var o=i.byteLength,r=2;r<o;){var n=i.getUint16(r,!1);if(r+=2,65505==n){if(1165519206!=i.getUint32(r+=2,!1))return t(-1);var a=18761==i.getUint16(r+=6,!1);r+=i.getUint32(r+4,a);var s=i.getUint16(r,a);r+=2;for(var l=0;l<s;l++)if(274==i.getUint16(r+12*l,a))return t(i.getUint16(r+12*l+8,a))}else{if(65280!=(65280&n))break;r+=i.getUint16(r,!1)}}return t(-1)},i.readAsArrayBuffer(e.slice(0,65536))}function a(e){var t={path:e,file_type:"video",media_meta_data:[{extension:"",meta_data:{sizes:[]}}]};i.createMediaItem(t).then(function(e){c(e)})}var s=this;s.init=function(){s._NotificationManager=o,s.imageUploader=r(),s.mset=[],s.videoSettings={files:1,duration:60,size:10240},s.showProgress=!1,s.showRecorder=!1,s.mediasetCounter=0},s.init(),s.$onInit=function(){s.uploadFileByItem=l},s.videoUploadEnabled=function(){return"undefined"!=typeof s.mset&&s.videoSettings.files===s.mset.filter(function(e,t){return"video"==e.file_type}).length},s.getItemInMediasetById=function(e){var t=-1;return s.mset.some(function(i,o){return i.localId===e&&(t=o)}),s.mset[t]},s.getFileInQueueById=function(e){var t=-1;return s.imageUploader.queue.some(function(i,o){return i.id===e&&(t=o)}),s.imageUploader.queue[t]};var l=function(e){e.status="uploading";var t=s.getFileInQueueById(e.localId);s.imageUploader.uploadItem(t)},c=function(e){"undefined"!=typeof e&&(s.mset.push({mediaitemId:e.id,src:e.path,bgStyle:function(){return{backgroundColor:"rgba(0,0,0,0)"}},file_type:"video",status:"uploaded",path:e.path}),p())},d=function(e,t){},u=function(e){s._NotificationManager.addToQueue("An error ocurred while processing video. Please try again.","danger")};s.toggleVideo=function(){s.showRecorder=!s.showRecorder,s.showRecorder?m():p()};var m=function(){t.$broadcast("Ziggeo.Show.Recorder",{videoUploadProgress:d,videoError:u,saveVideo:a})},p=function(){t.$broadcast("Ziggeo.Hide.Recorder")}}e.$inject=["NetworkImageUploader","$rootScope","MediaItemsService","NotificationManager"],angular.module("kw.core").controller("MediasetLoaderController",e)}()},function(e,t){angular.module("kw.core").factory("MediaItemsService",["ApiRequest",function(e){function t(t){return e.post("media-items",t).then(function(e){return e.entity})}function i(t){return e.delete("media-items/"+t.id,t).then(function(e){return 200==e.status})}return{createMediaItem:t,removeItem:i}}])},function(e,t){angular.module("kw.core").factory("UsersResource",["ResourceService",function(e){return e("users",function(e,t){return{profile:function(i){return e.get(t+"/"+i+"/profile").then(function(e){return e.profile})}}})}])},function(e,t,i){angular.module("kw.core").component("customPrint",{controller:"CustomPrintController",template:i(27),bindings:{settings:"="}})},function(e,t){e.exports="<div class=custom-print-container> <custom-print-date selected=$ctrl.chart.month enable=$ctrl.chart.visibility></custom-print-date> <custom-print-chart-grid settings=$ctrl.chart.settings></custom-print-chart-grid> </div>"},function(e,t){!function(){function e(e){var t=this;t.init=function(){t.settings={month:{},visibility:"hidden",header:{},footer:{},rows:[{cols:[{type:"title",title:"Title",titleFormat:{align:"center"}}]},{cols:[{type:"chart",chartTitle:"Title",chartType:"pie",chartData:[]}]},{cols:[{type:"text",title:"Title",text:"Lorem ipsum dolor sit amet..."}]}]}}}e.$inject=["$scope"],angular.module("kw.core").controller("CustomPrintController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintDate",{controller:"CustomPrintDateController",template:i(30),bindings:{selected:"=",monthChanged:"&"}})},function(e,t){e.exports='<div class=custom-print-selector> <form> <div class=form-group> <select name=customPrintDate data-ng-model=$ctrl.month ng-options="item.name for item in $ctrl.months track by item.id"> </select> <button class="btn btn-mint btn-update-background" title=Print ng-click="$ctrl.monthChanged({month: $ctrl.month})"></button> </div> </form> </div>'},function(e,t){!function(){function e(e){var t=this;t.$onInit=function(){var i=e("filter")(t.months,{id:t.selected});i.length>0&&(t.month=i[0])},t.init=function(){t.months=[{name:"Select a Month",selected:!0},{id:0,name:"January"},{id:1,name:"February"},{id:2,name:"March"},{id:3,name:"April"},{id:4,name:"May"},{id:5,name:"June"},{id:6,name:"July"},{id:7,name:"August"},{id:8,name:"September"},{id:9,name:"October"},{id:10,name:"November"},{id:11,name:"December"}],t.month=t.months[0]},t.init()}e.$inject=["$filter"],angular.module("kw.core").controller("CustomPrintDateController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintChartGrid",{controller:"CustomPrintChartGridController",template:i(33),bindings:{month:"="}})},function(e,t){e.exports="<div class=row> </div>"},function(e,t){!function(){function e(){}angular.module("kw.core").controller("CustomPrintChartGridController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintChart",{controller:"CustomPrintChartController",template:i(36),bindings:{data:"<",labels:"<",chartColors:"<",options:"<",series:"<"}})},function(e,t){e.exports='<div> <canvas id=line ng-if="$ctrl.options.type == \'linear\'" class="chart chart-line" chart-data=$ctrl.data chart-labels=$ctrl.labels chart-options=$ctrl.options chart-dataset-override=$ctrl.datasetOverride chart-click=$ctrl.onClick chart-series=$ctrl.series chart-colors=$ctrl.colors> </canvas> <canvas id=doughnut class="chart chart-doughnut" ng-if="$ctrl.options.type == \'doughnut\'" chart-data=$ctrl.data chart-labels=$ctrl.labels> </canvas> <canvas id=bar class="chart chart-bar" ng-if="$ctrl.options.type == \'bar\'" chart-data=$ctrl.data chart-labels=$ctrl.labels chart-series=$ctrl.series chart-options=$ctrl.options> </canvas> </div>'},function(e,t){!function(){function e(){var e=this;this.$onInit=function(){if("undefined"!=typeof e.chartColors)switch(e.chartColors.length){case 1:e.colors=[e.chartColors[0],e.chartColors[0],e.chartColors[0],e.chartColors[0],e.chartColors[0],e.chartColors[0],e.chartColors[0]];break;case 2:e.colors=[e.chartColors[1],e.chartColors[0],e.chartColors[0],e.chartColors[1],e.chartColors[1],e.chartColors[1],e.chartColors[1]];break;case 7:e.colors=e.chartColors}("bar"==e.options.type||e.series.length>1&&"linear"==e.options.type)&&(e.options.legend={display:!0,labels:{fontColor:"rgba(0,0,0,0.8)"}})},e.$onChanges=function(){if(0!==e.data.length)return"number"==typeof e.data[0]?void(t(e.data)?e.options.scales.yAxes[0].ticks={}:i()):"object"==typeof e.data[0]?void(e.data.some(t)?e.options.scales.yAxes[0].ticks={}:i()):void 0};var t=function(e){return e.some(function(e){return e>0})},i=function(){e.options.scales.yAxes[0].ticks={min:0,max:5}};e.init=function(){e.options=e.options||{scales:{}},Chart.defaults.global.scaleBeginAtZero=!0,"doughnut"!=e.options.type&&(e.datasetOverride=[{yAxisID:"y-axis-1"}])},e.init()}angular.module("kw.core").controller("CustomPrintChartController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintFooter",{controller:"CustomPrintFooterController",template:i(39),bindings:{settings:"="}})},function(e,t){e.exports="<div class=custom-print-footer> </div>"},function(e,t){!function(){function e(){}angular.module("kw.core").controller("CustomPrintFooterController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintGrid",{controller:"CustomPrintGridController",template:i(42),bindings:{data:"=",settings:"="}})},function(e,t){e.exports="<div data-ng-class=$ctrl.element.class> </div>"},function(e,t){!function(){function e(){var e=this;e.element={},e.init=function(){e.element.class="col-sm-6"},e.buildElement=function(){}}angular.module("kw.core").controller("CustomPrintGridController",e)}()},function(e,t,i){angular.module("kw.core").component("customPrintHeader",{controller:"CustomPrintHeaderController",template:i(45),bindings:{settings:"="}})},function(e,t){e.exports="<div class=custom-print-footer> </div>"},function(e,t){!function(){function e(){}angular.module("kw.core").controller("CustomPrintHeaderController",e)}()},function(e,t){angular.module("kw.core").factory("CanvasToImage",["$q",function(e){function t(t,i){var o=e.defer();return html2canvas(t,{onrendered:function(e){o.resolve(e.toDataURL("image/png"))}}),o.promise}return{getImage:t}}])},function(e,t){angular.module("kw.core").factory("PDFCreator",["$q",function(e){function t(e){return new jsPDF({orientation:e.orientation,unit:e.unit,format:[e.format.page.x,e.format.page.y]})}function i(e,i){var o=t(i);o.text(i.title,i.format.title.x,i.format.title.y),o.addImage(e.chart,"PNG",i.format.chart.x,i.format.chart.y,200,100),o.save(i.filename)}function o(e,i){var o=t(i);o.text(i.title,i.format.title.x,i.format.title.y),o.addImage(e.chart,"PNG",i.format.chart.x,i.format.chart.y,200,100),o.autoTable(e.tableData.cols,e.tableData.rows,{startY:i.format.chart.y+105}),o.save(i.filename)}function r(e,i,o){var r=0,n=t(i);if(n.text(i.title,i.format.title.x,i.format.title.y),r+=i.format.title.y,angular.forEach(e.charts,function(e,t){n.text(e.title,e.x,e.y-15);var i=200,o=e.height*i/e.width;n.addImage(e.chart,"JPEG",e.x,e.y,i,o),r=r+e.y+50}),n.autoTable(e.tableData.cols,e.tableData.rows,{startY:r+20,styles:{overflow:"linebreak"},pageBreak:"avoid"}),"download"===o)n.save(i.filename);else{var a='<iframe src="'+n.output("datauristring")+'" frameborder="0" width="100%" height="100%" allowfullscreen webkitallowfullscreen></iframe>',s=window.open();s.document.write(a),s.document.title=i.filename}}function n(e,i){var o=0,r=t(i),n=r.internal.pageSize.width,a=r.internal.pageSize.height;r.text(i.title,i.format.title.x,i.format.title.y),o+=i.format.title.y,angular.forEach(e.elements,function(e,t){switch(i.format.page.y-o<i.format.minimumBottomSpace&&(doc.addPage(),o=0),e.type){case"header":r.addImage(e.chart,"PNG",0,0,n,a);break;case"footer":r.addImage(e.chart,"PNG",e.element.x,e.element.y,n,a);break;case"table":break;default:r.text(e.title,e.element.x-15,e.element.y-15),r.addImage(e.chart,"PNG",e.element.x,e.element.y)}}),r.save(i.filename)}return{createSingleImagePDFReport:i,createImageAndTablePDFReport:o,createMultiImageSingleTablePDFReport:r,createComplexPDFReport:n}}])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){angular.module("kw.socialNetwork",["kw.core","ui.bootstrap","ngSanitize","ngScrollbars","ngWig","mentio","chart.js","slickCarousel","ngBootstrapLightbox","ui.mask","720kb.socialshare","cp.ngConfirm"]).constant("appRoot","/assets/js/app/social-network/").constant("apiRoot","/api").constant("sharedPostRoot","/social-network/public-posts/").constant("mediaItemsRoot","/api/media/private/").constant("defaultAvatar","/img/social-network/default-avatar.png").run(["$rootScope","utilities","CurrentUser","SnNotifications","GlobalEventsManager","enums","NotificationManager",function(e,t,i,o,r,n,a){e.isCurrentUserAdmin=function(){return i.isAdmin()},e.NotificationManager=a,e.SnNotifications=o,e.logout=i.logout,e.CurrentUser=i,e.enums=n;var s=new MobileDetect(window.navigator.userAgent);e.isMobile=null!==s.mobile();new ZiggeoApi.V2.Application({token:"0a3e26da1e69d33ddf86907a4fe4d179"});ZiggeoApi.V2.Locale.setLocale("en")}]).config(["ChartJsProvider",function(e){e.setOptions({colors:["#803690","#00ADF9","#DCDCDC","#46BFBD","#FDB45C","#949FB1","#4D5360"],responsive:!0}),Chart.pluginService.register({beforeDraw:function(e,t){var i=e.chart.ctx;i.save(),i.fillStyle="white",i.fillRect(0,0,e.canvas.width,e.canvas.height),i.restore()}})}])},function(e,t){angular.module("kw.socialNetwork").config(["$stateProvider","$urlRouterProvider","appRoot","$httpProvider","$locationProvider",function(e,t,i,o,r){t.when("/health-data","/health-data/biometrics").when("/network","network/posts").when("/network/notifications","/network/notifications/partner-requests").when("","/network/posts").when("/health-data/administrate","/health-data/administrate/exercises").otherwise(function(e,t){var i=e.get("$state");i.go("network.posts")}),e.state("socialNetwork",{abstract:!0,data:{roles:["member","admin"],siteTitle:"HealthLink Social Network"},template:"<ui-view>"}).state("health-data",{parent:"socialNetwork",url:"/health-data",template:"<health-data></health-data>"}).state("health-data.wellness-summary",{url:"/wellness-summary",template:"<wellness-summary></wellness-summary>",data:{siteTitle:"Wellness Summary"}}).state("health-data.biometrics",{url:"/biometrics",template:"<biometrics demo-mode='false'></biometrics>",data:{siteTitle:"Biometrics"}}).state("health-data.exercise-log",{url:"/exercise-log",template:"<exercise-log></exercise-log>",data:{siteTitle:"Exercise Log"}}).state("health-data.diet-log",{url:"/diet-log",template:"<diet-log></diet-log>",data:{siteTitle:"Diet Log"}}).state("health-data.medication-log",{url:"/medication-log",template:"<medication-log></medication-log>",data:{siteTitle:"Medication Log"}}).state("health-data.administrate",{url:"/administrate",data:{siteTitle:"Custom Options"},template:"<administrate-logs></administrate-logs>"}).state("health-data.administrate-exercises",{parent:"health-data.administrate",url:"/exercises",template:"<administrate-exercises></administrate-exercises>"
}).state("health-data.administrate-foods",{parent:"health-data.administrate",url:"/foods",template:"<administrate-foods></administrate-foods>"}).state("health-data.administrate-medications",{parent:"health-data.administrate",url:"/medications",template:"<administrate-medications></administrate-medications>"}).state("partners",{parent:"socialNetwork",url:"/partners",template:"<partners></partners>",data:{siteTitle:"Partners"}}).state("my-account",{parent:"socialNetwork",url:"/my-account",template:"<my-account></my-account>"}).state("my-account.profile",{url:"/profile",template:"<my-profile></my-profile>",data:{siteTitle:"My profile"}}).state("my-account.health-goals",{url:"/health-goals",template:"<my-health-goals></my-health-goals>",data:{siteTitle:"My Goals"}}).state("my-account.settings",{url:"/settings",template:"<my-settings></my-settings>",data:{siteTitle:"Settings"}}).state("userProfile",{parent:"socialNetwork",url:"/user-profile/:username",template:"<user-profile></user-profile>",data:{siteTitle:"User Profile"}}).state("network",{parent:"socialNetwork",url:"/network",template:"<network></network>"}).state("network.post",{url:"/post/:id",template:"<sn-post post='$resolve.post'/>",resolve:{post:["ResourceService","$stateParams",function(e,t){return e("snposts").find(t.id).then(function(e){return e.entity})}]},data:{siteTitle:"Network Post"}}).state("network.posts",{url:"/posts",template:"<posts></posts>",data:{siteTitle:"Network"}}).state("network.my-activity",{url:"/my-activity",resolve:{userId:["CurrentUser",function(e){return e.getIdentity().id}]},template:"<posts user-id='$resolve.userId'></posts>",data:{siteTitle:"My activity"}}).state("network.notifications",{url:"/notifications",template:"<notifications></notifications>",data:{siteTitle:"Notifications"}}).state("network.notifications.partnerRequests",{url:"/partner-requests",template:"<partner-requests></partner-requests>",data:{siteTitle:"Partner Requests"}}).state("network.notifications.reactions",{url:"/reactions",template:"<reactions></reactions>",data:{siteTitle:"Reactions"}}).state("network.notifications.updates",{url:"/updates",template:"<updates></updates>",data:{siteTitle:"Updates"}}).state("public-post",{parent:"socialNetwork",url:"/public-posts/:id",template:"<sn-post post='$resolve.post'/>",resolve:{post:["ResourceService","$stateParams",function(e,t){return e("snposts").find(t.id).then(function(e){return e.entity})}]},data:{siteTitle:"Network Post",isPublic:!0}}),r.html5Mode(!0)}])},function(e,t){angular.module("kw.socialNetwork").factory("PartnerRequestsResource",["ResourceService",function(e){return e("partner-requests")}]).factory("ReactionsResource",["ResourceService",function(e){return e("reactions")}]).factory("SnUpdatesResource",["ResourceService",function(e){return e("snupdates")}]).factory("SnPostsResource",["ResourceService",function(e){return e("snposts")}]).service("SnNotificationsResource",["ApiRequest","$q",function(e,t){var i="user/notifications/counters";this.loadCounters=function(){return e.get(i).then(function(e){return e.counters})},this.loadCounter=function(t){return e.get(i+"/"+t).then(function(e){return e.counter})}}]).factory("ExercisesResource",["ResourceService",function(e){return e("exercises")}]).factory("FoodsResource",["ResourceService",function(e){return e("foods")}]).factory("MedicationsResource",["ResourceService",function(e){return e("medications")}])},function(e,t){angular.module("kw.socialNetwork").factory("enums",function(){var e={caches:{weightCache:"Weight",systolicBloodPressureCache:"systolicBloodPressure",diastolicBloodPressureCache:"diastolicBloodPressure",heartRateCache:"heartRate",bloodGlucoseLevelCache:"bloodGlucoseLevel",bloodPressureCache:"bloodPressure",exerciseLogCache:"exerciseLog",dietLogCache:"dietLog",medicationLogCache:"medicationLog"},intervalTypes:{day:"day",week:"week",month:"month",year:"year"},genders:[{id:1,name:"Male"},{id:2,name:"Female"}],biometricParameterTypes:{height:2,weight:1,systolicBloodPressure:3,diastolicBloodPressure:4,heartRate:6,bloodGlucoseLevel:5,bloodPressure:7,all:0},goalsTypes:{private:0,common:1},postColors:{red:"#fce4ec",purple:"#f8eeff",blue:"#e4f4ff",green:"#dcffe4",yellow:"#fffbc3",orange:"#fff3e6",brown:"#f6eae2",gray:"#f6f6f6"},groupTypes:{DEFAULT:1,NETWORK:2,PARTNER:3},partnershipTypes:{PENDING:1,ACCEPTED:2,DENIED:3},notificationTypes:{POST_COMMENT:1,POST_CARE:2,POST_MENTION:3,POST_SHARE:4,POST_PROFILE:5,COMMENT_REPLY:6,COMMENT_CARE:7,COMMENT_MENTION:8},exerciseTypes:{CARDIO:1,STRENGTH:2},dataTypes:{simple:"simple",complex:"complex"}};return e})},function(e,t){angular.module("kw.socialNetwork").service("SnNotifications",["CoreUtils","$interval","$rootScope","SnNotificationsResource",function(e,t,i,o){function r(){var e=document[c.hidden];e?s.stopListenServer():s.startListenServer()}function n(e){i.$apply(function(){e.key===l&&(d=JSON.parse(e.newValue))})}function a(){return localStorage[l]?JSON.parse(localStorage[l]):{requests:0,updates:0,reactions:0,received:0}}var s=this,l="notifications",c=e.getVisibilityApiEventNames(),d=a();this.start=function(){return null===c?void console.warn("Tab visibility api isn't supported"):(r(),document.addEventListener(c.visibilityChange,r),void window.addEventListener("storage",n))},this.pause=function(){c&&document.removeEventListener(c.visibilityChange,r)};var u;this.startListenServer=function(){console.info("Server listener started"),u=t(s.updateCounters,1e4)},this.stopListenServer=function(){console.info("Server listener stopped"),t.cancel(u)},this.updateCounters=function(){return o.loadCounters().then(function(e){return s.setCounters(e),d})},this.getCounters=function(){return d},this.setCounters=function(e){d=e,localStorage.setItem(l,JSON.stringify(d))},this.updateCounter=function(e){return o.loadCounter(e).then(function(t){return d[e]=t[e],s.setCounters(d),d[e]})},this.getCounter=function(e){return d[e]},this.getCountersSum=function(){return d.requests+d.updates+d.reactions}}])},function(e,t){angular.module("kw.socialNetwork").filter("formatTime",function(){return function(e,t){var i=e;return"string"==typeof e&&(i=new Date(e)),"number"==typeof i?moment.unix(i).format(t||"DD MMM YYYY"):moment(i).format(t||"DD MMM YYYY")}}).filter("relativeTime",function(){return function(e){var t=e;return"string"==typeof e&&(t=new Date(moment(e))),moment(t).fromNow()}}).filter("formatGoalTime",["formatTimeFilter",function(e){return function(t){return t&&t.achieved?e(t.log_timestamp):"Pending"}}]).filter("anchorize",["$sce",function(e){return function(t){return e.trustAsHtml(t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(http[^\s]+)/g,'<a target="_blank" href="$1">$1</a>').replace(/(@([a-z0-9]+))/gi,'<a href="#/user-profile/$2">$1</a>'))}}]).filter("makeShortText",function(){return function(e){e=e||"post";var t=e.split(" ");return t.length>5&&(t=t.slice(0,6),t.push("...")),t.join(" ")}}).filter("userLocation",function(){return function(e){var t=[];return e.country&&t.push(e.country),e.state&&t.push(e.state),e.city&&t.push(e.city),t.join(", ")}}).filter("userPartnerStatus",["enums",function(e){return function(t){return t===e.partnershipTypes.PENDING?"Pending":t===e.partnershipTypes.ACCEPTED?"Accepted":t===e.partnershipTypes.DENIED?"Denied":"Invite"}}]).filter("invitationStatusCssClass",["enums","partnersRepository",function(e,t){return function(t){return t===e.partnershipTypes.PENDING?"pending":t===e.partnershipTypes.ACCEPTED?"accepted":t===e.partnershipTypes.DENIED?"denied":"invite btn btn-mint"}}]).filter("userProfilePartnershipLabel",["enums",function(e){return function(t){return t===e.partnershipTypes.PENDING?"Cancel Invite":t===e.partnershipTypes.ACCEPTED?"Remove Invite":(t===e.partnershipTypes.DENIED,"Invite")}}]).filter("exerciseType",["enums",function(e){return function(t){switch(t){case e.exerciseTypes.CARDIO:return"Cardio";case e.exerciseTypes.STRENGTH:return"Strength";default:return"Not found"}}}])},function(e,t){angular.module("kw.socialNetwork").factory("utilities",["enums","appRoot",function(e,t){function i(t){switch(t){case e.intervalTypes.day:return"Hour";case e.intervalTypes.week:return"Day";case e.intervalTypes.month:return"Week";case e.intervalTypes.year:return"Month"}}function o(e,t){t=t||moment().year();var i={};return i.from=moment().month(e).year(t).startOf("month").toDate(),i.to=moment().month(e).year(t).endOf("month").toDate(),i}function r(e){return t+e}function n(e){return e=e||new Date,+e/1e3|0}function a(e){if(e)return new Date(1e3*e)}function s(e){return moment(e).format("YYYY-MM-DD")}function l(e){return moment(e).format("YYYY-MM-DD HH:mm:ss")}function c(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function d(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}function u(e,t){return t<d()}function m(t,i,o){var r={from:t,to:i};if(!u(t,i))return r;t=i,r.from=t;var n=moment(r.to).startOf("month").toDate();switch(o){case e.intervalTypes.day:r.to=new Date(t.getFullYear(),t.getMonth(),t.getDate()+30,t.getHours());break;case e.intervalTypes.week:r.to=new Date(t.getFullYear(),t.getMonth(),t.getDate()+7);break;case e.intervalTypes.month:r.to=new Date(n.getFullYear(),n.getMonth()+2,n.getDate());break;case e.intervalTypes.year:r.to=new Date(t.getFullYear(),t.getMonth()+5,t.getDate())}return r}function p(t,i,o){var r={from:t,to:i};i=t,r.to=i;var n=moment(i).startOf("month").toDate();switch(o){case e.intervalTypes.day:r.from=new Date(i.getFullYear(),i.getMonth(),i.getDate()-30);break;case e.intervalTypes.week:r.from=new Date(i.getFullYear(),i.getMonth(),i.getDate()-7);break;case e.intervalTypes.month:r.from=new Date(n.getFullYear(),n.getMonth()-2,n.getDate());break;case e.intervalTypes.year:r.from=new Date(i.getFullYear(),i.getMonth()-5,i.getDate())}return r}function g(e,t){var i=d();(!t||t>i)&&(t=i),e=i,e.setMonth(e.getMonth()-1)}function f(t,i,o){var r=d();(!i||i>r)&&(i=r);var n=moment(i).startOf("isoWeek").toDate(),a=moment(i).startOf("month").toDate();switch(o){case e.intervalTypes.day:t=new Date(i.getFullYear(),i.getMonth(),i.getDate()-30);break;case e.intervalTypes.week:t=new Date(n.getFullYear(),n.getMonth(),n.getDate()-7);break;case e.intervalTypes.month:t=new Date(a.getFullYear(),a.getMonth()-2,a.getDate());break;case e.intervalTypes.year:t=new Date(i.getFullYear(),i.getMonth()-5,1)}return{from:t,to:i}}function h(t){return e.postColors[t]||"#fff"}function v(e,t){var i=t.indexOf(e);i>-1&&t.splice(i,1)}function b(e){function t(e){return!!r[e]}function i(){return r}var o=e||{},r={username:!!o.usernameVisible,name:!!o.nameVisible,occupation:!!o.occupationVisible,phone:!!o.phoneVisible,email:!!o.emailVisible,country:!!o.countryVisible,city:!!o.cityVisible,state:!!o.stateVisible,birthday:!!o.birthdayVisible,condition:!!o.conditionVisible};return{isVisibleProperty:t,getProperties:i}}function y(e){return w.test(e)}function $(e,t){var i=e.replace("rgb","rgba").replace(")",","+t+")").replace(/\s/g,"");return i}var w=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return{getIntervalItemName:i,getFullPath:r,logTimestampValueFromDate:n,dateFromTimestamp:a,formatDateAsServer:s,formatDateTimeAsServer:l,getTodayDate:c,getDateRangeForReport:g,getNextDateRangeAvailability:u,getMonthDateRange:o,getNextDateRange:m,getPrevDateRange:p,getDateRangeForIntervalType:f,getColorByName:h,removeObjectFromArray:v,userFieldsVisibility:b,isEmail:y,changeRgbToRgba:$}}])},function(e,t){angular.module("kw.socialNetwork").factory("interaction",["$uibModal","$q","NotificationManager","$ngConfirm",function(e,t,i,o){function r(e){i.addToQueue(e,"success")}function n(e){i.addToQueue(e,"danger")}function a(e){i.addToQueue(e,"warning")}function s(e,i){return t(function(t,r){o({title:i,content:e,buttons:{Cancel:{text:"Cancel",btnClass:"btn btn-flat",action:function(e,t){r("cancel")}},Ok:{text:"Ok",btnClass:"btn btn-mint",action:function(e,i){t()}}}})})}return{success:r,error:n,warning:a,confirm:s}}])},function(e,t){angular.module("kw.socialNetwork").directive("collapsablePanel",["$rootScope",function(e){function t(t,i){$.components.init("panel",i),i.on("shown.uikit.panel",function(i){e.$broadcast("shown.uikit.panel",t.id)})}return{link:t,restrict:"E",scope:{onShow:"&",id:"="}}}])},function(e,t){angular.module("kw.socialNetwork").directive("chart",function(){function e(e,o){o.css("height","300px"),o.css("position","relative"),e.$on("shown.uikit.panel",function(t,i){i===e.chartId&&n.update()});var r={lineSmooth:!1,showLine:!0,showPoint:!0,showArea:!0,fullWidth:!0,classNames:{series:"ct-series"},plugins:[Chartist.plugins.tooltip({appendToBody:!1,pointClass:"hfc-point",tooltipOffset:{x:0,y:-10},anchorToPoint:!0})]},n=t(e,o,r);e.$watch("x",function(){i(e.x,e.y,n)}),e.$watch("y",function(){i(e.x,e.y,n)})}function t(e,t,i){var o={labels:[],series:[[]]};if(e.x&&e.y&&e.x.length===e.y.length)for(var r=0;r<e.x.length;r++)o.labels.push(e.x[r]),o.series[0].push(e.y[r]);e.className&&(i.classNames.series=e.className+" "+i.classNames.series);var n=new Chartist.Line(t[0],o,i);return n.on("draw",function(e){if("point"===e.type){var t=new Chartist.Svg("circle",{cx:[e.x],cy:[e.y],r:[5],"ct:value":e.value.y,"ct:meta":e.meta,class:"hfc-point"},"ct-area");e.element.replace(t)}"label"===e.type&&(i.horizontalBars||"y"!==e.axis.units.pos?null!=i.horizontalBars&&!i.horizontalBars||"x"!==e.axis.units.pos||e.element.attr({x:e.x-e.width/2}):e.element.attr({y:e.y+e.height/6.5}))}),n}function i(e,t,i){var o={labels:[],series:[[]]};if(!i)return void console.warn("chart is not initialized yet");if(!e||!t||e.length!==t.length)return void console.warn("bad x or y parameters for chart");for(var r=0;r<e.length;r++)o.labels.push(e[r]),o.series[0].push(t[r]);i.update(o)}return{link:e,scope:{x:"=",y:"=",color:"=",className:"=",chartId:"="}}})},function(e,t){angular.module("kw.socialNetwork").directive("hfcDatepicker",["$parse",function(e){function t(e,t,i,o){function r(e){var t=moment(e);return t.isValid()?(t=t.toDate(),new Date(t.getFullYear(),t.getMonth(),t.getDate())):null}t.datepicker({autoclose:!0}).on("changeDate",function(i){o.$setViewValue(t.datepicker("getFormattedDate")),e.changeDate(i.date)}),o.$formatters.push(function(e){return e?(t.datepicker("setDate",e),t.datepicker("update"),t.datepicker("getFormattedDate")):""}),o.$parsers.push(function(e){return r(e)}),e.ngModel&&t.datepicker("setDate",r(e.ngModel))}return{link:t,restrict:"C",require:"ngModel",scope:{ngModel:"=",changeDate:"&"}}}])},function(e,t){angular.module("kw.socialNetwork").directive("slidePanel",["$templateRequest","$compile","$rootScope",function(e,t,i){function o(o,r,n){var a;e(n.slidePanel).then(function(e){a=angular.element(e),t(a)(o)}),r.on("click",function(){$.slidePanel.show({content:a,settings:{cache:!1}},{closeSelector:".slidePanel-close",mouseDragHandler:".slidePanel-handler",loading:{template:function(e){return'<div class="'+e.classes.loading+'"><div class="loader loader-default"></div></div>'},showCallback:function(e){this.$el.addClass(e.classes.loading+"-show")},hideCallback:function(e){this.$el.removeClass(e.classes.loading+"-show")}},template:function(e){return'<div class="'+e.classes.base+" "+e.classes.base+"-"+e.direction+'"><div class="'+e.classes.base+'-scrollable"><div><div class="'+e.classes.content+'"></div></div></div><div class="'+e.classes.base+'-handler"></div></div>'},afterLoad:function(){this.$panel.find("."+this.options.classes.base+"-scrollable").asScrollable({namespace:"scrollable",contentSelector:">",containerSelector:">"})}})}),i.$on("$stateChangeSuccess",function(){$.slidePanel.hide()})}return{link:o}}])},function(e,t){angular.module("kw.socialNetwork").directive("navTabsLine",function(){function e(e,t){var i={speed:"0.5s, 1s",animate:"cubic-bezier(0.4, 0, 0.2, 1), cubic-bezier(0.4, 0, 0.2, 1)",tpl:function(){return'<li class="nav-tabs-autoline"></li>'}};t.find("ul").each(function(){var t=$(this),o=$.extend({},i,t.data()),r=t.parent(),n=t.find(".active")||t.find("a").first(),a=$(o.tpl()).css({"-webkit-transition-duration":o.speed,"transition-duration":o.speed,"-webkit-transition-timing-function":o.animate,"transition-timing-function":o.animate});a.appendTo(t);var s=function(e){var t=e.position().left,i=e.outerWidth();a.css({left:t,width:i})},l=function(e){var t=e.position().top,i=e.outerHeight();a.css({top:t,height:i})},c=function(e){r.hasClass("nav-tabs-vertical")?l(e):s(e)};n&&n.length&&c(n),e.directiveTabSelect=function(e){e&&e.target&&c($(e.target).parent())}})}return{link:e,restrict:"A"}})},function(e,t){angular.module("kw.socialNetwork").directive("onCtrlEnter",function(){return function(e,t,i){t.bind("keydown",function(t){t.ctrlKey&&13===t.keyCode&&(e.$apply(function(){e.$eval(i.onCtrlEnter)}),t.preventDefault())})}})},function(e,t){angular.module("kw.socialNetwork").directive("onEnter",function(){return function(e,t,i){t.bind("keydown",function(t){13===t.keyCode&&(e.$apply(function(){e.$eval(i.onEnter)}),t.preventDefault())})}})},function(e,t){angular.module("kw.socialNetwork").directive("logEditableTableRow",["$compile",function(e){function t(e,t,i){var o=t.parents("table"),r=t.parents(".table-responsive");"relative"!==o.parent().css("position")&&o.wrap("<div style='position: relative'></div>");var n=$("<div class='table-row-overlay text-right' style='position: absolute; width: 60px; right: 60px; padding-top: 5px; display: none'></div>"),a=$("<button class='edit-log-record btn btn-mint btn-edit-background'></button>"),s=$("<button class='delete-log-record btn btn-delete btn-delete-background' style='margin-left:8px;'></button>"),l=$("<div class='row'></div>"),c=n.append(l.append(a).append(s));r.length>0&&0===r.siblings(".table-row-overlay").length?r.after(c):0===o.siblings(".table-row-overlay").length&&0===r.length&&o.after(c),c=r.length>0?r.siblings(".table-row-overlay"):o.siblings(".table-row-overlay"),c.find(".edit-log-record").on("click",function(){"function"==typeof e.onEdit&&t.hasClass("selected")&&e.onEdit()}),c.find(".delete-log-record").on("click",function(){"function"==typeof e.onDelete&&t.hasClass("selected")&&e.onDelete()}),t.on("click",function(t){if($(document).off("click.removeEditableButtons"),"input"!==t.target.tagName.toLowerCase()){var i=/(?:(\d{4})([\-\/.])([0-3]?\d)\2([0-3]?\d)|([0-3]?\d)([\-\/.])([0-3]?\d)\6(\d{4}))(?:\s+([012]?\d)([:hap])([0-5]\d))?/i,n=null===e.logRecord.timeLabel.match(i);e.logRecord.id?$(".table-row-overlay .row .delete-log-record").prop("disabled",!1):$(".table-row-overlay .row .delete-log-record").prop("disabled",!0),e.logRecord.id||!n?r.length>0?c.css({top:$(this).position().top+$(this).height()-15+$(this).offsetParent().offset().top-r.offsetParent().offset().top,display:"block"}):c.css({top:$(this).position().top+$(this).height()-15,display:"block"}):c.css({display:"none"}),e.isNotSelectable||(o.find("tr").removeClass("selected"),$(this).addClass("selected")),"function"==typeof e.selectRowCallback&&e.selectRowCallback(),$(document).on("click.removeEditableButtons",function(e){$(e.target).closest(o).length&&!n||(c.css({display:"none"}),o.find("tr").removeClass("selected"),$(document).off("click.removeEditableButtons"))})}}),e.$on("logListUpdated",function(t,i){(i||e.tableId)&&i!==e.tableId||(o.find("tr").removeClass("selected"),c.css({display:"none"}))})}return{restrict:"A",link:t,scope:{logRecord:"=logEditableTableRow",selectRowCallback:"&selectRow",onEdit:"&",onDelete:"&",tableId:"=",isNotSelectable:"="}}}])},function(e,t,i){i(113),angular.module("kw.socialNetwork").component("socialNetwork",{controller:"SocialNetworkController",template:i(114)})},function(e,t){!function(){function e(e){function t(){i.userLogged=!0}var i=this;i.userLogged=!1,i.showMenu=function(){angular.element(".app-header-links").toggleClass("hidden-xs")},i.$onInit=function(){e.on("userLogged",t)},i.$onDestroy=function(){e.off("userLogged",t)}}e.$inject=["GlobalEventsManager"],angular.module("kw.socialNetwork").controller("SocialNetworkController",e)}()},function(e,t){e.exports='<header class="app-header navbar-fixed-top"> <div class="container-fluid clearfix app-header-wrapper"> <div class=app-header-logo> <img src=/img/social-network/logo_contour.png title=HealthLink> <span class=app-header-logo-text>HealthLink</span> </div> <div class="app-header-hamburger visible-xs" ng-click=$ctrl.showMenu() ng-show=$ctrl.userLogged> <span class="icon icon-s-menu-hamburger"></span> </div> <div class="app-header-user dropdown" ng-show=$ctrl.userLogged> <div class="app-header-avatar dropdown-toggle" id=appHeaderUserMenu data-toggle=dropdown aria-expanded=false data-animation=scale-up> <u-avatar user=$root.CurrentUser.getIdentity()></u-avatar> <i class="fa fa-angle-down"></i> </div> <ul class="dropdown-menu dropdown-menu-right" aria-labelledby=appHeaderUserMenu> <li role=presentation> <a ui-sref=my-account.profile> <i class=snsprite-profile></i> Profile </a> </li> <li role=presentation> <a ui-sref=my-account.health-goals> <i class=snsprite-health_goals></i> Health Goals </a> </li> <li role=presentation> <a ui-sref=my-account.settings> <i class=snsprite-settings></i> Settings </a> </li> <li class=divider role=presentation></li> <li role=presentation> <a ng-click=$root.logout()> <i class=snsprite-logout></i> Logout </a> </li> </ul> </div> <nav class="app-header-links hidden-xs" ng-show=$ctrl.userLogged> <a ui-sref-active=active ui-sref=network>Network</a> <a ui-sref-active=active ui-sref=health-data>Health Profile</a> <a ui-sref-active=active ui-sref=partners>Partners</a> <a href=/ >Health Zone</a> </nav> </div> </header> <div class=page> <div ui-view></div> </div> <footer class=site-footer> <div class=site-footer-legal> © 2016 <a href=/ >HealthLink</a> </div> </footer> <div class=notification-center> <div class="alert alert-{{alert.type}}" role=alert ng-repeat="alert in $root.NotificationManager.notifications"> <button type=button class=close ng-click=$root.NotificationManager.removeQueueMemberById($index)> <span aria-hidden=true>&times;</span> </button> {{alert.msg}} </div> </div>'},function(e,t,i){i(116),angular.module("kw.socialNetwork").factory("CustomPrintModal",["$uibModal","appRoot",function(e,t){return function(t){return e.open({animation:!0,template:i(117),size:"lg",windowClass:"modal-reports",resolve:{parent:function(){return t}},controller:"CustomPrintModalController as $ctrl"}).result}}])},function(e,t){!function(){function e(e,t,i){var o=this;o.parent=t,o.hideDropdownMonth=!1,o.parent.reportData.hideDropdownMonth&&(o.hideDropdownMonth=o.parent.reportData.hideDropdownMonth),o.savedDateRange={from:o.parent.from,to:o.parent.to,intervalsType:o.parent.intervalsType},o.init=function(){o.month=moment().month(),o.monthChanged({id:o.month})},o.cancel=function(){e.dismiss(null)},o.printReport=function(e){var t=o.parent.reportSettings,r=document.getElementById("customprintchart").getElementsByTagName("canvas"),n={tableData:o.parent.reportData.tableData,charts:[]},a=50;angular.forEach(r,function(e,t){var i="undefined"!=typeof o.parent.reportData.charts[t].title?o.parent.reportData.charts[t].title:"";n.charts.push({chart:e.toDataURL("image/jpeg"),title:i,x:5,y:a,width:e.width,height:e.height}),a+=100}),i.createMultiImageSingleTablePDFReport(n,t,e)},o.monthChanged=function(e){o.parent.setMonthDateRange(e.id)},e.result.then(function(){return!0},function(){o.parent.setDateRange(o.savedDateRange.from,o.savedDateRange.to,o.savedDateRange.intervalsType)}),o.init()}e.$inject=["$uibModalInstance","parent","PDFCreator"],angular.module("kw.socialNetwork").controller("CustomPrintModalController",e)}()},function(e,t){e.exports='<div class=modal-header> <span class="modal-title font-size-20">Modal Custom Print</span> <div class=pull-right ng-hide=$ctrl.hideDropdownMonth> <custom-print-date month-changed=$ctrl.monthChanged(month) selected=$ctrl.month></custom-print-date> </div> </div> <div class=modal-body id=customprintchart> <div class=row data-ng-repeat="chart in $ctrl.parent.reportData.charts"> <h4 ng-if=chart.title>{{chart.title}}</h4> <custom-print-chart data=chart.values series=chart.series options=chart.options chart-colors=$ctrl.parent.chartColors labels=chart.labels></custom-print-chart> </div> <div class=table-responsive> <table class="table table-striped table-bordered data-table margin-top-20"> <thead> <tr> <th data-ng-repeat="column in $ctrl.parent.reportData.tableData.cols">{{column.title}}</th> </tr> </thead> <tbody> <tr ng-repeat="row in $ctrl.parent.reportData.tableData.rows"> <td ng-repeat="col in $ctrl.parent.reportData.tableData.cols">{{row[col.dataKey]}}</td> </tr> </tbody> </table> </div> </div> <div class=modal-footer> <div class=pull-left> <button class="btn btn-mint" type=button ng-click=$ctrl.printReport()>Print</button> <button class="btn btn-mint" type=button ng-click="$ctrl.printReport(\'download\')">Download</button> <button class="btn btn-pure" type=button ng-click=$ctrl.cancel()>Close</button> </div> </div>'},function(e,t){angular.module("kw.socialNetwork").component("healthData",{controller:"HealthDataController",templateUrl:["appRoot",function(e){"ngInject";return e+"healthData/healthData.html"}]})},function(e,t){!function(){function e(){}angular.module("kw.socialNetwork").controller("HealthDataController",e)}()},function(e,t){angular.module("kw.socialNetwork").factory("healthDataLogConverter",["enums","utilities",function(e,t){function i(e,t){var i=t?1:-1;e.sort(function(e,t){var o,r;return o=moment(e.start_time),r=moment(t.start_time),o<r?-i:o>r?i:0})}function o(i,o,r,n,a,s,l,c,d){var u,m,p,g,f,h={timings:[],serverTimings:[],values:[],recordsCount:[]},v=d?Array.prototype.push:Array.prototype.unshift;switch(s>new Date&&(s=new Date),i||(i=[]),m=a,n){case e.intervalTypes.day:for(i.forEach(function(e){h.timings.push(e.start_time),h.serverTimings.push(e.start_time),u=o(e),u.isOriginal=!0,h.values.push(u),h.recordsCount.push(1)});m<s;){g=h.serverTimings.length,f=!1;for(var b=0;b<h.serverTimings.length;b++){if(moment(h.serverTimings[b]).isSame(m,"day")){f=!0;break}if(d){if(new Date(h.serverTimings[b])>m){g=b;break}}else if(new Date(h.serverTimings[b])<m){g=b;break}}f||(h.recordsCount.splice(g,0,0),h.timings.splice(g,0,t.formatDateTimeAsServer(m)),h.serverTimings.splice(g,0,t.formatDateTimeAsServer(m)),h.values.splice(g,0,r)),m=new Date(m.getFullYear(),m.getMonth(),m.getDate()+1)}break;case e.intervalTypes.week:for(;m<s;)v.call(h.recordsCount,0),v.call(h.timings,moment(m).format("LL")),v.call(h.serverTimings,t.formatDateAsServer(m)),m=new Date(m.getFullYear(),m.getMonth(),m.getDate()+1);break;case e.intervalTypes.month:for(;m<s;)v.call(h.recordsCount,0),p=new Date(m.getFullYear(),m.getMonth(),m.getDate()+7),m.getMonth()===p.getMonth()?v.call(h.timings,moment(m).format("DD")+"-"+moment(p).format("DD MMM")):v.call(h.timings,moment(m).format("DD MMM")+"-"+moment(p).format("DD MMM")),v.call(h.serverTimings,t.formatDateAsServer(m)),p.getMonth()!==m.getMonth()&&(p=new Date(p.getFullYear(),p.getMonth(),1)),m=p;break;case e.intervalTypes.year:for(;m<s;)v.call(h.recordsCount,0),v.call(h.timings,moment(m).format("MMMM YYYY")),v.call(h.serverTimings,t.formatDateAsServer(m)),m=new Date(m.getFullYear(),m.getMonth()+1,m.getDate())}return i.forEach(function(e){for(var t,i=0;i<h.timings.length;i++)t=!(h.values[i]&&h.values[i].isOriginal||e.isPeriodical)&&h.serverTimings[i]===e.start_time,t&&(h.values[i]=o(e),h.recordsCount[i]=e.number_records)}),h.recordsCount.forEach(function(e,t){var i;if(0===e){if(0===t){if(l)return h.values[t]=l,void(h.values[t].timeLabel=h.timings[t]);for(var o=h.values.length-1;o>0;o--)0!==h.recordsCount[o]&&(i=o);return i&&c?(h.values[t]=angular.copy(h.values[i]),delete h.values[t].isOriginal):h.values[t]=r,void(h.values[t].timeLabel=h.timings[t])}t>0&&(c?(h.values[t]=angular.copy(h.values[t-1]),delete h.values[t].isOriginal):h.values[t]=r)}h.values[t].timeLabel=h.timings[t]}),h}function r(e,t,r,n,a){var s;return e&&e.length>0&&e[0].isOld&&(s={id:e[0].id,value:e[0].value,log_timestamp:e[0].start_time},e=[]),i(e,a),o(e,function(e){return{id:e.id,value:e.value,log_timestamp:e.start_time}},{value:0},t,r,n,s,!1,a)}function n(e,t,r,n,a){return i(e,a),o(e,function(e){return{id:e.id,exercise:{id:e.exercise_id,name:e.exercise},minutes:e.minutes,cardioExercise:e.cardio_exercise,cardioMinutes:e.cardio_minutes,strengthExercise:e.strength_exercise,strengthMinutes:e.strength_minutes,caloriesBurned:e.total_calories_burned?e.total_calories_burned:e.calories_burned}},{exercise:"-",minutes:"-",cardioExercise:"-",cardioMinutes:"-",strengthExercise:"-",strengthMinutes:"-",caloriesBurned:"-"},t,r,n)}function a(e,t,r,n,a){return i(e,a),o(e,function(e){return{id:e.id,meal:{value:e.meal},quantity:e.quantity,calories:e.calories,fat:e.fat,carbs:e.carbs,protein:e.protein,fiber:e.fiber,food:{id:e.food_id,name:e.food}}},{quantity:"-",calories:"-",fat:"-",carbs:"-",protein:"-",fiber:"-",food:{name:"-"}},t,r,n)}function s(r,n,a,s,l){var c,d,u,m=[];if(n===e.intervalTypes.day)for(var p=0;p<r.length;p++){if(d=r[p],d.from=d.start_time,d.to=d.end_time,moment(d.start_time).isSame(d.end_time,"day")&&moment(d.start_time).isSame(d.created_at,"day")||(d.isPeriodical=!0,d.mustBeRemoved=!0),d.isPeriodical)for(d.start_time=moment(d.start_time).startOf("day"),d.end_time=moment(d.end_time).startOf("day"),c=a;c<s;)c>=d.start_time&&c<=d.end_time&&(u=angular.copy(d),u.start_time=t.formatDateAsServer(c),u.isTaken=u.taken&&u.taken[t.formatDateTimeAsServer(u.start_time)],m.push(u)),c=new Date(c.getFullYear(),c.getMonth(),c.getDate()+1);else d.isTaken=d.taken&&d.taken[t.formatDateTimeAsServer(d.start_time)],d.start_time=d.created_at;d.mustBeRemoved&&(r.splice(p,1),p--)}return i(r,l),i(m,l),o(m.concat(r),function(e){return{id:e.id,medication:e.medication,condition:e.condition,dosage:e.dosage,frequency:e.frequency,taken:e.taken,isTaken:e.isTaken,start_time:e.start_time,from:e.from,to:e.to}},{medication:"-",condition:"-",dosage:"-",frequency:"-",isTaken:!1},n,a,s)}return{convertBiometricsLog:r,convertMedicationLog:s,convertExerciseLog:n,convertDietLog:a}}])},function(e,t){angular.module("kw.socialNetwork").factory("healthDataCache",["utilities",function(e){function t(e){c[e]={}}function i(e){return c[e]}function o(e){return c[e]||(c[e]={}),c[e]}function r(e,t){var r=i(e);return r||(r=o(e)),r[t]||(r[t]={}),r[t]}function n(t,i,o){var n=e.formatDateTimeAsServer(o),a=r(t,i)[n];return a?a.data:null}function a(t,i,o,n,a){var s=e.formatDateTimeAsServer(n),l=r(t,i);l[s]||(l[s]={}),l[s].data=o,l[s].periodStart=n,l[s].periodEnd=a}function s(e,t,i){var o=n(e,t,i);return null!==o&&"undefined"!=typeof o}function l(e,t,i){var o,n=r(e,t);if(angular.equals({},n))return{};for(var a in n)if(i>=n[a].periodStart&&i<=n[a].periodEnd){o=n[a].data;for(var s=0;s<o.length;s++)if(moment(o[s].start_time).isSame(i))return o[s]}return[]}var c={};return{getLogData:n,putLogData:a,hasLogData:s,getLogRecord:l,removeLogData:t}}])},function(e,t){angular.module("kw.socialNetwork").factory("logEditorModal",["$uibModal","appRoot",function(e,t){function i(i,o){return e.open({templateUrl:t+"/healthData/logEditorModal.html",windowClass:"modal-centered",backdrop:"static",resolve:{contentTemplateUrl:function(){return o},logEntry:function(){return i}},controllerAs:"$ctrl",controller:["contentTemplateUrl","logEntry",function(e,t){this.contentTemplateUrl=e,this.logEntry=angular.copy(t)}]}).result}return{show:i}}])},function(e,t){angular.module("kw.socialNetwork").component("exportModal",{template:"<button class='btn btn-mint-outline' ng-class='$ctrl.classes' ng-click='$ctrl.showModal()'><img src='/img/social-network/icons/exportPDF.png'/> {{$ctrl.exportText}}</button>",controller:"ExportModalController",bindings:{exportText:"=",exportUrl:"=",exportParametersString:"=",classes:"<"}})},function(e,t){!function(){function e(e,t){this.$uibModal=e,this.appRoot=t}e.$inject=["$uibModal","appRoot"],angular.module("kw.socialNetwork").controller("ExportModalController",e),
e.prototype.showModal=function(){var e=this;this.$uibModal.open({templateUrl:this.appRoot+"healthData/exportModal/exportParameters.html",controller:"ExportParametersController",controllerAs:"$ctrl",windowClass:"modal-centered",backdrop:"static",resolve:{exportUrl:function(){return e.exportUrl},header:function(){return e.exportText},additionalParametersString:function(){return e.exportParametersString?e.exportParametersString:""}}})}}()},function(e,t){!function(){function e(e,t,i,o,r,n,a,s){var l;this.$uibModalInstance=e,this.$uibModal=t,this.appRoot=n,this._utilities=s,this.exportUrl=i,this.header=o,this.additionalParametersString=r,this.availableViewTypes=[];for(var c in a.intervalTypes)l=a.intervalTypes[c],this.availableViewTypes.push({description:l.charAt(0).toUpperCase()+l.slice(1),type:l});this.availableViewTypes.length>0&&(this.view=this.availableViewTypes[0].type)}e.$inject=["$uibModalInstance","$uibModal","exportUrl","header","additionalParametersString","appRoot","enums","utilities"],angular.module("kw.socialNetwork").controller("ExportParametersController",e),e.prototype.cancel=function(){this.$uibModalInstance.dismiss("cancel")},e.prototype.showDatepicker=function(){return this.$uibModal.open({templateUrl:this.appRoot+"healthData/exportModal/datepickerModal.html",windowClass:"modal-centered modal-auto-width",controllerAs:"$ctrl",backdrop:"static"}).result},e.prototype.editFromDate=function(){var e=this;this.showDatepicker().then(function(t){e.from=moment(t).format("L")})},e.prototype.editToDate=function(){var e=this;this.showDatepicker().then(function(t){e.to=moment(t).format("L")})},e.prototype.getExportUrl=function(){return this.exportUrl+"?format=pdf&date_from="+this._utilities.formatDateAsServer(this.from)+"&date_to="+this._utilities.formatDateAsServer(this.to)+"&view="+this.view+"&"+this.additionalParametersString}}()},function(e,t){angular.module("kw.socialNetwork").component("biometrics",{controller:"BiometricsController",templateUrl:["appRoot",function(e){"ngInject";return e+"healthData/biometrics/biometrics.html"}],bindings:{userId:"=",demoMode:"="}})},function(e,t){!function(){function e(e,t,i,o){var r=this;this._biometricsRepository=e,this._enums=t,this._NotificationManager=i,this._interaction=o,this.demoMode=this.demoMode||!1,r.biometrics=[{log:[],alerts:[{}],biometrics:{id:r._enums.biometricParameterTypes.weight,uom:"lbs",eg:"75",className:r.getBiometricParameterClass(r._enums.biometricParameterTypes.weight),header:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.weight),icon:r.getBiometricParameterIcon(r._enums.biometricParameterTypes.weight),name:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.weight),inputPattern:/^(0*[1-9][0-9]*(\.[0-9]+)?|0+\.[0-9]*[1-9][0-9]*)$/}},{log:[],alerts:[{}],biometrics:{id:r._enums.biometricParameterTypes.bloodPressure,uom:"mmHg",eg:"120/80",className:r.getBiometricParameterClass(r._enums.biometricParameterTypes.bloodPressure),header:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.bloodPressure),icon:r.getBiometricParameterIcon(r._enums.biometricParameterTypes.bloodPressure),name:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.bloodPressure),inputPattern:/^(0*[1-9][0-9]{0,2})\/(0*[1-9][0-9]{0,2})$/}},{log:[],alerts:[{}],biometrics:{id:r._enums.biometricParameterTypes.heartRate,uom:"bpm",eg:"64",className:r.getBiometricParameterClass(r._enums.biometricParameterTypes.heartRate),header:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.heartRate),icon:r.getBiometricParameterIcon(r._enums.biometricParameterTypes.heartRate),name:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.heartRate),inputPattern:/^(0*[1-9][0-9]*(\.[0-9]+)?|0+\.[0-9]*[1-9][0-9]*)$/}},{log:[],alerts:[{}],biometrics:{id:r._enums.biometricParameterTypes.bloodGlucoseLevel,uom:"mg/dL",eg:"98",className:r.getBiometricParameterClass(r._enums.biometricParameterTypes.bloodGlucoseLevel),header:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.bloodGlucoseLevel),icon:r.getBiometricParameterIcon(r._enums.biometricParameterTypes.bloodGlucoseLevel),name:r.getBiometricParameterHeader(r._enums.biometricParameterTypes.bloodGlucoseLevel),inputPattern:/^(0*[1-9][0-9]*(\.[0-9]+)?|0+\.[0-9]*[1-9][0-9]*)$/}}],r.biometricParameterStatusType={info:1,warning:2},r.isLogEmpty=function(e,t){r.biometrics[e].alerts.splice(t,1)},r.$onInit=function(){r._biometricsRepository.getBiometricsLastCreationDates(r.userId).then(function(e){var t=moment().subtract(12,"days");r.biometrics.forEach(function(i){var o=e.dates[i.biometrics.id];return o?(!r.demoMode&&o<=t&&(i.status={type:r.biometricParameterStatusType.warning,message:"You haven't updated your "+i.biometrics.name+" for "+moment(o).to(new Date,!0)}),void(o&&(i.biometrics.lastUpdatedValue=e.values[i.biometrics.id]))):void(i.status={type:r.biometricParameterStatusType.info,message:"No data"})})}),r._biometricsRepository.getBiometricParameters().then(function(e){r.exportParameters=e,r.exportParameter=r.exportParameters[0]}),r.height={},r._biometricsRepository.getBiometricParameterValues(r._enums.biometricParameterTypes.height,r.userId).then(function(e){e&&e.length>0&&(r.height=e[0],r.height.feet=r.height.value/12|0,r.height.inches=r.height.value%12,r.lastHeight=angular.copy(r.height))})}}e.$inject=["biometricsRepository","enums","NotificationManager","interaction"],angular.module("kw.socialNetwork").controller("BiometricsController",e),e.prototype.getActualBiometricParameters=function(){var e=this;this._biometricsRepository.getBiometricParameterValues(this._enums.biometricParameterTypes.all,this.userId,this.exportParameter,this.exportFrom,this.exportTo).then(function(t){e.biometrics=t;for(var i=-1,o=0;o<e.biometrics.length;o++)if(e.biometrics[o].biometrics.id===e._enums.biometricParameterTypes.height){e.height=e.biometrics[o].log[0],e.height.feet=e.height.value/12|0,e.height.inches=e.height.value%12,e.height.biometrics=e._enums.biometricParameterTypes.height,i=o;break}i>-1&&e.biometrics.splice(o,1)})},e.prototype.updateHeight=function(){var e=this;if(!this.height||!this.height.feet||!this.height.inches)return void e._interaction.warning("For saving height value both feet and inches must be entered");this.height.value=12*this.height.feet+ +this.height.inches;var t=this.height.id?this._biometricsRepository.updateBiometricLogRecord(this.height):this._biometricsRepository.createBiometricParameter({id:this._enums.biometricParameterTypes.height},this.height.value);t.then(function(){var t=e.height.feet,i=e.height.inches;e.height.feet=t,e.height.inches=i,e.lastHeight=angular.copy(e.height),e._interaction.success("Height was successfully saved")}).catch(function(t){e._interaction.error("Error while saving height."+t)})},e.prototype.addBiometricParameterValue=function(e){var t=this;return e.value?t._biometricsRepository.createBiometricParameter(e.biometrics,e.value).then(function(i){e.value=void 0,t._interaction.success(e.biometrics.name+" was successfully saved")}).catch(function(i){t._interaction.error("Error while saving "+e.biometrics.name+". "+i)}):void this._interaction.warning("Please enter "+e.biometrics.name+" value for saving")},e.prototype.alertTypeByStatus=function(e){return e===this.biometricParameterStatusType.info?"info":"warning"},e.prototype.getBiometricParameterIcon=function(e){var t=e;switch(t){case this._enums.biometricParameterTypes.height:return"/img/social-network/icons/height.png";case this._enums.biometricParameterTypes.weight:return"/img/social-network/icons/weight.png";case this._enums.biometricParameterTypes.systolicBloodPressure:return"/img/social-network/icons/systolicbloodpressure.png";case this._enums.biometricParameterTypes.diastolicBloodPressure:return"/img/social-network/icons/diastolicbloodpressure.png";case this._enums.biometricParameterTypes.heartRate:return"/img/social-network/icons/heartrate.png";case this._enums.biometricParameterTypes.bloodGlucoseLevel:return"/img/social-network/icons/bloodglucose.png";case this._enums.biometricParameterTypes.bloodPressure:return"/img/social-network/icons/systolicbloodpressure.png"}},e.prototype.getBiometricParameterClass=function(e){var t=e;switch(t){case this._enums.biometricParameterTypes.height:return"biometrics-height";case this._enums.biometricParameterTypes.weight:return"biometrics-weight";case this._enums.biometricParameterTypes.systolicBloodPressure:return"biometrics-systolic-pressure";case this._enums.biometricParameterTypes.diastolicBloodPressure:return"biometrics-diastolic-pressure";case this._enums.biometricParameterTypes.heartRate:return"biometrics-heart-rate";case this._enums.biometricParameterTypes.bloodGlucoseLevel:return"biometrics-glucose";case this._enums.biometricParameterTypes.bloodPressure:return"biometrics-blood-pressure"}},e.prototype.getBiometricParameterHeader=function(e){var t=e;switch(t){case this._enums.biometricParameterTypes.height:return"Height";case this._enums.biometricParameterTypes.weight:return"Weight";case this._enums.biometricParameterTypes.systolicBloodPressure:return"Systolic Blood Pressure";case this._enums.biometricParameterTypes.diastolicBloodPressure:return"Diastolic Blood Pressure";case this._enums.biometricParameterTypes.heartRate:return"Heart Rate";case this._enums.biometricParameterTypes.bloodGlucoseLevel:return"Blood Glucose Level";case this._enums.biometricParameterTypes.bloodPressure:return"Blood Pressure"}}}()},function(e,t){angular.module("kw.socialNetwork").factory("biometricsRepository",["$q","healthDataLogConverter","utilities","ApiRequest","healthDataCache","enums",function(e,t,i,o,r,n){function a(){}function s(){return e(function(e){e([{id:n.biometricParameterTypes.height,name:"Height"},{id:n.biometricParameterTypes.weight,name:"Weight"},{id:n.biometricParameterTypes.systolicBloodPressure,name:"Systolic Blood Pressure"},{id:n.biometricParameterTypes.diastolicBloodPressure,name:"Diastolic Blood Pressure"},{id:n.biometricParameterTypes.heartRate,name:"Heart Rate"},{id:n.biometricParameterTypes.bloodGlucoseLevel,name:"Blood Glucose Level"},{id:n.biometricParameterTypes.bloodPressure,name:"Blood Pressure"}])})}function l(e,t,i,r,n){return o.get("user/biometrics",{from:r?r:void 0,to:n?n:void 0,biometric_id:e,user_id:t}).then(function(e){return e.entities})}function c(e){switch(e){case n.biometricParameterTypes.weight:return n.caches.weightCache;case n.biometricParameterTypes.systolicBloodPressure:return n.caches.systolicBloodPressureCache;case n.biometricParameterTypes.diastolicBloodPressure:return n.caches.diastolicBloodPressureCache;case n.biometricParameterTypes.heartRate:return n.caches.heartRateCache;case n.biometricParameterTypes.bloodGlucoseLevel:return n.caches.bloodGlucoseLevelCache;case n.biometricParameterTypes.bloodPressure:return n.caches.bloodPressureCache;default:return null}}function d(t,n,a,s,l){var d=c(t);return r.hasLogData(d,n,a)?e(function(e){e(r.getLogData(d,n,a))}):o.get("user/biometrics/log",{biometric_id:t,view:n,date_from:i.formatDateTimeAsServer(a),date_to:i.formatDateTimeAsServer(s),user_id:l}).then(function(e){return e.result.length>0&&(e.result[0].isOld=e.old_record),r.putLogData(d,n,e.result,a,s),e.result})}function u(t,r,n){return n=moment.utc(n),n.isValid()||(n=moment.utc()),o.post("user/biometrics",{biometrics:t.id?t.id:void 0,value:r.toString(),log_timestamp:i.logTimestampValueFromDate(n)}).then(function(e){}).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function m(t){return o.put("user/biometrics/"+t.id,{value:t.value.toString()}).then(function(e){var t=e.entity,i=r.getLogRecord(c(t.biometrics),n.intervalTypes.day,moment(t.log_timestamp).toDate());return angular.copy(t,i),i.start_time=i.log_timestamp,i}).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function p(t){return o.delete("user/biometrics/"+t.id).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function g(e){return o.get("user/log-lastest-created-time",{user_id:e}).then(function(e){var t={dates:{},values:{}},o=e.log_updated_at;if(o)for(var r in o)h[r]&&(t.dates[h[r]]=i.dateFromTimestamp(o[r]),null!==o[r+"_data"]&&(t.values[h[r]]=o[r+"_data"]));return t})}function f(e){var t=c(e);r.removeLogData(t)}var h={weight:n.biometricParameterTypes.weight,height:n.biometricParameterTypes.height,systolic_blood_pressure:n.biometricParameterTypes.systolicBloodPressure,diastolic_blood_pressure:n.biometricParameterTypes.diastolicBloodPressure,blood_glucose_level:n.biometricParameterTypes.bloodGlucoseLevel,heart_rate:n.biometricParameterTypes.heartRate,blood_pressure:n.biometricParameterTypes.bloodPressure};return{getBiometricData:a,getBiometricParameters:s,getBiometricParameterValues:l,getBiometricLog:d,createBiometricParameter:u,updateBiometricLogRecord:m,deleteBiometricLogRecord:p,getBiometricsLastCreationDates:g,deleteBiometricLogCache:f}}])},function(e,t){angular.module("kw.socialNetwork").component("biometricsParameter",{templateUrl:["appRoot",function(e){"ngInject";return e+"/healthData/biometrics/biometricsParameter.html"}],controller:"BiometricsParameterController",bindings:{measureUnit:"=",exampleValue:"=",biometricType:"=",parameterValue:"=",parameterData:"=",className:"=",updateParameter:"&",from:"<",to:"<",id:"=",userId:"<",demoMode:"<",header:"=",inputPattern:"="}})},function(e,t){!function(){function e(e,t,i,o,r,n,a,s,l,c,d){var u=this;this._biometricsRepository=e,this._utilities=i,this._interaction=o,this._healthDataLogConverter=r,this._enums=t,this._logEditorModal=a,this._appRoot=s,this.$rootScope=n,this.chartOptions={scales:{yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]},type:"linear"},this.viewModes={table:1,chart:2},this.intervalsTypes=t.intervalTypes,this.viewMode=this.viewModes.chart,d.innerWidth<768&&(this.viewMode=this.viewModes.table),this.intervalsType=this.intervalsTypes.year,u.isLoading=!0;var m=this._utilities.getDateRangeForIntervalType(null,null,this.intervalsType);this.from=m.from,this.to=m.to,this.formattedData={timings:[],chartValues:[]},u.chartColors=[],u.reportTitle="",u.modalInstance=null,u.$onInit=function(){if(0!==angular.element(this.getClassSelector()).length){var e=angular.element(this.getClassSelector()).css("color");u.chartColors=[this._utilities.changeRgbToRgba(e,"0.9"),this._utilities.changeRgbToRgba(e,"0.4")]}f(),u.initializeReportData(),u.setIntervalType(u.intervalsTypes.year),$(".snsprite-reply").on({touchstart:function(){this.addClass("is-touch-device")}})};var p=function(){u.reportTitle=u.header+" Report - "+moment(u.from).format("MMMM YYYY"),"undefined"!=typeof u.reportSettings&&(u.reportSettings.filename=g(u.reportTitle),u.reportSettings.title=u.reportTitle)},g=function(e){return e+".pdf"},f=function(){p(),u.reportSettings={orientation:"portrait",unit:"mm",format:{page:{x:297,y:210},title:{x:20,y:20},chart:{x:5,y:35}},filename:g(u.reportTitle),title:u.reportTitle}};u.initializeReportData=function(){u.reportData={charts:[{labels:u.formattedData.timings,values:u.formattedData.chartValues,series:[u.header],options:u.chartOptions}],tableData:[]},u.id==u._enums.biometricParameterTypes.bloodPressure&&(u.reportData.charts[0].series=["Systolic","Diastolic"]),u.setReportData()},n.$on("shown.uikit.panel",function(e,t){u.id===t&&u.loadLog()}),this.modalReport=function(){u.modalInstance=l(this)},u.setReportData=function(){var e={cols:[{title:this.getIntervalHeader(),dataKey:"interval"},{title:this.getValueHeader(),dataKey:"value"}],rows:[]};angular.forEach(this.formattedData.timings,function(t,i){e.rows.push({interval:t,value:u.formattedData.values[i].value})}),u.reportData.charts[0].labels=u.formattedData.timings,u.reportData.charts[0].values=u.formattedData.chartValues,u.reportData.tableData=e,p()}}e.$inject=["biometricsRepository","enums","utilities","interaction","healthDataLogConverter","$rootScope","logEditorModal","appRoot","CustomPrintModal","$q","$window"],angular.module("kw.socialNetwork").controller("BiometricsParameterController",e),e.prototype.update=function(){var e=this;this.updateParameter().then(function(){e._biometricsRepository.deleteBiometricLogCache(e.id),e.loadLog(),$("."+e.getClassName()+" .additional-info.alert").fadeOut(300,function(){$(this).remove()})})},e.prototype.editLogRecord=function(e,t){var i=this;e.inputPattern=i.inputPattern,e.timeLabel=t,this._logEditorModal.show(e,this._appRoot+"/healthData/biometrics/edit.html").then(function(e){return e.value=e.value,e.isOriginal?i._biometricsRepository.updateBiometricLogRecord(e):i._biometricsRepository.createBiometricParameter({id:i.biometricType},e.value,e.timeLabel)}).then(function(){i._interaction.success("Value was successfully changed"),i._biometricsRepository.deleteBiometricLogCache(i.id),i.loadLog()}).catch(function(e){"cancel"!==e&&i._interaction.error("Error while value edition. "+e)})},e.prototype.deleteLogRecord=function(e){var t=this;e.isOriginal&&this._interaction.confirm("Are you sure you want to delete this log record?").then(function(){return t._biometricsRepository.deleteBiometricLogRecord(e)}).then(function(){t._interaction.success("Value was successfully removed"),t._biometricsRepository.deleteBiometricLogCache(t.id),t.loadLog()}).catch(function(e){"cancel"!==e&&t._interaction.error("Error while deletion log record.")})},e.prototype.loadLog=function(){var e=this;e.isLoading=!0,e.log=[],e.formattedData={timings:[],chartValues:[]},this._biometricsRepository.getBiometricLog(this.biometricType,this.intervalsType,this.from,this.to,this.userId).then(function(t){e.isLoading=!1,e.log=t,e.formatLog(t),e.modalInstance&&0===e.modalInstance.$$state.status&&e.setReportData()}),this.$rootScope.$broadcast("logListUpdated",this.id)},e.prototype.setBloodPressureFormat=function(){var e=this,t=[[],[]];return e.formattedData.values.filter(function(e){if(e.value&&e.value.indexOf("/")>-1){var i=e.value.split("/");t[0].push(+i[0]),t[1].push(+i[1])}else t[0].push(0),t[1].push(0)}),t},e.prototype.formatLog=function(e){var t=this;t.formattedData=t._healthDataLogConverter.convertBiometricsLog(e,t.intervalsType,t.from,t.to,t.viewMode===t.viewModes.chart),t.id==t._enums.biometricParameterTypes.bloodPressure?t.formattedData.chartValues=t.setBloodPressureFormat():t.formattedData.chartValues=[t.formattedData.values.map(function(e){return e.value})],1===t.formattedData.timings.length&&(t.formattedData.timings.push(t.formattedData.timings[0]),t.formattedData.serverTimings.push(t.formattedData.timings[0]),t.formattedData.values.push(null),t.formattedData.chartValues.push(null),t.formattedData.recordsCount.push(0))},e.prototype.setDateRange=function(e,t,i){this.from=e,this.to=t,this.intervalsType=i,this.loadLog()},e.prototype.setMonthDateRange=function(e,t){vm=this;var i=this._utilities.getMonthDateRange(e,t);this.intervalsType=this.intervalsTypes.day,this.from=i.from,this.to=i.to,this.loadLog()},e.prototype.setIntervalType=function(e){var t=this._utilities.getDateRangeForIntervalType(this.from,this.to,e);this.from=t.from,this.to=t.to,this.loadLog()},e.prototype.prevPage=function(){var e=this._utilities.getPrevDateRange(this.from,this.to,this.intervalsType);this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPage=function(){var e=this._utilities.getNextDateRange(this.from,this.to,this.intervalsType);this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPageAvailable=function(){return this._utilities.getNextDateRangeAvailability(this.from,this.to)},e.prototype.getClassName=function(){return this.className},e.prototype.getClassSelector=function(){return"."+this.className},e.prototype.getIntervalHeader=function(){return this._utilities.getIntervalItemName(this.intervalsType)},e.prototype.getValueHeader=function(){return"Value"}}()},function(e,t,i){angular.module("kw.socialNetwork").component("exerciseLog",{controller:"ExerciseLogController",template:i(132),bindings:{userId:"<",demoMode:"<"}})},function(e,t){e.exports='<div class=panel> <div class=panel-header> <div class=panel-body> <div class=logs-header> <div class=logs-header--item ng-if=!$ctrl.demoMode> <h4>Exercise Log</h4> </div> <div class="logs-header--item logs-header--period-switcher"> <div class=btn-group> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.day ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Records </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.week ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Day </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.month ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Week </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.year ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Month </label> </div> </div> <div class=logs-header--item ng-if=!$ctrl.demoMode> <button class="btn btn-mint btn-print-background" ng-click=$ctrl.modalReport() title=Print></button> </div> </div> <div class=panel-toolbox ng-if=!$ctrl.demoMode> <div class=text-center> <span class=text-light-gray> Enter Your Exercise Data Log For Today </span> </div> <div class="row margin-top-15"> <div class=col-md-6> <div class=form-horizontal> <div class=form-group> <label for=cardioExercise class="col-xs-2 control-label">Cardio</label> <div class="col-sm-10 col-xs-12"> <select class=form-control id=cardioExercise ng-options="exercise as exercise.name for exercise in $ctrl.cardioExercises track by exercise.id" ng-model=$ctrl.cardioExercise></select> </div> </div> <div class=form-group> <label for=cardioDuration class="col-xs-2 control-label">Duration</label> <div class="col-sm-10 col-xs-12"> <div class=row> <div class="col-xs-10 col-md-10 col-lg-11"> <input type=text class=form-control id=cardioDuration ng-model=$ctrl.cardioDuration /> <span class=unit>mins</span> </div> <div class="col-xs-1 col-md-2 col-lg-1 nopadding"> <button class="btn btn-mint btn-add-log-record button-exlog" ng-click=$ctrl.addExerciseLogRecord($ctrl.cardioExercise)> <i class="md md-playlist-plus"></i> </button> </div> </div> </div> </div> </div> </div> <div class=col-md-6> <div class=form-horizontal> <div class=form-group> <label for=strengthExercise class="col-xs-2 control-label">Strength</label> <div class="col-sm-10 col-xs-12"> <select class=form-control id=strengthExercise ng-options="exercise as exercise.name for exercise in $ctrl.strengthExercises track by exercise.id" ng-model=$ctrl.strengthExercise></select> </div> </div> <div class=form-group> <label for=strengthDuration class="col-xs-2 control-label">Duration</label> <div class="col-sm-10 col-xs-12"> <div class=row> <div class="col-xs-10 col-md-10 col-lg-11"> <input type=text class=form-control id=strengthDuration ng-model=$ctrl.strengthDuration /> <span class=unit>mins</span> </div> <div class="col-xs-1 col-md-2 col-lg-1 nopadding"> <button class="btn btn-mint btn-add-log-record button-exlog" ng-click=$ctrl.addExerciseLogRecord($ctrl.strengthExercise)> <i class="md md-playlist-plus"></i> </button> </div> </div> </div> </div> </div> </div> </div> </div> <network-loader visible=$ctrl.isLoading></network-loader> <div class=table-responsive> <table class="table table-bordered table-striped data-table" ng-if="$ctrl.intervalsType !== $ctrl.intervalsTypes.day"> <thead> <tr> <th>Date</th> <th>Cardio Exercise</th> <th>Minutes</th> <th>Strength Exercise</th> <th>Minutes</th> <th>Total Calories Burned</th> </tr> </thead> <tbody> <tr ng-repeat="time in $ctrl.exerciseLog.timings"> <td><span style=display:block;min-width:100px>{{time}}</span></td> <td> {{$ctrl.exerciseLog.values[$index].cardioExercise}} </td> <td>{{$ctrl.exerciseLog.values[$index].cardioMinutes}}</td> <td> {{$ctrl.exerciseLog.values[$index].strengthExercise}} </td> <td>{{$ctrl.exerciseLog.values[$index].strengthMinutes}}</td> <td>{{$ctrl.exerciseLog.values[$index].caloriesBurned}}</td> </tr> </tbody> </table> <table class="table table-bordered table-striped data-table" ng-if="$ctrl.intervalsType === $ctrl.intervalsTypes.day"> <thead> <tr> <th>Date</th> <th>Exercise</th> <th>Minutes</th> <th>Calories Burned</th> </tr> </thead> <tbody> <tr ng-repeat="time in $ctrl.exerciseLog.timings" log-editable-table-row=$ctrl.exerciseLog.values[$index] on-edit="$ctrl.editLogRecord($ctrl.exerciseLog.values[$index], time)" on-delete=$ctrl.deleteLogRecord($ctrl.exerciseLog.values[$index])> <td>{{time}}</td> <td> {{$ctrl.exerciseLog.values[$index].exercise.name ? $ctrl.exerciseLog.values[$index].exercise.name : $ctrl.exerciseLog.values[$index].exercise}} </td> <td>{{$ctrl.exerciseLog.values[$index].minutes}}</td> <td>{{$ctrl.exerciseLog.values[$index].caloriesBurned}}</td> </tr> <tr ng-repeat="time in $ctrl.exerciseLog.timings" ng-if=$ctrl.demoMode> <td>{{time}}</td> <td> {{$ctrl.exerciseLog.values[$index].exercise.name ? $ctrl.exerciseLog.values[$index].exercise.name : $ctrl.exerciseLog.values[$index].exercise}} </td> <td>{{$ctrl.exerciseLog.values[$index].minutes}}</td> <td>{{$ctrl.exerciseLog.values[$index].caloriesBurned}}</td> </tr> </tbody> </table> </div> <div> <div class=pull-right> <button class="btn btn-page-left" ng-click=$ctrl.prevPage()></button> <button class="btn btn-page-right" ng-click=$ctrl.nextPage() ng-disabled=!$ctrl.nextPageAvailable()></button> </div> </div> </div> </div> </div>'},function(e,t){!function(){function e(e,i,o,r,n,a,s,l,c){var d=this;this.demoMode=this.demoMode||!1,this._utilities=i,this._exerciseLogRepository=o,this._healthDataLogConverter=r,this._logEditorModal=n,this._interaction=a,this.$rootScope=s,this.intervalsTypes=e.intervalTypes,this.intervalsType=this.intervalsTypes.year;var u=this._utilities.getDateRangeForIntervalType(null,null,this.intervalsType);this.from=u.from,this.to=u.to,d.isLoading=!0,d.cardioExercises=[],d.strengthExercises=[],d.exercises=[],d.reportTitle="",d.formattedData={},d.formattedData.dates=[],d.modalInstance=null,d.modalReport=function(){d.modalInstance=l(this)},d.$onInit=function(){this._exerciseLogRepository.getExercises(d.userId).then(function(e){e&&(d.exercises=e,d.cardioExercises=e.filter(function(e){return e.type==t.cardio}),d.strengthExercises=e.filter(function(e){return e.type==t.strength}),d.cardioExercise=d.cardioExercises.length>0?d.cardioExercises[0]:null,d.strengthExercise=d.strengthExercises.length>0?d.strengthExercises[0]:null)}),d.loadLog(),g(),f()};var m=function(){d.reportTitle="Exercise Log Report - "+moment(d.from).format("MMMM YYYY"),"undefined"!=typeof d.reportSettings&&(d.reportSettings.filename=p(d.reportTitle),d.reportSettings.title=d.reportTitle)},p=function(e){return e+".pdf"},g=function(){m(),d.reportSettings={orientation:"portrait",unit:"mm",format:{page:{x:297,y:210},title:{x:20,y:20},chart:{x:5,y:35},minimumBottomSpace:100},filename:p(d.reportTitle),title:d.reportTitle}},f=function(){d.reportData={charts:[],tableData:[]},d.setReportData()};d.setMonthDateRange=function(e,t){var i=this._utilities.getMonthDateRange(e,t);d.intervalsType=this.intervalsTypes.day,d.from=i.from,d.to=i.to,m(),d.loadLog()},d.setReportData=function(){if(d.exerciseLog){d.exerciseLog.values=v(d.exerciseLog.values,d.exerciseLog.timings);var e=$(d.exerciseLog.values),t=Object.keys(e).reverse(),i=b(e),o=y(i),r={cols:[{title:"Date",dataKey:"date"},{title:"Activity",dataKey:"activity"},{title:"Cardio Calories",dataKey:"caloriesCardio"},{title:"Strength Calories",dataKey:"caloriesStrength"},{title:"Calories",dataKey:"calories"}],rows:i},n=[{title:"Minutes of exercise per day",series:["Cardio","Strength"],labels:t,values:o.valuesMinutes,options:{type:"bar"}},{title:"Burned calories per day",series:["Cardio","Strength"],labels:t,values:o.valuesCalories,options:{type:"bar"}}];d.reportData.tableData=r,d.reportData.charts=n}};var h=function(e){var t=c("filter")(d.exercises,{id:e.id});if(!(t.length<=0)&&"undefined"!=typeof t[0].type)return t[0].type},v=function(e,t){return e.map(function(e,i){return e.timeLabel=t[i],e})},b=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t.reverse()},y=function(e){var t={valuesMinutes:[[],[]],valuesCalories:[[],[]]};return angular.forEach(e,function(e){t.valuesMinutes[0].push(e.minsCardio),t.valuesMinutes[1].push(e.minsStrength),t.valuesCalories[0].push(e.caloriesCardio),t.valuesCalories[1].push(e.caloriesStrength)}),t},$=function(e){return e.reduce(function(e,i){var o=i.timeLabel.split(" ")[0];if(e[o]=e[o]||{},e[o].minsCardio=e[o].minsCardio||0,e[o].minsStrength=e[o].minsStrength||0,e[o].caloriesStrength=e[o].caloriesStrength||0,e[o].caloriesCardio=e[o].caloriesCardio||0,e[o].calories=e[o].calories||0,e[o].activity=e[o].activity||"",e[o].date=o,"object"==typeof i.exercise){e[o].calories+=parseInt(i.caloriesBurned)||0,e[o].activity+=""===e[o].activity?i.exercise.name:", "+i.exercise.name;var r=h(i.exercise);r===t.cardio&&(e[o].minsCardio+=parseInt(i.minutes),e[o].caloriesCardio+=parseInt(i.caloriesBurned)),r===t.strength&&(e[o].minsStrength+=parseInt(i.minutes),e[o].caloriesStrength+=parseInt(i.caloriesBurned))}return e},{})}}e.$inject=["enums","utilities","exerciseLogRepository","healthDataLogConverter","logEditorModal","interaction","$rootScope","CustomPrintModal","$filter"],angular.module("kw.socialNetwork").controller("ExerciseLogController",e);var t={cardio:1,strength:2};e.prototype.getIntervalHeader=function(){return this._utilities.getIntervalItemName(this.intervalsType)},e.prototype.addExerciseLogRecord=function(e){var i,o=this;switch(e.type){case t.cardio:i=+this.cardioDuration;break;case t.strength:i=+this.strengthDuration}return i?void this._exerciseLogRepository.addExerciseLogRecord(e,i).then(function(){switch(o._interaction.success("Your info was successfully saved"),e.type){case t.cardio:o.cardioDuration=null;break;case t.strength:o.strengthDuration=null}o.loadLog()}).catch(function(e){o._interaction.error("Error! "+e)}):void this._interaction.warning("Please enter minutes count before creating new log record")},e.prototype.setDateRange=function(e,t,i){this.from=e,this.to=t,this.intervalsType=i,this.loadLog()},e.prototype.editLogRecord=function(e,t){var i=this;e.timeLabel=t,e.availableExercises=this.cardioExercises.concat(this.strengthExercises),e.exercise="-"==e.exercise?void 0:e.exercise,this._logEditorModal.show(e,this._utilities.getFullPath("healthData/exerciseLog/edit.html")).then(function(e){return e.id?i._exerciseLogRepository.updateLogRecord(e):i._exerciseLogRepository.addExerciseLogRecord(e.exercise,parseInt(e.minutes),new Date(e.timeLabel))}).then(function(e){i._interaction.success("Exercise log record was successfully changed"),i.loadLog()}).catch(function(e){"cancel"!==e&&i._interaction.error("Error while updating exercise log record. "+e)})},e.prototype.deleteLogRecord=function(e){var t=this;this._interaction.confirm("Are you sure you want to remove exercise log record?").then(function(){return t._exerciseLogRepository.deleteLogRecord(e)}).then(function(){t._interaction.success("Exercise log record was successfully removed"),t.loadLog()}).catch(function(e){"cancel"!==e&&t._interaction.error("Error while deletion exercise log record. "+e)})},e.prototype.loadLog=function(){var e=this;e.isLoading=!0,this._exerciseLogRepository.getLog(this.from,this.to,this.intervalsType,this.userId).then(function(t){var i=e._healthDataLogConverter.convertExerciseLog(t,e.intervalsType,e.from,e.to);e.exerciseLog=JSON.parse(JSON.stringify(i)),e.isLoading=!1,e.modalInstance&&0===e.modalInstance.$$state.status&&e.setReportData()}),this.$rootScope.$broadcast("logListUpdated")},e.prototype.setIntervalType=function(e){var t=this._utilities.getDateRangeForIntervalType(this.from,this.to,e);this.from=t.from,this.to=t.to,this.loadLog()},e.prototype.prevPage=function(){var e=this._utilities.getPrevDateRange(this.from,this.to,this.intervalsType);this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPage=function(){var e=this._utilities.getNextDateRange(this.from,this.to,this.intervalsType);
this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPageAvailable=function(){return this._utilities.getNextDateRangeAvailability(this.from,this.to)}}()},function(e,t){angular.module("kw.socialNetwork").factory("exerciseLogRepository",["$q","CurrentUser","utilities","ApiRequest",function(e,t,i,o){function r(e){return o.get("exercises").then(function(e){return e.entities})}function n(t,r,n){return o.post("user/exercises",{exercise_id:t.id,minutes:r,log_timestamp:n?i.logTimestampValueFromDate(n):i.logTimestampValueFromDate(new Date)}).then(function(e){return e.entity}).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function a(t){return o.put("user/exercises/"+t.id,{exercise_id:t.exercise.id,minutes:+t.minutes}).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function s(t){return o.delete("user/exercises/"+t.id).catch(function(t){return t.data?e.reject(t.data.message):e.reject(t.message)})}function l(e,t,r,n){return o.get("user/exercises/log",{date_from:i.formatDateAsServer(e),date_to:i.formatDateAsServer(t),view:r,user_id:n}).then(function(e){return e.result})}return{getExercises:r,addExerciseLogRecord:n,updateLogRecord:a,deleteLogRecord:s,getLog:l}}])},function(e,t,i){angular.module("kw.socialNetwork").component("dietLog",{controller:"DietLogController",template:i(136),bindings:{demoMode:"<",userId:"<"}})},function(e,t){e.exports='<div class=panel> <div class=panel-header> <div class=panel-body> <div class=logs-header> <div class=logs-header--item ng-if=!$ctrl.demoMode> <h4>Diet Log</h4> </div> <div class="logs-header--item logs-header--period-switcher"> <div class=btn-group> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.day ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Records </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.week ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Day </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.month ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Week </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalsTypes.year ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Month </label> </div> </div> <div class=logs-header--item ng-if=!$ctrl.demoMode> <button class="btn btn-mint btn-print-background" ng-click=$ctrl.modalReport() title=Print></button> </div> </div> <div class=panel-toolbox ng-if=!$ctrl.demoMode ng-form=$ctrl.addDietLogForm> <div class=text-center> <span class=text-light-gray> Enter Your Diet Data Log For Today </span> </div> <div class="form-inline diet-log-new-value"> <div class="data container"> <div class=row> <div class=col-lg-6> <div class=row> <div class="col-sm-3 data-label"> <label for=meal>Meal</label> </div> <div class="col-sm-6 data-control"> <select class="form-control input-block-level" id=meal ng-options="meal as meal.description for (mealType, meal) in $ctrl.meals" ng-model=$ctrl.meal></select> </div> </div> </div> <div class=col-lg-6> <div class=row> <div class="col-sm-3 data-label" style=padding-left:5px> <label for=food>What did you eat?</label> </div> <div class="col-sm-6 data-control"> <input type=text class="form-control input-block-level" id=food ng-model=$ctrl.food uib-typeahead="food as food.name for food in $ctrl.foods | filter:{\'name\': $viewValue} | limitTo:8" placeholder="e.g.: apple" required/> </div> </div> </div> </div> <div class=row> <div class=col-lg-6> <div class=row> <div class="col-sm-3 data-label"> <label for=meal-quantity>Servings</label> </div> <div class="col-sm-6 data-control"> <input type=number id=meal-quantity name=mealQuantity placeholder="e.g.: 12" class="form-control input-block-level" ng-model=$ctrl.quantity min=1 required/> <span ng-show="$ctrl.addDietLogForm.mealQuantity.$invalid && $ctrl.addDietLogForm.mealQuantity.$dirty" class=text-danger>Invalid value</span> </div> </div> </div> <div class=col-lg-6> <div class=row> <div class="col-sm-3 data-label"> </div> <div class="col-sm-6 data-control"> <button class="btn btn-mint btn-add-log-record pull-right" ng-click=$ctrl.addDietLogRecord() style=margin-left:0 ng-disabled=$ctrl.addDietLogForm.$invalid> <i class="md md-playlist-plus"></i> </button> </div> </div> </div> </div> </div> </div> </div> <network-loader visible=$ctrl.isLoading></network-loader> <div class=table-responsive> <table class="table table-bordered table-striped data-table"> <thead> <tr> <th width=20%>{{$ctrl.getIntervalHeader()}}</th> <th width=60%>Food</th> <th width=10%>Calories</th> </tr> </thead> <tbody> <tr ng-if=!$ctrl.demoMode ng-repeat="time in $ctrl.dietLog.timings track by $index" log-editable-table-row=$ctrl.dietLog.values[$index] on-edit="$ctrl.editLogRecord($ctrl.dietLog.values[$index], time)" on-delete=$ctrl.deleteLogRecord($ctrl.dietLog.values[$index])> <td>{{time}}</td> <td class="" width=60%>{{$ctrl.dietLog.values[$index].food.name}}</td> <td>{{$ctrl.dietLog.values[$index].calories}}</td> </tr> <tr ng-if=$ctrl.demoMode ng-repeat="time in $ctrl.dietLog.timings track by $index"> <td>{{time}}</td> <td class="" width=60% title={{$ctrl.dietLog.values[$index].food.name}}>{{$ctrl.dietLog.values[$index].food.name}}</td> <td>{{$ctrl.dietLog.values[$index].calories}}</td> </tr> </tbody> </table> </div> <div class=pull-right> <button class="btn btn-page-left" ng-click=$ctrl.prevPage()></button> <button class="btn btn-page-right" ng-click=$ctrl.nextPage() ng-disabled=!$ctrl.nextPageAvailable()></button> </div> </div> </div> </div>'},function(e,t){!function(){function e(e,o,r,n,a,s,l,c){var d=this;this._utilities=o,this._dietLogRepository=r,this._healthDataLogConverter=n,this._logEditorModal=a,this._interaction=s,this.$rootScope=l,this.intervalsTypes=e.intervalTypes,this.intervalsType=this.intervalsTypes.year,this.meals=t,this.demoMode=this.demoMode||!1,this._dietLogRepository.getFoods().then(function(e){d.foods=e}),this.quantityUnits=i,this.meal=this.meals.breakfast,this.quantityUnit=this.quantityUnits.oz;var u=this._utilities.getDateRangeForIntervalType(null,null,this.intervalsType);this.from=u.from,this.to=u.to,d.reportTitle="",d.formattedData={},d.formattedData.dates=[],d.modalInstance=null,this.modalReport=function(){d.modalInstance=c(this)},d.$onInit=function(){d.loadLog(),g(),f()};var m=function(){d.reportTitle="Diet Log Report - "+moment(d.from).format("MMMM YYYY"),"undefined"!=typeof d.reportSettings&&(d.reportSettings.filename=p(d.reportTitle),d.reportSettings.title=d.reportTitle)},p=function(e){return e+".pdf"},g=function(){m(),d.reportSettings={orientation:"portrait",unit:"mm",format:{page:{x:297,y:210},title:{x:20,y:20},chart:{x:5,y:35},minimumBottomSpace:100},filename:p(d.reportTitle),title:d.reportTitle}},f=function(){d.reportData={charts:[],tableData:[]},d.setReportData()};d.setMonthDateRange=function(e){this.from=moment([moment().format("YYYY"),e]).toDate(),this.to=moment([moment().format("YYYY"),e]).add(1,"M").toDate(),this.setIntervalType(this.intervalsTypes.day),m(),this.setReportData()},d.splitValues=function(){d.formattedData.calories=[],angular.forEach(d.formattedData.table.rows,function(e,t){d.formattedData.calories.push(e.calories)})},d.setReportData=function(){if(d.dietLog){d.dietLog.values=h(d.dietLog.values,d.dietLog.timings);var e=y(d.dietLog.values),t=Object.keys(e).reverse(),i=v(e),o=b(i),r={cols:[{title:"Date",dataKey:"date"},{title:"Food",dataKey:"food"},{title:"Quantity",dataKey:"quantity"},{title:"Calories",dataKey:"calories"}],rows:i},n=[{title:"Calories consumed per day",series:["Calories"],labels:t,values:o.valuesCalories,options:{type:"linear"}}];d.reportData.tableData=r,d.reportData.charts=n}};var h=function(e,t){return e.map(function(e,i){return e.timeLabel=t[i],e})},v=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t.reverse()},b=function(e){var t={valuesCalories:[]};return angular.forEach(e,function(e){t.valuesCalories.push(e.calories)}),t},y=function(e){return e.reduce(function(e,t){var i=t.timeLabel.split(" ")[0];return e[i]=e[i]||{},e[i].food=e[i].food||"",e[i].quantity=e[i].quantity||0,e[i].calories=e[i].calories||0,e[i].fat=e[i].fat||0,e[i].carbs=e[i].carbs||0,e[i].protein=e[i].protein||0,e[i].fiber=e[i].fiber||0,e[i].date=i,"object"==typeof t.food&&(e[i].calories+="-"!==t.calories?parseInt(t.calories):0,e[i].quantity+="-"!==t.quantity?parseInt(t.quantity):0,e[i].food+=""===e[i].food?t.food.name:""),e},{})}}e.$inject=["enums","utilities","dietLogRepository","healthDataLogConverter","logEditorModal","interaction","$rootScope","CustomPrintModal"],angular.module("kw.socialNetwork").controller("DietLogController",e);var t={breakfast:{value:1,description:"Breakfast"},lunch:{value:2,description:"Lunch"},dinner:{value:3,description:"Dinner"},snack:{value:4,description:"Snack"}},i={oz:{value:1,description:"oz"},ml:{value:2,description:"ml"}};e.prototype.getIntervalHeader=function(){return this._utilities.getIntervalItemName(this.intervalsType)},e.prototype.addDietLogRecord=function(){var e=this;return this.quantity&&this.food?"undefined"==typeof this.food.id&&"string"==typeof this.food?void this._interaction.warning('"Food field value" is not within the list of food. You can add it via the "Custom Options" menu.'):void this._dietLogRepository.addDietLogRecord(this.quantityUnit.value,+this.quantity,this.food,this.meal.value).then(function(){e._interaction.success("Diet log record was added successfully"),e.quantity=null,e.food=null,e.addDietLogForm.$setPristine(),e.loadLog()}).catch(function(t){e._interaction.error("Error! "+angular.toJson(t))}):void this._interaction.warning("Please fill all fields before adding new log record")},e.prototype.setDateRange=function(e,t,i){this.from=e,this.to=t,this.intervalsType=i,this.loadLog()},e.prototype.editLogRecord=function(e,t){var i=this;e.timeLabel=t,e.availableMeals=this.meals,e.availableFoods=this.foods,this._logEditorModal.show(e,this._utilities.getFullPath("healthData/dietLog/edit.html")).then(function(e){return e.id?i._dietLogRepository.updateLogRecord(e):i._dietLogRepository.addDietLogRecord(e.food.id,parseInt(e.quantity),e.food,e.meal.value,new Date(e.timeLabel))}).then(function(e){i._interaction.success("Diet log record was successfully changed"),i.loadLog()}).catch(function(e){"cancel"!==e&&i._interaction.error("Error while updating diet log record. "+e)})},e.prototype.deleteLogRecord=function(e){var t=this;this._interaction.confirm("Are you sure you want to remove diet log record?").then(function(){return t._dietLogRepository.deleteLogRecord(e)}).then(function(){t._interaction.success("Diet log record was successfully removed"),t.loadLog()}).catch(function(e){"cancel"!==e&&t._interaction.error("Error while deletion diet log record. "+e)})},e.prototype.loadLog=function(){var e=this;e.isLoading=!0,this._dietLogRepository.getLog(this.from,this.to,this.intervalsType,this.userId).then(function(t){if("day"==e.intervalsType){moment.tz.guess();t=t.map(function(e){return e.start_time=moment.unix(e.start_time).format("YYYY-MM-DD"),e})}var i=e._healthDataLogConverter.convertDietLog(t,e.intervalsType,e.from,e.to);e.dietLog=JSON.parse(JSON.stringify(i)),e.isLoading=!1,e.modalInstance&&0===e.modalInstance.$$state.status&&e.setReportData()}),this.$rootScope.$broadcast("logListUpdated",this.id)},e.prototype.setIntervalType=function(e){var t=this._utilities.getDateRangeForIntervalType(this.from,this.to,e);this.from=t.from,this.to=t.to,this.loadLog()},e.prototype.prevPage=function(){var e=this._utilities.getPrevDateRange(this.from,this.to,this.intervalsType);this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPage=function(){var e=this._utilities.getNextDateRange(this.from,this.to,this.intervalsType);this.from=e.from,this.to=e.to,this.loadLog()},e.prototype.nextPageAvailable=function(){return this._utilities.getNextDateRangeAvailability(this.from,this.to)}}()},function(e,t){angular.module("kw.socialNetwork").factory("dietLogRepository",["utilities","CurrentUser","ApiRequest","$q",function(e,t,i,o){function r(){return i.get("foods?limit=5000").then(function(e){return e.entities})}function n(t,r,n,a,s){return i.post("user/diets",{type:t,quantity:r,food_id:n.id,log_timestamp:s?e.logTimestampValueFromDate(s):e.logTimestampValueFromDate(new Date),meal:a}).then(function(e){return e.entity}).catch(function(e){return e.data?o.reject(e.data.message):o.reject(e.message)})}function a(e){return i.put("user/diets/"+e.id,{food_id:e.food.id,meal:e.meal.value,quantity:+e.quantity}).then(function(e){return e.entity}).catch(function(e){return e.data?o.reject(e.data.message):o.reject(e.message)})}function s(e){return i.delete("user/diets/"+e.id).catch(function(e){return e.data?o.reject(e.data.message):o.reject(e.message)})}function l(t,o,r,n){return i.get("user/diets/log",{date_from:e.formatDateAsServer(t),date_to:e.formatDateAsServer(o),view:r,user_id:n}).then(function(e){return e.result})}return{getFoods:r,addDietLogRecord:n,updateLogRecord:a,deleteLogRecord:s,getLog:l}}])},function(e,t,i){angular.module("kw.socialNetwork").component("medicationLog",{controller:"MedicationLogController",template:i(140),bindings:{userId:"<",demoMode:"<"}})},function(e,t){e.exports='<div class="panel medication-log"> <div class=panel-header> <div class=panel-body> <div class=logs-header> <div class="" ng-if=!$ctrl.demoMode> <h4 class=mobile-padding-25>Medication Log</h4> </div> <div class="logs-header--item logs-header--period-switcher" ng-show=false> <div class=btn-group> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalTypes.day ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Day </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalTypes.week ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Week </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalTypes.month ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Month </label> <label class="btn btn-default-outline" uib-btn-radio=$ctrl.intervalTypes.year ng-model=$ctrl.intervalsType ng-change=$ctrl.setIntervalType($ctrl.intervalsType)> Year </label> </div> </div> <div class="" ng-if=!$ctrl.demoMode> <button class="btn btn-mint btn-print-background" ng-click=$ctrl.modalReport() title=Print></button> </div> </div> <div class=panel-toolbox ng-if=!$ctrl.demoMode ng-form=$ctrl.medicationLogForm> <div class=text-center> <span class="text-light-gray mobile-padding-15-left">Enter Your Medication Data Log</span> </div> <div class=medication-log-new-value> <div class="data container"> <div class=row> <div class=col-lg-6> <div class=row> <div class="col-md-3 data-label"> <label for=medication>Add Medication</label> </div> <div class="col-md-9 data-control"> <input type=text id=medication name=medication class=form-control ng-model=$ctrl.logRecord.medication placeholder="e.g.: aspirin" ng-pattern="/^[a-zA-Z0-9 ._-]+$/" required/> <span ng-show="$ctrl.medicationLogForm.medication.$invalid && $ctrl.medicationLogForm.medication.$dirty" class=text-danger>Invalid text</span> </div> </div> </div> <div class=col-lg-6> <div class=row> <div class="col-md-3 data-label"> <label for=medication-condition>Condition</label> </div> <div class="col-md-9 data-control"> <input type=text class=form-control id=medication-condition name=condition ng-model=$ctrl.logRecord.condition placeholder="e.g.: anemia" ng-pattern="/^[a-zA-Z0-9 ._-]+$/" required/> <span ng-show="$ctrl.medicationLogForm.condition.$invalid && $ctrl.medicationLogForm.condition.$dirty" class=text-danger>Invalid text</span> </div> </div> </div> </div> <div class=row> <div class=col-lg-6> <div class=row> <div class="col-md-3 data-label"> <label for=medication-dosage>Dosage</label> </div> <div class="col-md-9 data-control"> <input type=text id=medication-dosage name=dosage class=form-control placeholder="e.g.: 50mg" ng-model=$ctrl.logRecord.dosage ng-pattern="/^[a-zA-Z0-9 ._-]+$/" required/> <span ng-show="$ctrl.medicationLogForm.dosage.$invalid && $ctrl.medicationLogForm.dosage.$dirty" class=text-danger>Invalid value</span> </div> </div> </div> <div class=col-lg-6> <div class=row> <div class="col-md-3 data-label"> <label for=medication-frequency>Frequency</label> </div> <div class="col-md-9 data-control"> <input type=text class=form-control id=medication-frequency name=frequency placeholder="e.g.: daily" ng-model=$ctrl.logRecord.frequency ng-pattern="/^[a-zA-Z0-9 ._-]+$/"/> <span ng-show="$ctrl.medicationLogForm.frequency.$invalid && $ctrl.medicationLogForm.frequency.$dirty" class=text-danger>Invalid value</span> </div> </div> </div> <div class=col-lg-6 ng-if=false> <div class=row> <div class="col-md-2 data-label"> <label for=medication-from>From Date</label> </div> <div class="col-md-4 data-control"> <input type=text class="form-control hfc-datepicker" ng-model=$ctrl.logRecord.from id=medication-from /> </div> <div class="col-md-2 data-label"> <label for=medication-to>To Date</label> </div> <div class="col-md-4 data-control"> <input type=text class="form-control hfc-datepicker" ng-model=$ctrl.logRecord.to id=medication-to /> </div> </div> </div> </div> </div> <div class=button> <button class="btn btn-mint btn-add-log-record" ng-click=$ctrl.createMedicationLogRecord() ng-disabled=$ctrl.medicationLogForm.$invalid><i class="md md-playlist-plus"></i></button> </div> </div> </div> <network-loader visible=$ctrl.isLoading></network-loader> <div class=table-responsive> <table class="table table-bordered table-striped data-table" ng-if="$ctrl.intervalsType === $ctrl.intervalTypes.day"> <thead> <tr> <th>Medication</th> <th>Dosage</th> <th>Frequency</th> <th>Condition</th> </tr> </thead> <tbody> <tr ng-if=!$ctrl.demoMode ng-repeat="row in $ctrl.medicationLog.values.slice((($ctrl.medicationLogPagination.currentPage-1)*$ctrl.medicationLogPagination.itemsPerPage), (($ctrl.medicationLogPagination.currentPage)*$ctrl.medicationLogPagination.itemsPerPage))" log-editable-table-row=row select-row=$ctrl.setLogRecordSelected(row) on-edit=$ctrl.editLogRecord(row) on-delete=$ctrl.deleteLogRecord(row)> <td>{{row.medication}}</td> <td>{{row.dosage}}</td> <td>{{row.frequency}}</td> <td>{{row.condition}}</td> </tr> <tr ng-if=$ctrl.demoMode ng-repeat="row in $ctrl.medicationLog.values.slice((($ctrl.medicationLogPagination.currentPage-1)*$ctrl.medicationLogPagination.itemsPerPage), (($ctrl.medicationLogPagination.currentPage)*$ctrl.medicationLogPagination.itemsPerPage))"> <td>{{row.medication}}</td> <td>{{row.dosage}}</td> <td>{{row.frequency}}</td> <td>{{row.condition}}</td> </tr> </tbody> </table> <table class="table table-bordered table-striped data-table" ng-if="$ctrl.intervalsType !== $ctrl.intervalTypes.day"> <thead> <tr> <th>{{$ctrl.getIntervalHeader()}}</th> <th>Medication</th> <th>Condition</th> </tr> </thead> <tbody> <tr ng-repeat="timing in $ctrl.medicationLog.timings"> <td>{{timing}}</td> <td> {{$ctrl.medicationLog.values[$index].medication}} </td> <td> {{$ctrl.medicationLog.values[$index].condition}} </td> </tr> </tbody> </table> </div> <div> <div class=pull-right> <uib-pagination total-items=$ctrl.medicationLogPagination.totalItems ng-model=$ctrl.medicationLogPagination.currentPage ng-change=pageChanged() class=pagination-sm items-per-page=$ctrl.medicationLogPagination.itemsPerPage></uib-pagination> </div> </div> </div> </div> </div>'},function(e,t){!function(){function e(e,t,i){return e.medication?e.condition?e.dosage?e.from&&!e.to?(t.error("Please select 'to' date"),!1):e.to&&!e.from?(t.error("Please select 'from' date"),!1):((!e.from&&!e.to||moment(e.from).isSame(i,"day")&&moment(e.to).isSame(e.from,"day"))&&(e.from=i,e.to=new Date(e.from.getFullYear(),e.from.getMonth(),e.from.getDate()+1,0,0,-1)),!0):(t.error("Please enter dosage"),!1):(t.error("Please enter condition"),!1):(t.error("Please enter medication"),!1)}function t(e,t,i,o,r,n,a,s,l){var c=this;this._utilities=t,this._medicationLogRepository=i,this._interaction=n,this._healthDataLogConverter=o,this._logEditorModal=a,this._appRoot=s,this.$rootScope=r,this.intervalTypes=e.intervalTypes,this.intervalsType=this.intervalTypes.year,this.demoMode=this.demoMode||!1,this.logRecord={},c.isLoading=!0,c.reportTitle="",c.formattedData={},c.formattedData.dates=[],c.modalInstance=null,this.modalReport=function(){c.modalInstance=l(this)},c.medicationLogPagination={totalItems:0,itemsPerPage:10,currentPage:1,maxSize:5},c.$onInit=function(){c.setIntervalType(c.intervalTypes.day),m(),p()};var d=function(){c.reportTitle="Medication Log Report - "+moment(c.from).format("MMMM YYYY"),"undefined"!=typeof c.reportSettings&&(c.reportSettings.filename=u(c.reportTitle),c.reportSettings.title=c.reportTitle)},u=function(e){return e+".pdf"},m=function(){d(),c.reportSettings={orientation:"portrait",unit:"mm",format:{page:{x:297,y:210},title:{x:20,y:20},chart:{x:5,y:35},minimumBottomSpace:100},filename:u(c.reportTitle),title:c.reportTitle}},p=function(){c.reportData={charts:[],tableData:[]},c.setReportData()};c.setMonthDateRange=function(e,t){var i=this._utilities.getMonthDateRange(e,t);c.intervalsType=this.intervalTypes.day,c.from=i.from,c.to=i.to,d(),c.loadLog()},c.splitValues=function(){c.formattedData.calories=[],angular.forEach(c.formattedData.table.rows,function(e,t){c.formattedData.calories.push(e.calories)})},c.setReportData=function(){if(c.reportData.hideDropdownMonth=!0,c.medicationLog){c.medicationLog.values=g(c.medicationLog.values,c.medicationLog.timings);var e=[];angular.forEach(c.medicationLog.values,function(t){var i={date:t.timeLabel,medication:t.medication,dosage:t.dosage,frequency:t.frequency,condition:t.condition};e.push(i)});var t={cols:[{title:"Date",dataKey:"date"},{title:"Medication",dataKey:"medication"},{title:"Dosage",dataKey:"dosage"},{title:"Frequency",dataKey:"frequency"},{title:"Condition",dataKey:"condition"}],rows:e},i=[];c.reportData.tableData=t,c.reportData.charts=i}};var g=function(e,t){return e.map(function(e,i){return e.timeLabel=t[i],e})}}t.$inject=["enums","utilities","medicationLogRepository","healthDataLogConverter","$rootScope","interaction","logEditorModal","appRoot","CustomPrintModal"],angular.module("kw.socialNetwork").controller("MedicationLogController",t);t.prototype.createMedicationLogRecord=function(){var t=this;e(this.logRecord,this._interaction,this._utilities.getTodayDate())&&this._medicationLogRepository.addMedicationLogRecord(this.logRecord).then(function(e){t._interaction.success("Your data for Medication Log was created successfully"),t.logRecord.from=null,t.logRecord.to=null,t.loadLog()}).catch(function(e){t._interaction.error("Error while creating new Medication Log record. "+e)})},t.prototype.getIntervalHeader=function(){return this._utilities.getIntervalItemName(this.intervalsType)},t.prototype.setDateRange=function(e,t,i){this.from=e,this.to=t,this.intervalsType=i,this.loadLog()},t.prototype.setIntervalType=function(e){this.intervalsType=e;var t=this._utilities.getDateRangeForIntervalType(this.from,this.to,this.intervalsType);this.from=t.from,this.to=t.to,this.loadLog()},t.prototype.loadLog=function(){var e=this;e.isLoading=!0,this._medicationLogRepository.getMedicationLog(this.intervalsType,this.userId).then(function(t){var i=e._healthDataLogConverter.convertMedicationLog(t,e.intervalsType,e.from,e.to),o={serverTimings:[],recordsCount:[],timings:[],values:[]};i.recordsCount.forEach(function(e,t){1===e&&(o.serverTimings.push(i.serverTimings[t]),o.recordsCount.push(i.recordsCount[t]),o.timings.push(i.timings[t]),o.values.push(i.values[t]))}),e.medicationLogPagination.totalItems=o.timings.length,e.medicationLog=JSON.parse(JSON.stringify(o)),e.isLoading=!1,e.setReportData()}),this.$rootScope.$broadcast("logListUpdated")},t.prototype.toggleMedicationTaken=function(e){var t=this;this._medicationLogRepository.setMedicationTaken(e,e.isTaken).then(function(){t._interaction.success("Changes were successfully saved")}).catch(function(i){t._interaction.error("Error! "+i),e.isTaken=!e.isTaken})},t.prototype.deleteLogRecord=function(e){var t=this;this._interaction.confirm("Are you sure you want to remove this record?").then(function(){return t._medicationLogRepository.deleteMedicationLogRecord(e)}).then(function(){t._interaction.success("Record was successfully removed"),t.loadLog()}).catch(function(e){"cancel"!==e&&t._interaction.error(e)})},t.prototype.editLogRecord=function(t){var i=this;this._logEditorModal.show(t,this._appRoot+"/healthData/medicationLog/edit.html").then(function(t){if(e(t,i._interaction,moment(t.start_time).startOf("day").toDate()))return i._medicationLogRepository.editMedicationLogRecord(t)}).then(function(e){e&&(i._interaction.success("Changes were saved successfully"),i.loadLog())}).catch(function(e){"cancel"!==e&&i._interaction.error("Error! "+e)})},t.prototype.setLogRecordSelected=function(e){this.currentLogRecord=e},t.prototype.nextPageAvailable=function(){return this._utilities.getNextDateRangeAvailability(this.from,this.to)}}()},function(e,t){angular.module("kw.socialNetwork").factory("medicationLogRepository",["ApiRequest","$q","utilities",function(e,t,i){function o(){return e.get("medications?limit=10000").then(function(e){return e.entities})}function r(){return t(function(e){e([{id:1,name:"anemia"}])})}function n(o){return o.log_timestamp=i.logTimestampValueFromDate(new Date),o.from&&(o.date_from=i.formatDateTimeAsServer(o.from)),o.to&&(o.date_to=i.formatDateTimeAsServer(o.to)),e.post("user/medications",o).then(function(e){return e.entry}).catch(function(e){return e.data?t.reject(e.data.message):t.reject(e.message)})}function a(t,i){return e.get("user/medications/log",{view:t,user_id:i}).then(function(e){return e.result})}function s(o,r){var n=angular.copy(o);return r?n.taken=i.formatDateTimeAsServer(o.start_time):(delete n.taken,n.un_taken=i.formatDateTimeAsServer(o.start_time)),e.put("user/medications/"+o.id,n).catch(function(e){return e.data?t.reject(e.data.message):t.reject(e.message)})}function l(i){return e.delete("user/medications/"+i.id).catch(function(e){return e.data?t.reject(e.data.message):t.reject(e.message)})}function c(o){var r=angular.copy(o);return r.from&&(r.date_from=i.formatDateTimeAsServer(r.from)),r.to&&(r.date_to=i.formatDateTimeAsServer(r.to)),delete r.taken,e.put("user/medications/"+r.id,r).catch(function(e){return e.data?t.reject(e.data.message):t.reject(e.message)})}return{getMedications:o,getConditions:r,addMedicationLogRecord:n,getMedicationLog:a,setMedicationTaken:s,deleteMedicationLogRecord:l,editMedicationLogRecord:c}}])},function(e,t,i){i(144),angular.module("kw.socialNetwork").component("advertisings",{bindings:{},controller:"AdvertisingsCtrl",template:i(145)})},function(e,t){function i(e,t){function i(){o._NetworkService.getAdvertisings().then(function(e){angular.forEach(e.entities,function(e,t){e.image||(e.image={},e.image.path="/img/social-network/logo_contour.png")}),o.items=e.entities})}var o=this;o._NetworkService=e,o.init=function(){o.items=[],i()},o.imageDetail=function(e){e.image.path.indexOf("logo_contour")==-1&&t.openModal([e.image.path],0)},o.init()}i.$inject=["NetworkService","lightbox"],angular.module("kw.socialNetwork").controller("AdvertisingsCtrl",i)},function(e,t){e.exports='<div class=advertisings-header> Advertisements </div> <div ng-show="$ctrl.items.length == 0">There aren\'t news.</div> <div ng-repeat="item in $ctrl.items" class=advertising ng-href=item.image.path> <a class=imagelink ng-click=$ctrl.imageDetail(item) ng-show=item.image> <img ng-src={{item.image.path}} ng-class="{\'logoimg\':item.image.id}" alt=""/> </a> <div class=advertising-body> <h3 ng-show=item.title>{{item.title}}</h3> <p data-ng-bind=item.content></p> <p class=viewmore ng-show=item.url> <a href={{item.url}} target=_blank>More details +</a> </p> </div> </div>'},function(e,t,i){i(147),i(149),i(151),angular.module("kw.socialNetwork").component("administrateLogs",{bindings:{},template:i(153)})},function(e,t,i){function o(e,t,i,o,r,n){var a=this;this.iss=t(e),this.exerciseTypes=i.exerciseTypes,this.entity={},this._interaction=o,this.loadMore=function(){return this.iss.loadMore()},this.$onInit=function(){this.loadMore()},this.startEditRecord=function(e){this.entity=angular.copy(e),this.goToEdit()},this.deleteRecord=function(t){e.delete(t.id).then(function(){a.iss.reload()},function(e){a._interaction.warning("Cannot delete this record. There are logs where this exercise is assigned to.")})},this.save=function(){e.save(this.entity).then(function(){a.iss.reload(),a.entity={},a.customExerciseForm.$setPristine()})},this.goToEdit=function(){var e="customExerciseForm";n.yOffset=100,r.hash(e),n()}}o.$inject=["ExercisesResource","InfiniteScrollService","enums","interaction","$location","$anchorScroll"],angular.module("kw.socialNetwork").component("administrateExercises",{bindings:{},template:i(148),controller:o})},function(e,t){e.exports='<div id=customExerciseForm class=row ng-form=$ctrl.customExerciseForm> <div class="col-sm-4 form-group"> <custom-text-input placeholder=Name custom-class=form-control name=exercise_name ng-model=$ctrl.entity.name required></custom-text-input> </div> <div class="col-sm-3 form-group"> <select class=form-control ng-model=$ctrl.entity.type ng-options="value as value | exerciseType for (key, value) in $ctrl.exerciseTypes" required> <option value="">Select type of exercise</option> </select> </div> <div class="col-sm-3 form-group"> <div class=form-group> <input placeholder="Calories per hour" type=number name=calories_per_minutes class=form-control ng-model=$ctrl.entity.calories_per_minutes min=1 required ng-pattern=/^\\d+$/ /> <span ng-show="$ctrl.customExerciseForm.calories_per_minutes.$invalid && $ctrl.customExerciseForm.calories_per_minutes.$dirty" class=text-danger>Invalid value</span> </div> </div> <div class="col-sm-2 form-group"> <button class="btn btn-primary" ng-click=$ctrl.save() ng-disabled=$ctrl.customExerciseForm.$invalid> <i class="md md-playlist-plus"></i> </button> </div> </div> <network-loader visible=$ctrl.iss.isLoading()></network-loader> <div class=list-empty ng-if=$ctrl.iss.noRecords()>List of exercises is empty</div> <div class=table-responsive> <table class="table table-bordered table-striped data-table" ng-if=!$ctrl.iss.noRecords()> <thead> <tr> <th>Name</th> <th>Type of exercise</th> <th width=20%>Calories per hour</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="exercise in $ctrl.iss.getRecords()"> <td>{{exercise.name}}</td> <td>{{exercise.type | exerciseType}}</td> <td>{{exercise.calories_per_minutes}}</td> <td> <a href="" ng-click=$ctrl.startEditRecord(exercise)>Edit</a> | <a href="" ng-click=$ctrl.deleteRecord(exercise)>Delete</a> </td> </tr> </tbody> </table> </div> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>'},function(e,t,i){function o(e,t,i,o,r){var n=this;this.iss=t(e),this.entity={},this._interaction=i,this.loadMore=function(){return this.iss.loadMore()},this.$onInit=function(){this.loadMore()},this.startEditRecord=function(e){this.entity=angular.copy(e),this.goToEdit()},this.deleteRecord=function(t){var i=this;e.delete(t.id).then(function(){n.iss.reload()},function(e){i._interaction.warning("Cannot delete this record. There are logs where this food is assigned to.")})},this.save=function(){this.entity.fat=0,this.entity.carbs=0,this.entity.protein=0,this.entity.fiber=0,e.save(this.entity).then(function(){n.iss.reload(),n.entity={},n.customFoodForm.$setPristine()})},this.goToEdit=function(){var e="customFoodForm";o.yOffset=100,r.hash(e),o()}}o.$inject=["FoodsResource","InfiniteScrollService","interaction","$anchorScroll","$location"],angular.module("kw.socialNetwork").component("administrateFoods",{bindings:{},template:i(150),controller:o})},function(e,t){e.exports='<div class=row id=customFoodForm ng-form=$ctrl.customFoodForm> <div class="col-sm-4 form-group"> <custom-text-input placeholder=Name custom-class=form-control name=food_name ng-model=$ctrl.entity.name required></custom-text-input> </div> <div class="col-sm-4 form-group"> <input placeholder=Calories type=number name=calories class=form-control ng-model=$ctrl.entity.calories min=1 required ng-pattern=/^\\d+$/ /> <span ng-show="$ctrl.customFoodForm.calories.$invalid && $ctrl.customFoodForm.calories.$dirty" class=text-danger>Invalid value</span> </div> <div class="col-sm-4 form-group" data-ng-if=false> <input placeholder=Fat type=number class=form-control ng-model=$ctrl.entity.fat /> </div> <div class="col-sm-3 form-group"> <button class="btn btn-primary" ng-click=$ctrl.save() ng-disabled=$ctrl.customFoodForm.$invalid> <i class="md md-playlist-plus"></i> </button> </div> </div> <div class=row data-ng-if=false> <div class="col-sm-3 form-group"> <input placeholder=Carbs type=number class=form-control ng-model=$ctrl.entity.carbs /> </div> <div class="col-sm-3 form-group"> <input placeholder=Protein type=number class=form-control ng-model=$ctrl.entity.protein /> </div> <div class="col-sm-3 form-group"> <input placeholder=Fiber type=number class=form-control ng-model=$ctrl.entity.fiber /> </div> </div> <network-loader visible=$ctrl.iss.isLoading()></network-loader> <div class=list-empty ng-if=$ctrl.iss.noRecords()>List of food is empty</div> <div class=table-responsive> <table class="table table-bordered table-striped data-table" ng-if=!$ctrl.iss.noRecords()> <thead> <tr> <th>Name</th> <th>Calories</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="exercise in $ctrl.iss.getRecords()"> <td>{{exercise.name}}</td> <td>{{exercise.calories}}</td> <td> <a href="" ng-click=$ctrl.startEditRecord(exercise)>Edit</a> | <a href="" ng-click=$ctrl.deleteRecord(exercise)>Delete</a> </td> </tr> </tbody> </table> </div> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>';
},function(e,t,i){function o(e,t){var i=this;this.iss=t(e),this.entity={},this.loadMore=function(){return this.iss.loadMore()},this.$onInit=function(){this.loadMore()},this.startEditRecord=function(e){this.entity=angular.copy(e)},this.deleteRecord=function(t){e.delete(t.id).then(function(){i.iss.reload()})},this.save=function(){e.save(this.entity).then(function(){i.iss.reload(),i.entity={}})}}o.$inject=["MedicationsResource","InfiniteScrollService"],angular.module("kw.socialNetwork").component("administrateMedications",{bindings:{},template:i(152),controller:o})},function(e,t){e.exports='<div class=row> <div class="col-sm-4 form-group"> <input placeholder=Name type=text class=form-control ng-model=$ctrl.entity.name /> </div> <div class="col-sm-2 form-group"> <button class="btn btn-primary" ng-click=$ctrl.save()> <i class="md md-playlist-plus"></i> </button> </div> </div> <network-loader visible=$ctrl.iss.isLoading()></network-loader> <div class=list-empty ng-if=$ctrl.iss.noRecords()>List of medications is empty</div> <table class="table table-responsive" ng-if=!$ctrl.iss.noRecords()> <thead> <tr> <td>Name</td> <td>Actions</td> </tr> </thead> <tbody> <tr ng-repeat="exercise in $ctrl.iss.getRecords()"> <td>{{exercise.name}}</td> <td> <a href="" ng-click=$ctrl.startEditRecord(exercise)>Edit</a> | <a href="" ng-click=$ctrl.deleteRecord(exercise)>Delete</a> </td> </tr> </tbody> </table> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>'},function(e,t){e.exports='<div class=panel> <ul class="nav nav-tabs nav-tabs-line"> <li ui-sref-active=active> <a ui-sref=health-data.administrate-exercises> Exercises </a> </li> <li ui-sref-active=active> <a ui-sref=health-data.administrate-foods> Food </a> </li> </ul> <div class=iis-list ui-view> </div> </div>'},function(e,t,i){i(155),i(156),i(157),i(158),i(159),i(162),i(165),i(168),i(171),i(173),i(181),angular.module("kw.socialNetwork").component("network",{controller:"NetworkController",template:i(184)})},function(e,t){!function(){function e(e,t){this.showPostEditor=function(){e()},t.updateCounters(),this.openUserProfile=function(e){window.location.href="/social-network/user-profile/"+e.username}}e.$inject=["PostEditor","SnNotifications"],angular.module("kw.socialNetwork").controller("NetworkController",e)}()},function(e,t){angular.module("kw.socialNetwork").factory("NetworkService",["ApiRequest",function(e){function t(t){return e.get("snposts/"+t)}function i(t,i){return e.get("snposts",{order:"DESC",offset:t,user_id:i})}function o(t){return e.post("snposts",t).then(function(e){return e.entity})}function r(t){return e.delete("snposts/"+t.id).then(function(e){return 200==e.status})}function n(t){return e.put("snposts/"+t.id,t).then(function(e){})}function a(t){return e.post("sncomments",t).then(function(e){return e.entity})}function s(t){return e.delete("sncomments/"+t.id).then(function(e){return 200==e.status})}function l(t){return e.put("sncomments",t.id).then(function(e){})}function c(t){return e.post("sncares",{snpost_id:t.id}).then(function(e){return e.entity})}function d(t){return e.post("sncares",{sncomment_id:t.id}).then(function(e){return e.entity})}function u(){return e.get("advertisings")}function m(t){return e.delete("media/private/"+t).then(function(e){return 200===e.status})}return{getUserFeed:i,createPost:o,deletePost:r,updatePost:n,commentPost:a,deleteComment:s,updateComment:l,carePost:c,careComment:d,getAdvertisings:u,deleteUploadedFile:m,getPost:t}}])},function(e,t){angular.module("kw.socialNetwork").factory("SymbolResource",function(){function e(e){var t=e.split(":");return o[t[0]][t[1]]}function t(e){var t,i;for(t in o)for(i in o[t])if(o[t][i]===e)return t+":"+i;return"empty:empty"}var i="/img/symbols/",o={Hearts:{angry:{title:"angry",src:i+"heart_angry.png"},blush:{title:"blush",src:i+"heart_blush.png"},cool:{title:"cool",src:i+"heart_cool.png"},happy:{title:"happy",src:i+"heart_happy.png"},holdbreath:{title:"holdbreath",src:i+"heart_holdbreath.png"},jolly:{title:"jolly",src:i+"heart_jolly.png"},kiss:{title:"kiss",src:i+"heart_kiss.png"},lol:{title:"lol",src:i+"heart_lol.png"},love:{title:"love",src:i+"heart_love.png"},puzzled:{title:"puzzled",src:i+"heart_puzzled.png"},sad:{title:"sad",src:i+"heart_sad.png"},sleep:{title:"sleep",src:i+"heart_sleep.png"},surprised:{title:"surprised",src:i+"heart_surprised.png"},tongue:{title:"tongue",src:i+"heart_tongue.png"}},Nature:{cat:{title:"cat",src:i+"nature_cat.png"},chick:{title:"chick",src:i+"nature_chick.png"},daisy:{title:"daisy",src:i+"nature_daisy.png"},dandelion:{title:"dandelion",src:i+"nature_dandelion.png"},dog:{title:"dog",src:i+"nature_dog.png"},fox:{title:"fox",src:i+"nature_fox.png"},lily:{title:"lily",src:i+"nature_lily.png"},owl:{title:"owl",src:i+"nature_owl.png"},pig:{title:"pig",src:i+"nature_pig.png"},pinguin:{title:"pinguin",src:i+"nature_pinguin.png"},poppy:{title:"poppy",src:i+"nature_poppy.png"},reindeer:{title:"reindeer",src:i+"nature_reindeer.png"},sheep:{title:"sheep",src:i+"nature_sheep.png"},tulips:{title:"tulips",src:i+"nature_tulips.png"}},Food:{apple:{title:"apple",src:i+"food_apple.png"},banana:{title:"banana",src:i+"food_banana.png"},berry:{title:"berry",src:i+"food_berry.png"},broccoli:{title:"broccoli",src:i+"food_broccoli.png"},carrot:{title:"carrot",src:i+"food_carrot.png"},cheese:{title:"cheese",src:i+"food_cheese.png"},chilli:{title:"chilli",src:i+"food_chilli.png"},coffee:{title:"coffee",src:i+"food_coffee.png"},corn:{title:"corn",src:i+"food_corn.png"},garlic:{title:"garlic",src:i+"food_garlic.png"},nuts:{title:"nuts",src:i+"food_nuts.png"},olive:{title:"olive",src:i+"food_olive.png"},orange:{title:"orange",src:i+"food_orange.png"},potato:{title:"potato",src:i+"food_potato.png"},salmon:{title:"salmon",src:i+"food_salmon.png"},tea:{title:"tea",src:i+"food_tea.png"}},Misc:{diet:{title:"diet",src:i+"misc_diet.png"},gym:{title:"gym",src:i+"misc_gym.png"},peace:{title:"peace",src:i+"misc_peace.png"},scale:{title:"scale",src:i+"misc_scale.png"},spa:{title:"spa",src:i+"misc_spa.png"},treatment:{title:"treatment",src:i+"misc_treatment.png"},yoga:{title:"yoga",src:i+"misc_yoga.png"}}};return{symbolByLabel:e,labelBySymbol:t,symbols:o}})},function(e,t){angular.module("kw.socialNetwork").component("postColorPicker",{controller:["enums",function(e){this.colors=e.postColors,this.currentColorActive=function(e){return this.color===e},this.chooseColor=function(e){this.color=e}}],bindings:{color:"="},template:'<ul class="attachment-control-colors-list">\t                <li ng-repeat="(name, color) in $ctrl.colors" \t                    ng-style="{backgroundColor: color}"\t                    ng-click="$ctrl.chooseColor(name)"\t                    ng-class="{active: $ctrl.currentColorActive(name)}"></li>\t            </ul>'}).component("postEmojiPicker",{controller:["SymbolResource",function(e){var t="Hearts";this.emojies=e.symbols,this.makeActive=function(e){t=e},this.activeEmojiTab=function(){return this.emojies[t]},this.activeEmojiTabIndex=function(){return t},this.select=function(t){this.onAdd({emojiLabel:e.labelBySymbol(t)})}}],bindings:{onAdd:"&"},template:'<div class="nav-tabs-horizontal">\t            <ul class="nav nav-tabs nav-tabs-sm nav-tabs-line nav-justified">\t                <li ng-repeat="(emojiKey, emojiValue) in $ctrl.emojies" ng-class="{active: $ctrl.activeEmojiTabIndex() === emojiKey}">\t                    <a ng-click="$ctrl.makeActive(emojiKey)">{{emojiKey}}</a>\t            </ul>\t            <div class="tab-content">\t                <div class="tab-pane clearfix active">\t                    <div class="pane-icon-container col-xs-3" ng-repeat="(emojiKey, emojiValue) in $ctrl.activeEmojiTab()" ng-click="$ctrl.select(emojiValue)">\t                        <img ng-src="{{emojiValue.src}}"/>\t                    </div>\t                </div>\t            </div>\t        </div>'}).component("postIcons",{bindings:{icons:"=",onDelete:"&"},controller:["SymbolResource",function(e){this.symbolByLabel=e.symbolByLabel,this.delete=function(e){this.onDelete&&this.onDelete({index:e})}}],template:'<div class="snpost-emojies clearfix">\t            <div class="snpost-emojies-item" ng-repeat="lbl in $ctrl.icons track by $index" ng-click="$ctrl.delete($index)">\t                <img ng-src="{{$ctrl.symbolByLabel(lbl).src}}" />\t            </div>\t        </div>'}).component("sharedProfile",{bindings:{profile:"="},template:'<div class="snpost-shared-profile clearfix" ng-if="$ctrl.profile">\t            <div class="avatar" ng-style="{backgroundImage: \'url(\' + $ctrl.profile.avatar + \')\'}"></div>\t            <h3><a ui-sref="userProfile({username: $ctrl.profile.username})">{{$ctrl.profile.name}}</a></h3>\t        </div>'}).component("networkLoader",{bindings:{visible:"="},template:'<div class="text-center" ng-if="$ctrl.visible">\t            <i class="fa fa-spinner fa-spin fa-3x"></i>\t        </div>'}).directive("uAvatar",function(){return{restrict:"E",scope:{user:"=",src:"=",classes:"="},replace:!0,controller:["$scope",function(e){e.getStyles=function(){var t={};return e.src?t.backgroundImage="url("+e.src+")":e.user&&(e.user.avatar?t.backgroundImage="url("+e.user.avatar+")":e.user.id&&(t.backgroundImage="url(/avatars/user/"+e.user.id+".jpg)")),t}}],template:'<div class="u-avatar" ng-class="classes" ng-style="getStyles()"></div>'}}).directive("reactionPostLink",function(){return{restrict:"E",scope:{data:"="},transclude:!0,template:"\t                <a ui-sref='network.post({id: data.post_id})'>\t                    <span ng-transclude></span>\t                    <span ng-if='data.post_text'>\"{{data.post_text | makeShortText}}\"</span>\t                </a>\t            "}})},function(e,t,i){i(160),angular.module("kw.socialNetwork").component("posts",{controller:"PostsController",bindings:{userId:"="},template:i(161)})},function(e,t){!function(){function e(e,t,i,o){function r(e,t){a.addPostToList(t)}var n,a=this,s=i;a.iss=o(s),a.deletePost=function(e){var i=n.indexOf(e);n.splice(i,1),t.success("Post was removed")},a.addPostToList=function(e){n.unshift(e)},a.$onInit=function(){a.iss.init({params:{user_id:a.userId}}),n=a.iss.getRecords(),a.iss.loadMore(),e.on("snpost:added",r)},a.$onDestroy=function(){e.off("snpost:added",r)}}e.$inject=["GlobalEventsManager","NotificationManager","SnPostsResource","InfiniteScrollService"],angular.module("kw.socialNetwork").controller("PostsController",e)}()},function(e,t){e.exports='<network-loader visible=$ctrl.iss.isLoading()></network-loader> <div class=panel ng-if=$ctrl.iss.noRecords()> <div class=panel-body> <h3>Your posts feed is empty :(</h3> </div> </div> <div ng-if=!$ctrl.iss.noRecords() class=clearfix> <sn-post post=post on-delete=$ctrl.deletePost(post) ng-repeat="post in $ctrl.iss.getRecords()"/> </div> <a class=load-more-snposts ng-click=$ctrl.iss.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>'},function(e,t,i){i(163),angular.module("kw.socialNetwork").component("snPost",{bindings:{post:"<",hideActions:"<",onDelete:"&"},template:i(164),controller:"SnPostCtrl"})},function(e,t){!function(){function e(e,t,i,o,r,n,a,s){var l=this;this._PostEditor=r,this._NetworkService=t,this._NotificationManager=o,this._Socialshare=s,this._identity=i.getIdentity(),l.newComment="",l.replies=0,l.replyToComment=null,l.getColorByName=n.getColorByName,l.commentFormVisible=!1,l.userLogged=i.isAuthenticated(),l.$onInit=function(){l.commentsArray=angular.copy(l.post.comments),l.getReplies(),l.post.comments=this.groupComments(l.post.comments),l.hideActions=!l.userLogged||l.hideActions,l.shareUrl=window.location.origin+a+l.post.id},e.$on("ToggleSnCommentForm",function(e,t){l.toggleCommentForm(t)}),e.$on("RemoveSnComment",function(e,t){l.removeComment(t)})}function t(e){window.location.href="/social-network/user-profile/"+e.username}function i(e){e.children=[],this.commentsArray.push(e),this.refreshComments(this.commentsArray),this.commentFormVisible=!1}function o(e){this.commentFormVisible=!this.commentFormVisible,e?this.replyToComment=e:this.replyToComment=null}function r(e){this._PostEditor({sharingPost:e}).then(function(e){console.log(e)})}function n(e,t){var i=this;return e.is_public?void i._Socialshare.share({provider:t,attrs:{socialshareUrl:i.shareUrl}}):void this._NetworkService.updatePost({id:e.id,is_public:!0}).then(function(){e.is_public=!0,i._Socialshare.share({provider:t,attrs:{socialshareUrl:i.shareUrl}})})}function a(){var e=this;this._NetworkService.carePost(this.post).then(this.careHandler(this.post.cares)).catch(function(t){console.log(t),e._NotificationManager.addToQueue("Care wasn't added","danger")})}function s(e){return e=e||this.post.cares,this.searchUserCareInArray(e)>-1}function l(e){var t,i=this.post.comments,o=i.length,r=0;for(t=0;t<o;t++)i[t].parent.id===e.id&&r++;return r}function c(){var e=this;return this._NetworkService.deletePost(e.post).then(function(t){t&&e.onDelete&&e.onDelete({post:e.post})})}function d(e){for(var t=this._identity.id,i=0,o=e.length;i<o;i++)if(e[i].user_id===t)return i;return-1}function u(e){var t=this;return function(i){var o,r=!i.id;r?(o=t.searchUserCareInArray(e),o>-1&&e.splice(o,1)):e.push(i)}}function m(){this.replies=this.commentsArray.length}function p(e,t,i){var o=this;i="undefined"!=typeof i?i:[],t="undefined"!=typeof t?t:{id:0};var r=e.filter(function(e,i){return"undefined"!=typeof e.parent?e.parent.id==t.id:0==t.id});return"undefined"!=typeof r&&r.length>0&&(0==t.id?i=r:t.children=r,r.forEach(function(t){o.unflatten(e,t)})),i}function g(e){if(e.length>0)return this.unflatten(e)}function f(e){var t=this;return t._NetworkService.deleteComment(e).then(function(e){e&&t._NetworkService.getPost(t.post.id).then(function(e){e&&(t.post=e.entity,t.commentsArray=t.refreshComments(t.post.comments),t.getReplies())})})}function h(e){return delete this.post.comments,e=this.groupComments(e),this.getReplies(),this.post.comments=angular.copy(e),"undefined"==typeof e?[]:e}e.$inject=["$scope","NetworkService","CurrentUser","NotificationManager","PostEditor","utilities","sharedPostRoot","Socialshare"],angular.module("kw.socialNetwork").controller("SnPostCtrl",e),e.prototype={addCommentToPost:i,toggleCommentForm:o,sharePost:r,sharePostExternal:n,carePost:a,userCared:s,getCountOfReplies:l,removePost:c,searchUserCareInArray:d,careHandler:u,getReplies:m,unflatten:p,groupComments:g,removeComment:f,refreshComments:h,openProfile:t}}()},function(e,t){e.exports='<div class="snpost panel"> <div class=snpost-remove ng-click=$ctrl.removePost() data-ng-hide=!$ctrl.userLogged> ✕ </div> <div class=snpost-body ng-style="{backgroundColor: $ctrl.getColorByName($ctrl.post.color)}"> <div class=snpost-container> <div class="snpost-author snpost-body-author"> <u-avatar user=$ctrl.post.author ng-click=$ctrl.openProfile($ctrl.post.author)></u-avatar> <div class=snpost-author-body> <div class=snpost-author-name> <a ui-sref="userProfile({username: $ctrl.post.author.username})">{{$ctrl.post.author.name}}</a> </div> <div class=snpost-time>{{$ctrl.post.created_at | relativeTime}}</div> </div> </div> <div class=snpost-body-content> <div class=snpost-body-text ng-if=$ctrl.post.message ng-bind-html="$ctrl.post.message | anchorize"></div> <mediaset mset=$ctrl.post.media_set.media_items></mediaset> <sn-post class="clearfix snpost-shared-post" post=$ctrl.post.snpost hide-actions=true ng-if=$ctrl.post.snpost></sn-post> <shared-profile profile=$ctrl.post.profile ng-if=$ctrl.post.profile></shared-profile> <post-icons icons=$ctrl.post.icons ng-if=$ctrl.post.icons></post-icons> <div class="snpost-options clearfix" ng-if=!$ctrl.hideActions> <div class="snpost-actions clearfix"> <div class=snpost-action ng-class="{active: $ctrl.userCared()}" ng-click=$ctrl.carePost()> <i class=snsprite-care></i> Care </div> <div class=snpost-action ng-click=$ctrl.toggleCommentForm()> <i class=snsprite-reply></i> Reply </div> <div class=snpost-action uib-dropdown> <span id=shareMenu uib-dropdown-toggle> <i class=snsprite-share></i> Share <i class="fa fa-angle-down"></i> </span> <ul class=dropdown-menu uib-dropdown-menu aria-labelledby=shareMenu> <li role=presentation> <a href=# ng-click=$ctrl.sharePost($ctrl.post)> <i class=custom-icon></i> HealthLink </a> </li> <li role=presentation data-ng-if="$ctrl.post.author.id === $ctrl._identity.id"> <a href=# ng-click="$ctrl.sharePostExternal($ctrl.post,\'facebook\')"> <i class="fa fa-facebook"></i> Facebook </a> </li> <li role=presentation data-ng-if="$ctrl.post.author.id === $ctrl._identity.id"> <a href=# ng-click="$ctrl.sharePostExternal($ctrl.post,\'twitter\')"> <i class="fa fa-twitter"></i> Twitter </a> </li> <li role=presentation data-ng-if="$ctrl.post.author.id === $ctrl._identity.id"> <a href=# ng-click="$ctrl.sharePostExternal($ctrl.post,\'pinterest\')"> <i class="fa fa-pinterest"></i> Pinterest </a> </li> </ul> </div> </div> <div class="snpost-counters clearfix"> <div class=snpost-counter>Cares <span>{{$ctrl.post.cares.length}}</span></div> <div class=snpost-counter>Replies <span>{{$ctrl.replies}}</span></div> <div class=snpost-counter>Shares <span>{{$ctrl.post.shares_count || 0}}</span></div> </div> </div> </div> </div> </div> <div class=snpost-comments ng-if=!$ctrl.hideActions> <sn-comment comment=comment depth=1 ng-repeat="comment in $ctrl.post.comments track by $index"></sn-comment> <comment-editor on-add=$ctrl.addCommentToPost(comment) post=$ctrl.post replied-to=$ctrl.replyToComment ng-if=$ctrl.commentFormVisible></comment-editor> </div> </div>'},function(e,t,i){i(166),angular.module("kw.socialNetwork").factory("PostEditor",["$uibModal","appRoot",function(e,t){return function(t){return t=t||{},e.open({animation:!0,template:i(167),size:"md",windowClass:"modal-centered",resolve:{data:function(){return t},groups:["partnersRepository",function(e){return e.getNetworkAndGroups(!0)}]},controller:"PostEditorController as $ctrl"}).result}}])},function(e,t){function i(e,t,o,r,n,a,s,l,c,d){function u(e){var t=e.post||{group_id:l.network.id};return e.sharingPost&&(m.sharingPost=e.sharingPost,t.snpost_id=e.sharingPost.id),e.sharingProfile&&(m.sharingProfile=e.sharingProfile,t.profile_id=e.sharingProfile.id),t}var m=this;m.isLoading=!1,m.headerText=s.headerText||"Create new post",m.okBtnText=s.okBtnText||"Post",m.colors=a.postColors,m.getGroupsList=function(){return l.groups},m.otherGroupsOptionDisabled=function(){return 0===l.groups.length},m.addEmoji=function(e){m.post.icons=m.post.icons||[],m.post.icons.push(e)},m.removeEmoji=function(e){m.post.icons.splice(e,1)},m.getPostColor=function(){return n.getColorByName(m.post.color)},m.updateMentions=function(e){m.post.usersId=e},m.init=function(){m.shareWithNetwork=!0,m.targetGroup=m.otherGroupsOptionDisabled?l.groups[0]:null,m.post=u(s),m.post.media=[]},m.cancel=function(){t.dismiss(null)},m.ok=function(){return m.isLoading=!0,m.post.group_id=m.shareWithNetwork?l.network.id:m.targetGroup.id,i.isPostFilled(m.post)?(m.post.media_items=[],m.post.media_items=m.post.media_items.filter(function(e,t){return"undefined"!=typeof t}),m.post.media_items=m.post.media.map(function(e){return e.mediaitemId}),delete m.post.media,void o.createPost(m.post).then(function(e){d.emit("snpost:added",e),r.success("Post created"),t.close(e)}).catch(function(e){r.danger("Post was not created"),t.dismiss(e)})):(m.isLoading=!1,r.danger("Post must include content!"))},m.retryItemUpload=function(e){m.uploadFileByItem(e)},m.discardUploadedFile=function(e){var t=e.path.split("/"),i=t[t.length-1];o.deleteUploadedFile(i)},m.init()}i.$inject=["$rootScope","$uibModalInstance","NetworkService","NotificationManager","utilities","enums","data","groups","NetworkImageUploader","GlobalEventsManager"],angular.module("kw.socialNetwork").controller("PostEditorController",i),i.isPostFilled=function(e){return e.icons&&e.icons.length>0||!!e.message||e.media.length>0||!!e.snpost_id||!!e.profile_id}},function(e,t){e.exports='<div class=modal-header> <span class="modal-title font-size-20">{{$ctrl.headerText}}</span> </div> <fieldset class=modal-body data-ng-disabled=$ctrl.isLoading> <div class="form-group posteditor-message-form-group" ng-style="{backgroundColor: $ctrl.getPostColor()}"> <div class=form-group> <mentions-input model=$ctrl.post.message placeholder="Send Message..." on-ctrl-enter=$ctrl.addComment() on-add=$ctrl.updateMentions(usersId)></mentions-input> </div> <mediaset mset=$ctrl.post.media loader=true retry-item-upload=$ctrl.retryItemUpload(item) discard-uploaded-item=$ctrl.discardUploadedFile(item)></mediaset> <div ng-if=$ctrl.sharingPost> <small class=text-gray>Shared post</small> <sn-post post=$ctrl.sharingPost hide-actions=true class="clearfix snpost-shared-post"></sn-post> </div> <shared-profile profile=$ctrl.sharingProfile ng-if=$ctrl.sharingProfile></shared-profile> <post-icons icons=$ctrl.post.icons on-delete=$ctrl.removeEmoji(index) ng-if=$ctrl.post.icons></post-icons> <div class=form-group> <mediaset-loader mset=$ctrl.post.media upload-file-by-item=$ctrl.uploadFileByItem type="\'image\'"></mediaset-loader> <mediaset-loader mset=$ctrl.post.media upload-file-by-item=$ctrl.uploadVideo type="\'video\'"></mediaset-loader> <attachment-control heading=Symbols btn-class=btn-red body-class=symbols-body> <post-emoji-picker on-add=$ctrl.addEmoji(emojiLabel) /> </attachment-control> <attachment-control heading="Post color" btn-class=btn-green body-class=colors-body> <post-color-picker color=$ctrl.post.color /> </attachment-control> </div> </div> <div class=form-group ng-show=false> <span>Share with:</span> <div class="radio-custom radio-primary radio-lg margin-top-5 margin-bottom-5"> <input type=radio id=allPartners name=share ng-value=true ng-model=$ctrl.shareWithNetwork> <label for=allPartners>My HealthLink Network</label> </div> <div class="radio-custom radio-primary radio-lg margin-top-5 margin-bottom-5"> <input type=radio id=group name=share ng-value=false ng-model=$ctrl.shareWithNetwork ng-disabled=$ctrl.otherGroupsOptionDisabled()> <label for=group>Group</label> <select class="form-control inline-block width-150" ng-options="group as group.name for group in $ctrl.getGroupsList()" ng-model=$ctrl.targetGroup> </select> </div> </div> </fieldset> <network-loader visible=$ctrl.isLoading></network-loader> <fieldset class=modal-footer data-ng-disabled=$ctrl.isLoading> <div class=pull-left> <button class="btn btn-mint" type=button ng-click=$ctrl.ok()>{{$ctrl.okBtnText}}</button> <button class="btn btn-pure" type=button ng-click=$ctrl.cancel()>Cancel</button> </div> </fieldset>'},function(e,t,i){i(169),angular.module("kw.socialNetwork").component("commentEditor",{bindings:{onAdd:"&",post:"=",repliedTo:"="},controller:"CommentEditorController",template:i(170)})},function(e,t){function i(e,t,r,n,a,s,l){function c(e){e=e.replace("link",""),$("html,body").animate({scrollTop:$("#"+e).offset().top-$("#"+e).outerHeight()},"slow")}var d=this;d._NotificationManager=t,d._NetworkService=e,d._utilities=r,d.mediaItemsRoot=s,d.isMobile=l.isMobile,d.$onInit=function(){d.buttonActive=!0,d.locationID="comment-editor-location-"+d.post.id,d.imageUploader=a({onSuccessItem:function(e,t){d.comment.image=d.formatMediaItemPath(t.entity),d.buttonActive=!0,this.queue=[]},onBeforeUploadItem:function(){d.buttonActive=!1},onAfterAddingFile:function(e){d.buttonActive=!0,d.imageUploader.uploadItem(e)},onErrorItem:function(e){switch(d.buttonActive=!0,e._xhr.status){case 413:d.message={text:"Upload failed. Maximum filesize exceeded.",error:!0,notify:!1};break;default:d.message={text:"Upload failed. Please try again.",error:!0,notify:!1}}}}),d.comment=o(d.post,d.repliedTo),d.popoverTemplates={colorPicker:n+"network/commentEditor/colors.html",emojiPicker:n+"network/commentEditor/icons.html"},setTimeout(function(){c(d.locationID)},200)},d.formatMediaItemPath=function(e){return e.path?d.mediaItemsRoot+e.path+m(e)+"/"+u(e):""},d.addComment=function(){var e=this;return i.isCommentFilled(this.comment)?void this._NetworkService.commentPost(this.comment).then(function(t){e.onAdd({comment:t}),e.comment=o(e.post)},function(e){this._NotificationManager.danger("Comment wasn't added! Try again")}):void this._NotificationManager.danger("Comment must include content (icon / message / image)")};var u=function(e){return e.meta_data&&e.meta_data.length>0?e.meta_data[0].extension:""},m=function(e){return e.meta_data&&e.meta_data.length>0?"-"+e.meta_data[0].meta_data.sizes[0]:""}}function o(e,t){return{snpost_id:e.id,message:"",icons:[],color:"gray",parent_id:t?t.id:void 0}}i.$inject=["NetworkService","NotificationManager","utilities","appRoot","NetworkImageUploader","mediaItemsRoot","$rootScope"],angular.module("kw.socialNetwork").controller("CommentEditorController",i),i.prototype={updateMentions:function(e){this.comment.usersId=e},getPostColor:function(){return this._utilities.getColorByName(this.comment.color)},addEmoji:function(e){this.comment.icons.push(e)},removeEmoji:function(e){this.comment.icons.splice(e,1)}},i.isCommentFilled=function(e){return e.icons.length>0||!!e.message||!!e.image}},function(e,t){e.exports='<div ng-attr-id={{$ctrl.locationID}} class=snpost-comment-form ng-style="{backgroundColor: $ctrl.getPostColor()}"> <div class=snpost-container> <div class="snpost-author snpost-comment-form-author"> <div class=u-avatar ng-style="{backgroundImage: \'url(\' + $root.CurrentUser.getAvatar() + \')\'}"></div> </div> <div class=snpost-comment-form-field> <div class=form-group> <mentions-input ng-if=!$ctrl.isMobile model=$ctrl.comment.message on-ctrl-enter=$ctrl.addComment() on-add=$ctrl.updateMentions(usersId) is-mobile=$ctrl.isMobile button-disabled=!$ctrl.buttonActive display-button=true help-text="Use Ctrl+Enter to add new comment"></mentions-input> <mentions-input ng-if=$ctrl.isMobile model=$ctrl.comment.message on-enter=$ctrl.addComment() button-disabled=!$ctrl.buttonActive on-add=$ctrl.updateMentions(usersId) display-button=true is-mobile=$ctrl.isMobile></mentions-input> </div> <div class=snpost-comment-attachments> <label class=snpost-comment-attachments-item for=commentEditorUploader ng-click=$ctrl.addFile()> <i class=snsprite-media_reply></i> </label> <label class=snpost-comment-attachments-item uib-popover-template=$ctrl.popoverTemplates.emojiPicker popover-placement=bottom-right popover-trigger=outsideClick> <i class=snsprite-symbol_reply></i> </label> <label class=snpost-comment-attachments-item uib-popover-template=$ctrl.popoverTemplates.colorPicker popover-placement=bottom-right popover-trigger=outsideClick> <i class=snsprite-color_picker_reply></i> </label> <input id=commentEditorUploader type=file nv-file-select="" uploader=$ctrl.imageUploader class=hidden /> </div> <span data-ng-class="[\'comment-upload-message\', {notify: $ctrl.message.notify},{error: $ctrl.message.error}]" data-ng-bind=$ctrl.message.text></span> <img ng-src={{$ctrl.comment.image}} ng-if=$ctrl.comment.image class=snpost-body-image> <post-icons icons=$ctrl.comment.icons on-delete=$ctrl.removeEmoji(index) ng-if=$ctrl.comment.icons></post-icons> </div> </div> </div>'},function(e,t,i){function o(e,t,i){this.labels=[],this.items=[],this.id=this.id||"b-"+Math.round(1e4*Math.random()),this.tmpl=t+"network/mentionsInput/mentions-list.html",this.debounce=this.debounce||200,i.displayButton=!!i.displayButton&&i.displayButton,console.log(i.displayButton),this._UsersResource=e,this.addComment=function(){i.$parent.$parent.$ctrl.addComment()}}o.$inject=["UsersResource","appRoot","$scope"],angular.module("kw.socialNetwork").component("mentionsInput",{template:i(172),bindings:{id:"@?",helpText:"@?",placeholder:"@?",model:"=",onAdd:"&",debounce:"=?",buttonDisabled:"=",displayButton:"="},controller:o}),o.prototype={search:function(e){var t=this;return t._UsersResource.autocomplete("username",e).then(function(e){return t.items=e,t.items})},select:function(e){var t=j=0,i=this.labels.length;for(t=0;t<i;t++)this.labels[t].name===e.name&&j++;return 0===j?this.labels.push(e):console.warn("Already exists"),this.onAdd&&this.onAdd({usersId:this.labels.map(function(e){return e.id})}),"@"+e.username},delete:function(e){this.model=this.model.replace(new RegExp("@"+e.username,"g"),""),this.labels.splice(this.labels.indexOf(e),1)}}},function(e,t){e.exports='<textarea ng-model=$ctrl.model ng-model-options="{ debounce: $ctrl.debounce }" id={{$ctrl.id}} class=form-control placeholder={{$ctrl.placeholder}} mentio></textarea> <small class="help-block hidden-sm hidden-xs" ng-if=$ctrl.helpText>{{$ctrl.helpText}}</small> <button ng-if=$ctrl.displayButton data-ng-click=$ctrl.addComment() class="btn btn-mint pull-right" data-ng-disabled=$ctrl.buttonDisabled>{{ ($ctrl.buttonDisabled) ? \'Uploading...\' : \'Add Comment\' }}</button> <mentio-menu mentio-for=$ctrl.id mentio-trigger-char="\'@\'" mentio-items=$ctrl.items mentio-template-url=/assets/js/app/social-network/network/mentionsInput/mentions-list.html mentio-search=$ctrl.search(term) mentio-select=$ctrl.select(item)></mentio-menu> <ul class="mentioned-users-list clearfix"> <li class=mentioned-users-list-item ng-repeat="u in $ctrl.labels"> <span ng-click=$ctrl.delete(u) uib-tooltip="Click to delete"> @{{u.username}} </span> </li> </ul>'},function(e,t,i){i(174),i(176),i(178),angular.module("kw.socialNetwork").component("notifications",{bindings:{},template:i(180)})},function(e,t,i){angular.module("kw.socialNetwork").component("partnerRequests",{bindings:{displaysent:"="},template:i(175),controller:["PartnerRequestsResource","InfiniteScrollService","partnersRepository","SnNotifications","enums","NotificationManager","utilities","$scope","$rootScope",function(e,t,i,o,r,n,a,s,l){function c(){i.searchUsersByStatus("1").then(function(e){p.sentRequests=e})}function d(e){n.addToQueue("Error occured. Please, try again.")}var u,m=e,p=this;this.iss=t(m),this.sentRequests=[],this.receivedRequests=[],this.receivedRequests=this.iss.getRecords(),c(),u=this.iss.getRecords(),this.$onInit=function(){var e=p.displaysent?"requests":"received";p.loadMore().then(function(){o.updateCounter(e)})},this.loadMore=function(){return this.iss.loadMore()},p.acceptRequest=function(e){i.updateIncomingRequests(e.id,r.partnershipTypes.ACCEPTED).then(function(t){t&&(n.addToQueue("Request accepted"),o.updateCounters(),l.$broadcast("RefreshAcceptedRequest"),a.removeObjectFromArray(e,u))}).catch(d)},p.rejectRequest=function(e){i.updateIncomingRequests(e.id,r.partnershipTypes.DENIED).then(function(t){t&&(n.addToQueue("Request accepted"),o.updateCounters(),a.removeObjectFromArray(e,u))}).catch(d)},p.removePartner=function(e){i.removePartner(e).then(function(t){t&&(p.sentRequests=p.sentRequests.filter(function(t){return t.id!=e.id}),o.updateCounters(),n.addToQueue("Request canceled"))})},s.$on("RefreshPartnerRequestsSidebar",function(){c()})}]})},function(e,t){e.exports='<network-loader visible=$ctrl.iss.isLoading()></network-loader> <h4>Partner Requests</h4> <div style=margin-bottom:0 class=alert ng-if=$ctrl.iss.noRecords()> Partner requests list is empty. </div> <div class="notification clearfix" ng-class="{\'notification-new\': !req.seen}" ng-repeat="req in $ctrl.receivedRequests"> <div class=notification-avatar> <div class=u-avatar style=background-image:url({{req.group_owner.avatar}})></div> </div> <div class=notification-request-body> <div class=notification-username> <a ui-sref="userProfile({username: req.group_owner.username})">{{req.group_owner.name}}</a> </div> <div class=notification-request-message> </div> </div> <div class=notification-request-btns> <button class="btn btn-green" ng-click=$ctrl.acceptRequest(req)><span class=snsprite-add></span></button> <button class="btn btn-red" ng-click=$ctrl.rejectRequest(req)><span class=snsprite-delete></span></button> </div> </div> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a> <div ng-if=$ctrl.displaysent> <h4>Sent Requests</h4> <div style=margin-bottom:0 class=alert ng-if=!$ctrl.sentRequests.length> No partner requests sent. </div> <div class="notification clearfix" ng-class="{\'notification-new\': !req.seen}" ng-repeat="req in $ctrl.sentRequests"> <div class=notification-avatar> <div class=u-avatar style=background-image:url({{req.avatar}})></div> </div> <div class=notification-request-body> <div class=notification-username> <a ui-sref="userProfile({username: req.username})">{{req.name}}</a> </div> <div class=notification-request-message> </div> </div> <div class=notification-request-btns> <button class="btn btn-red" ng-click=$ctrl.removePartner(req)><span class=snsprite-delete></span> </button> </div> </div> </div>';
},function(e,t,i){angular.module("kw.socialNetwork").component("reactions",{bindings:{},template:i(177),controller:["InfiniteScrollService","ReactionsResource","SnNotifications","enums",function(e,t,i,o){this.nType=function(e,t){return e.type===o.notificationTypes[t]},this.iss=e(t),this.$onInit=function(){this.loadMore().then(function(){i.updateCounter("reactions")})},this.loadMore=function(){return this.iss.loadMore()}}]})},function(e,t){e.exports='<network-loader visible=$ctrl.iss.isLoading()></network-loader> <div style=margin-bottom:0 class=alert ng-if=$ctrl.iss.noRecords()> Reactions list is empty. </div> <div class="notification clearfix" ng-class="{\'notification-new\': !i.seen}" ng-repeat="i in $ctrl.iss.getRecords()"> <div class=notification-avatar> <u-avatar user=i.data.initiator></u-avatar> </div> <div class=notification-message-body> <div class=notification-time>{{i.created_at | relativeTime}}</div> <span class=notification-username> <a ui-sref="userProfile({username: i.user.username})">{{i.user.name}}</a> </span> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'POST_COMMENT\')"> commented your <reaction-post-link data=i.data>post</reaction-post-link> </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'POST_CARE\')"> cared your <reaction-post-link data=i.data>post</reaction-post-link> </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'POST_MENTION\')"> mentioned you in post <reaction-post-link data=i.data>post</reaction-post-link> </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'POST_SHARE\')"> shared your <reaction-post-link data=i.data>post</reaction-post-link> </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'COMMENT_REPLY\')"> replied on your <reaction-post-link data=i.data>post</reaction-post-link> comment </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'COMMENT_CARE\')"> cared your <reaction-post-link data=i.data>post</reaction-post-link> comment </div> <div class=notification-message-body-text ng-if="$ctrl.nType(i, \'COMMENT_MENTION\')"> mentioned you in <reaction-post-link data=i.data>post</reaction-post-link> comment </div> </div> </div> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>'},function(e,t,i){angular.module("kw.socialNetwork").component("updates",{bindings:{},template:i(179),controller:["InfiniteScrollService","SnUpdatesResource","SnNotifications","NotificationManager",function(e,t,i,o){function r(){o.addToQueue("Update post wasn't saved. Try again.","danger")}var n=t,a=this;this.content="",this.iss=e(n,r),this.$onInit=function(){a.loadMore().then(function(){i.updateCounter("updates")})},this.loadMore=function(){return this.iss.loadMore()},this.onCtrlEnter=function(){n.create({content:a.content}).then(function(e){var t=a.iss.getRecords();t.unshift(e.entity),a.content="",o.addToQueue("Update post saved")}).catch(function(e){o.addToQueue("Update post wasn't saved. Try again.","danger")})}}]})},function(e,t){e.exports='<div ng-if=$root.isCurrentUserAdmin()> <h3>Add new update content</h3> <div class=form-group> <ng-wig class=notification-editor ng-model=$ctrl.content buttons=bold,link on-ctrl-enter=$ctrl.onCtrlEnter()></ng-wig> <small class=block-help>Visible to administrators only. Use Ctrl+Enter to add new comment</small> </div> </div> <network-loader visible=$ctrl.iss.isLoading()></network-loader> <div class="notification clearfix" ng-class="{\'notification-new\': !post.seen}" ng-repeat="post in $ctrl.iss.getRecords()"> <div class=notification-updates-body> <div class=notification-time>{{post.created_at | relativeTime}}</div> <div class=notification-updates-content ng-bind-html=post.data.content></div> </div> </div> <a class=load-more-snposts ng-click=$ctrl.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a>'},function(e,t){e.exports='<div class=panel> <ul class="nav nav-tabs nav-tabs-line"> <li ui-sref-active=active> <a ui-sref=network.notifications.partnerRequests> Partner Requests <span class="badge badge-primary">{{$root.SnNotifications.getCounter(\'received\')}}</span> </a> </li> </ul> <div class=notifications-container> <ui-view></ui-view> </div> </div> '},function(e,t,i){i(182),angular.module("kw.socialNetwork").component("snComment",{bindings:{comment:"<",depth:"<"},template:i(183),controller:"SnCommentCtrl"})},function(e,t){!function(){function e(e,t,i,o,r,n){function a(e){for(var t=l._identity.id,i=0,o=e.length;i<o;i++)if(e[i].user_id===t)return i;return-1}function s(e){var t=e.split("-"),i=[];return i[0]={src:t[0]+"/"+t[1].split("/")[1],thumb:t[0]+"-md/"+t[1].split("/")[1],caption:""},i}var l=this;this._NetworkService=i,this._identity=r.getIdentity(),this._NotificationManager=n,l.hasChildren=function(e){return e.children.length>0},l.showReplyButton=function(){return l.depth<3},l.commentClasses=function(){return["snpost-comment","sncomment-depth-"+l.depth]},l.openProfile=function(e){window.location.href="/social-network/user-profile/"+e.username},l.careComment=function(e){var t=this;this._NetworkService.careComment(e).then(this.careHandler(e.cares)).catch(function(e){console.log(e),t._NotificationManager.addToQueue("Care wasn't added","danger")})},l.careHandler=function(e){return function(t){var i,o=!t.id;o?(i=a(e),i>-1&&e.splice(i,1)):e.push(t)}},l.getCountOfReplies=function(e){return e.hasOwnProperty("children")?e.children.length:0},l.searchUserCareInArray=function(e){for(var t=l._identity.id,i=0,o=e.length;i<o;i++)if(e[i].user_id===t)return i;return-1},l.userCared=function(e){return l.searchUserCareInArray(e)>-1},l.toggleCommentForm=function(t){return e.$emit("ToggleSnCommentForm",t),!1},l.openCommentGalery=function(e){t.open(s(e.image))},l.getColorByName=o.getColorByName,l.removeComment=function(t){e.$emit("RemoveSnComment",t)}}e.$inject=["$scope","lightbox","NetworkService","utilities","CurrentUser","NotificationManager"],angular.module("kw.socialNetwork").controller("SnCommentCtrl",e)}()},function(e,t){e.exports='<div ng-class=$ctrl.commentClasses() ng-style="{backgroundColor: $ctrl.getColorByName($ctrl.comment.color)}"> <div class=snpost-remove ng-click=$ctrl.removeComment($ctrl.comment)> ✕ </div> <div class="snpost-container clearfix"> <div class="snpost-author snpost-comment-author"> <u-avatar ng-click=$ctrl.openProfile($ctrl.comment.author) user=$ctrl.comment.author></u-avatar> <div class=snpost-author-body> <div class=snpost-author-name> <a ui-sref="userProfile({username: $ctrl.comment.user.username})">{{$ctrl.comment.author.name}}</a> </div> <div class=snpost-time>{{$ctrl.comment.created_at | relativeTime}}</div> </div> </div> <div class=snpost-comment-content> <div class=snpost-comment-content-text ng-bind-html="$ctrl.comment.message | anchorize"></div> <img class=snpost-body-image ng-src={{$ctrl.comment.image}} ng-if=$ctrl.comment.image ng-click=$ctrl.openCommentGalery($ctrl.comment)> <post-icons icons=$ctrl.comment.icons ng-if=$ctrl.comment.icons></post-icons> </div> </div> <div class=snpost-container> <div class="snpost-options clearfix"> <div class="snpost-actions clearfix"> <div class=snpost-action ng-class="{active: $ctrl.userCared($ctrl.comment.cares)}" ng-click=$ctrl.careComment($ctrl.comment)> <i class=snsprite-care></i> Care </div> <div class=snpost-action ng-click=$ctrl.toggleCommentForm($ctrl.comment) ng-show=$ctrl.showReplyButton()> <i class=snsprite-reply></i> Reply </div> </div> <div class="snpost-counters clearfix"> <div class=snpost-counter>Cares <span>{{$ctrl.comment.cares.length}}</span></div> <div class=snpost-counter>Replies <span>{{$ctrl.getCountOfReplies($ctrl.comment)}}</span></div> </div> </div> </div> </div> <sn-comment ng-if=$ctrl.hasChildren($ctrl.comment) comment=children depth="$ctrl.depth + 1" ng-repeat="children in $ctrl.comment.children track by $index"></sn-comment>'},function(e,t){e.exports='<div class=page-header> <h1 class=page-title>Network</h1> </div> <div class=page-content> <div class=row> <div class=col-md-3> <div class=panel> <div class="panel-body left-menu-container"> <ul class="list-group nav left-menu"> <li class="list-group-item list-group-user"> <u-avatar ng-click=$ctrl.openUserProfile($root.CurrentUser.getIdentity()) user=$root.CurrentUser.getIdentity()></u-avatar> <div class="inline-block vertical-align-middle padding-left-5"> <div class="font-weight-bold font-size-18">{{$root.CurrentUser.getIdentity().username}}</div> <div>{{$root.CurrentUser.getIdentity().name}}</div> </div> </li> <li class=list-group-item ui-sref-active=active> <a ui-sref=network.posts> <i class=snsprite-network></i> Network </a> </li> <li class=list-group-item ui-sref-active=active> <a ui-sref=network.notifications> <i class=snsprite-notifications></i> Notifications <span class="badge badge-primary">{{$root.SnNotifications.getCounter(\'received\')}}</span> </a> </li> </ul> </div> <div class=network-nav-panel> <button class="btn btn-mint btn-block" ng-click=$ctrl.showPostEditor()> <i class=snsprite-add></i> Create new post </button> </div> </div> </div> <div class=col-md-7> <div ui-view></div> </div> <div class=col-md-2> <advertisings></advertisings> </div> </div> </div>'},function(e,t,i){i(186),i(188),i(189),i(190),angular.module("kw.socialNetwork").component("partners",{controller:"PartnersController",template:i(191)})},function(e,t,i){function o(e,t,o,r,n,a,s,l,c){function d(e){return h=r(e.id),f=e,v.iss=n(h),v.iss.init({params:u()}),v.iss.loadMore()}function u(){return{params:{name:v.partnersSearchString,order:w}}}function m(){return v.iss.init(u()),v.iss.loadMore().then(p)}function p(e){b=e.map(function(e){return{member:e.user,checked:!1}})}function g(){t.getNetworkAndGroups(!0).then(function(e){v.network=e.network,v.groups=e.groups,v.chooseGroup(v.network),c.updateCounters()}).catch(function(){o.addToQueue("Impossible to load groups","danger")})}var f,h,v=this,b=[],y=!1,$=!1,w="desc";v.repo=t,v.newGroupName="",v.groupEditors={},v.allPartnersCheckbox=!1,v.iss=null,v.showPartnerRequests=!1,v.$onInit=function(){g()},v.getSelectedGroupMembers=function(){return b},v.isGroupSelected=function(){return!!f&&0===f.length};var k=function(){return b.filter(function(e){return e.checked===!0})};v.anyMemberSelected=function(){return k().length>0},v.toggleCheckbox=function(e){$=!1},v.toggleAllPartnersCheckbox=function(){var e=v.allPartnersCheckbox;b.forEach(function(t){t.checked=e}),$=!1},v.toggleTargetGroupSelectionMode=function(e){$="undefined"==typeof e?!$:e},v.isTargetGroupSelectionMode=function(){return $},v.removeMembersFromSelectedGroup=function(){var e=b.filter(function(e){return e.checked}).map(function(e){return e.member.id});t.deleteUsersFromGroup(f.id,e).then(function(e){o.addToQueue(e+" user(s) removed","danger"),d(f).then(p)}).catch(function(){o.addToQueue("Impossible to delete members from group","danger")})},v.forceUpdateNetworkAndGroups=function(){t.getNetworkAndGroups(!1)},v.onTypeUserSearchField=function(){v.iss&&m()},v.changeGroupPartnersOrder=function(){w=v.isGroupPartnersOrderAsc()?"desc":"asc",v.iss&&m()},v.isGroupPartnersOrderAsc=function(){return"asc"===w},v.deleteGroup=function(e,i){i.stopPropagation(),t.deleteGroup(e).catch(function(){o.addToQueue("Impossible to delete this group","danger")})},v.isGroupSelected=function(e){return e===f},v.chooseGroup=function(e){if(v.showPartnerRequests=!1,v.anyMemberSelected()||($=!1),$)e!==f?t.addUsersToGroup(e.id,k().map(function(e){return e.member.id})).then(function(e){o.addToQueue("User was successfully added to group","success"),$=!1}):o.addToQueue("It's impossible to put user to the same group","danger");else{if(e===f)return;d(e).then(p),v.forceUpdateNetworkAndGroups()}},v.toggleNewGroupEditor=function(){y=!y},v.isNewGroupEditorShown=function(){return y},v.createNewGroup=function(){t.createGroup(v.newGroupName).catch(function(e){e.message?o.addToQueue(e.message,"danger"):o.addToQueue("Impossible to create group","danger")}).finally(function(){v.newGroupName=""})},v.toggleEditingMode=function(e){"undefined"==typeof v.groupEditors[e.id]?v.groupEditors[e.id]={groupName:e.name,opened:!0}:v.groupEditors[e.id].opened=!v.groupEditors[e.id].opened},v.groupInEditingMode=function(e){return!!v.groupEditors[e.id]&&v.groupEditors[e.id].opened},v.updateGroup=function(e,i){t.updateGroup(e,i).then(function(t){v.toggleEditingMode(e)}).catch(function(){o.addToQueue("Impossible to update group name","danger")})},v.showInvitePartnersModal=function(){a.open({animation:!0,template:i(187),size:"md",windowClass:"modal-centered",controller:"InvitePartnersController as $ctrl"})},v.togglePartnerRequests=function(){v.showPartnerRequests=!0},l.$on("RefreshAcceptedRequest",function(){g()})}o.$inject=["$q","partnersRepository","NotificationManager","GroupResource","InfiniteScrollService","$uibModal","appRoot","$scope","SnNotifications"],angular.module("kw.socialNetwork").controller("PartnersController",o)},function(e,t){e.exports='<div class=modal-header> <span class="modal-title font-size-20">Invite Partner(s)</span> </div> <div class=modal-body> <uib-tabset active=0 type="tabs nav-tabs-line"> <uib-tab heading="Invite from HealthLink" select=directiveTabSelect($event)> <div class=invite-users-container> <div class="form-group invite-users-container-form-group"> <label>Search by entering names</label> <input class=form-control ng-model=$ctrl.searchByNameField ng-change=$ctrl.searchByNameFieldChanged() ng-model-options="{debounce: 800}"/> </div> <div class=table-responsive> <network-loader visible=$ctrl.progressBarVisible()></network-loader> <div ng-if=$ctrl.noUsersFoundVisible() class="text-muted text-center"> There are no found users </div> <table class="table invite-users-table"> <tr ng-repeat="user in $ctrl.getFoundUsers() track by $index"> <td style=width:55px> <u-avatar src=user.avatar></u-avatar> </td> <td> <div class=invite-users-table-item-name>{{user.name}}</div> <div class=invite-users-table-item-location>{{user | userLocation}}</div> </td> <td> <div class=invite-users-table-item-invitation-status ng-class="user.status | invitationStatusCssClass" ng-click=$ctrl.invitationAction(user)>{{user.status | userPartnerStatus}}</div> </td> </tr> </table> </div> <button class="btn btn-mint" ng-click=$ctrl.cancel()>Done</button> <button class="btn btn-flat" ng-click=$ctrl.cancel()>Cancel</button> </div> </uib-tab> <uib-tab heading="Invite by Email" select=directiveTabSelect($event)> <div class=invite-users-container> <div class="form-group invite-users-container-form-group"> <label>Enter emails <span class=text-muted>(enter multiple emails separated by commas)</span></label> <textarea class=form-control ng-model=$ctrl.newUsersEmails></textarea> </div> <button class="btn btn-mint" ng-click=$ctrl.sendLetters()>Done</button> <button class="btn btn-flat" ng-click=$ctrl.cancel()>Cancel</button> </div> </uib-tab> </uib-tabset> </div>'},function(e,t){angular.module("kw.socialNetwork").factory("partnersRepository",["$q","ApiRequest","enums","$rootScope",function(e,t,i,o){function r(){n(R,"userGroups")}function n(e,t){localStorage.setItem(t,JSON.stringify(e))}function a(i){return i&&C?e.resolve(C):t.get("user/groups/network").then(function(e){return C=e.entity,n(C,"networkGroup"),C})}function s(){return C}function l(i){return i&&R?e.resolve(R):t.get("user/groups").then(function(e){return R=e.entities,r(),R})}function c(){return R}function d(t){return e.all([a(t),l(t)]).then(function(e){return{network:e[0],groups:e[1]}})}function u(i){return i?t.post("user/groups",{name:i}).then(function(e){return e.entity}).then(function(e){return R.push(e),r(),e}):e.reject(new Error("Group must have name"))}function m(e,i){return t.put("user/groups/"+e.id,{name:i}).then(function(e){return e.entity}).then(function(t){return e.name=i,r(),t})}function p(e){return t.delete("user/groups/"+e.id).then(function(e){return 200===e.status}).then(function(t){return R.splice(R.indexOf(e),1),r(),t})}function g(e,i,o){return t.get("user/groups/"+e+"/members",{sort:o,offset:i}).then(function(e){return e.entities.map(function(e){return e.user})})}function f(e,i){return t.post("user/groups/"+e+"/members",{user_ids:i}).then(function(e){return d(),e.entities})}function h(e,t){return f(e,[t]).then(function(e){return e>0})}function v(e){return a(!0).then(function(t){return h(t.id,e.id)})}function b(e){return a(!0).then(function(t){return $(t.id,[e.id])}).then(function(e){return d(),e>0})}function y(e,i){return t.put("user/groups/members/"+e,{status:i}).then(function(e){return d(),e.entity})}function $(e,i){return t.delete("user/groups/"+e+"/members",{user_ids:i}).then(function(e){return d(),e.removed})}function w(e,i){return t.get("user/groups/"+e+"/members",{name:i}).then(function(e){return e.entities.map(function(e){return e.user})})}function k(i){return i?t.get("user/groups/network/members/search",{name:i}).then(function(e){return e.entities}):e.resolve([])}function x(i){return i?t.get("user/groups/network/members/search",{status:i}).then(function(e){return e.entities}):e.resolve([])}function P(e){return t.get("user/groups/network/members/status",{user_id:e.id}).then(function(e){return e.userStatus})}function T(e,i){return t.put("partner-requests/"+e,{status:i}).then(function(e){return e.entity.status==i})}function _(e){return t.post("user/partners/invite-email",{emails:e}).then(function(e){return e.send_to})}var C=localStorage.networkGroup?JSON.parse(localStorage.networkGroup):null,R=localStorage.userGroups?JSON.parse(localStorage.userGroups):null;return window.addEventListener("storage",function(e){o.$apply(function(){"networkGroup"===e.key?C=JSON.parse(e.newValue):"userGroups"===e.key&&(R=JSON.parse(e.newValue))})}),{getNetworkGroup:a,getAllGroups:l,getNetworkAndGroups:d,createGroup:u,updateGroup:m,deleteGroup:p,getNetworkSync:s,getGroupsSync:c,getGroupMembers:g,addUsersToGroup:f,addUserToGroup:h,addPartner:v,removePartner:b,changePartnershipStatus:y,deleteUsersFromGroup:$,findUserByNameInGroup:w,searchUsersWithStatuses:k,searchUsersByStatus:x,checkUserPartnershipStatus:P,updateIncomingRequests:T,sendInvitations:_}}])},function(e,t){angular.module("kw.socialNetwork").controller("InvitePartnersController",["$uibModalInstance","partnersRepository","NotificationManager","UsersResource","enums","utilities","$rootScope","SnNotifications",function(e,t,i,o,r,n,a,s){var l=this,c=[],d=!1;l.searchByNameField="",l.newUsersEmails="",l.progressBarVisible=function(){return d},l.searchByNameFieldChanged=function(){d=!0,t.searchUsersWithStatuses(l.searchByNameField).then(function(e){c=e}).finally(function(){d=!1})},l.getFoundUsers=function(){return c},l.noUsersFoundVisible=function(){return 0===c.length&&!d},l.invitationAction=function(e){[r.partnershipTypes.ACCEPTED,r.partnershipTypes.PENDING,r.partnershipTypes.DENIED].indexOf(e.status)>=0&&t.removePartner(e).then(function(t){s.updateCounters(),t&&delete e.status}),e.status||t.addPartner(e).then(function(t){s.updateCounters(),a.$broadcast("RefreshPartnerRequestsSidebar"),t&&(e.status=r.partnershipTypes.PENDING)})},l.sendLetters=function(){var o=l.newUsersEmails.split(",");o=o.map(function(e){return e.trim()}).filter(n.isEmail),t.sendInvitations(o).then(function(t){i.success("There are "+t.length+" users were invited"),e.close(t)})},l.cancel=function(){e.dismiss("cancel")}}])},function(e,t){angular.module("kw.socialNetwork").factory("GroupResource",["ApiRequest",function(e){return function(t){return{search:function(i){return e.get("user/groups/"+t+"/members",i||{})}}}}])},function(e,t){e.exports='<div class=page-header> <h1 class=page-title>Partners</h1> </div> <div class=container-fluid> <div class="panel b-partners"> <ul class="b-partners-groups-list animated" ng-class="{bounce: $ctrl.isTargetGroupSelectionMode()}"> <li class="help-block text-center" ng-if=$ctrl.isTargetGroupSelectionMode()> <small class="animated fadeInDown">Choose group to put users inside &darr;</small> </li> <li> <a ng-click=$ctrl.chooseGroup($ctrl.network) ng-class="{active: $ctrl.isGroupSelected($ctrl.network) && !$ctrl.showPartnerRequests}"> <i class="icon wb-users" aria-hidden=true></i> All Partners <span class=b-partners-counter>{{$ctrl.repo.getNetworkSync().members_count || 0}}</span> </a> </li> <li class=separator></li> <li ng-repeat="g in $ctrl.repo.getGroupsSync() track by $index"> <a ng-click=$ctrl.chooseGroup(g) ng-class="{active: $ctrl.isGroupSelected(g)}" ng-if=!$ctrl.groupInEditingMode(g)> {{g.name}} <span class=b-partners-counter>{{g.members_count || 0}}</span> <div class=b-partners-item-actions> <i class="icon md-edit" ng-click=$ctrl.toggleEditingMode(g)></i> <i class="icon md-delete" ng-click="$ctrl.deleteGroup(g, $event)"></i> </div> </a> <div class=item-wrapper ng-if=$ctrl.groupInEditingMode(g)> <div class=b-group-editor> <div class=b-group-editor-form> <input type=text class="form-control input-sm" ng-model=$ctrl.groupEditors[g.id].groupName> </div> <div class=b-group-editor-actions> <i class="icon md-check" ng-click="$ctrl.updateGroup(g, $ctrl.groupEditors[g.id].groupName)"></i> <i class="icon md-close" ng-click=$ctrl.toggleEditingMode(g)></i> </div> </div> </div> </li> <li ng-if=$ctrl.isNewGroupEditorShown()> <div class=item-wrapper> <div class=b-group-editor> <div class=b-group-editor-form> <input type=text class="form-control input-sm" ng-model=$ctrl.newGroupName> </div> <div class=b-group-editor-actions> <i class="icon md-check" ng-click=$ctrl.createNewGroup()></i> <i class="icon md-close" ng-click=$ctrl.toggleNewGroupEditor()></i> </div> </div> </div> </li> <li> <a ng-click=$ctrl.togglePartnerRequests() ng-class="{active: $ctrl.showPartnerRequests}"> <i class="icon wb-inbox" aria-hidden=true></i> Partner Requests <span class=b-partners-counter>{{$root.SnNotifications.getCounter(\'requests\')}}</span> </a> </li> </ul> <div class=b-partners-group-details ng-hide=$ctrl.showPartnerRequests> <h4>My Partners</h4> <div class="b-partners-group-details-actionbar clearfix"> <button class="btn btn-pure btn-icon" ng-click=$ctrl.toggleTargetGroupSelectionMode() ng-disabled=!$ctrl.anyMemberSelected()> <i class="icon md-folder"></i> </button> <button class="btn btn-pure btn-icon" ng-click=$ctrl.removeMembersFromSelectedGroup() ng-disabled=!$ctrl.anyMemberSelected()> <i class="icon md-delete"></i> </button> <button class="btn btn-pure btn-icon" ng-click=$ctrl.forceUpdateNetworkAndGroups() title="Force group counters update"> <i class="icon md-refresh"></i> </button> <div class="input-search input-search-dark inline-block"> <i class="input-search-icon fa fa-search" aria-hidden=true></i> <input type=text class="form-control input-sm" name="" placeholder=Search... ng-model=$ctrl.partnersSearchString ng-model-options="{debounce: 800}" ng-change=$ctrl.onTypeUserSearchField() /> </div> <button class="btn btn-mint pull-right invite-partners" ng-click=$ctrl.showInvitePartnersModal()>Invite Partners</button> </div> <div class="b-partners-table table-responsive"> <network-loader visible=$ctrl.iss.isLoading()></network-loader> <table class=table ng-if=!$ctrl.iss.isLoading()> <thead> <tr> <th style=width:50px> <span class="checkbox-custom checkbox-primary checkbox-lg"> <input ng-disabled="$ctrl.getSelectedGroupMembers().length == 0" type=checkbox class="contacts-checkbox selectable-item" id=partners-all ng-change=$ctrl.toggleAllPartnersCheckbox() ng-model=$ctrl.allPartnersCheckbox /> <label for=partners-all></label> </span> </th> <th> <span ng-click=$ctrl.changeGroupPartnersOrder()> Name (sort by) <i class="icon margin-left-15" ng-class="$ctrl.isGroupPartnersOrderAsc() ? \'md-chevron-up\' : \'md-chevron-down\'"></i> </span> </th> </tr> </thead> <tbody> <tr ng-repeat="i in $ctrl.getSelectedGroupMembers() track by $index"> <td style=vertical-align:middle> <span class="checkbox-custom checkbox-primary checkbox-lg"> <input type=checkbox class="contacts-checkbox selectable-item" id=partners-{{$index}} ng-model=i.checked ng-change=$ctrl.toggleCheckbox(i) /> <label for=partners-{{$index}}></label> </span> </td> <td> <a class=b-partners-profile-link ui-sref="userProfile({username: i.member.username})"> <u-avatar classes="[\'u-avatar-inline\', \'pull-left\']" src=i.member.avatar></u-avatar> <span class="b-partners-profile-username pull-left">{{i.member.name}}</span> </a> </td> </tr> </tbody> </table> <a class=load-more-snposts ng-click=$ctrl.iss.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a> </div> </div> <div class=b-partners-group-details ng-show=$ctrl.showPartnerRequests> <partner-requests displaysent=true class=b-partners-requests></partner-requests> </div> </div> </div>'},function(e,t,i){i(193),i(194),i(197),i(201),angular.module("kw.socialNetwork").component("myAccount",{controller:"MyAccountController",template:i(205)})},function(e,t){!function(){function e(){}angular.module("kw.socialNetwork").controller("MyAccountController",e)}()},function(e,t,i){function o(){var e=this;e.status=!1}i(195),angular.module("kw.socialNetwork").component("myProfile",{controller:"MyProfileController",bindings:{},template:i(196)}),angular.module("kw.socialNetwork").component("profileSettingsInput",{bindings:{vOption:"@",label:"@",inputModel:"@"},transclude:!0,template:'\t    <div class="my-profile-input-block clearfix">\t        <div class="my-profile-input-block-label">{{$ctrl.label}}</div>\t        <div class="my-profile-input-block-fields-wrapper">\t            <div class="my-profile-input-block-fields">\t                <div class="my-profile-input-block-control" ng-transclude></div>\t                <div class="my-profile-input-block-option" ng-if="$ctrl.vSettingShown()">\t                    <i class="cursor-pointer icon md-eye-off" ng-class="{\'md-eye\': $ctrl.status}" ng-click="$ctrl.toggleVOption($event)"></i>\t                </div>\t            </div>\t        </div>\t    </div>\t    ',controller:o}),o.prototype={vSettingShown:function(){return"undefined"!=typeof this.vOption},toggleVOption:function(e){this.status=!this.status;var t=document.querySelector('input[ng-model="$ctrl.'+this.vOption+'"]');this.status?t.type="text":t.type="password"}}},function(e,t){!function(){function e(e,t,i,o,r,n,a){function s(e){l.profile=angular.extend(e),l.profile.birthday=new Date(l.profile.birthday)}var l=this;l.profile={},l.userSettings={},l.avatarUploader=new n({url:a+"users/upload",autoUpload:!0,queueLimit:1}),l.timezones=moment.tz.names(),l._loadPageData=function(){return e.all([t.getUser(),i.get()]).then(function(e){return s(e[0]),l.userSettings=angular.extend(e[1]),!0})},l.avatarLoaderBindEvents=function(){return l.avatarUploader.onSuccessItem=function(e,i){o.update(l.profile.id,{avatar:i.file}).then(function(e){r.success("Avatar successfully changed"),l.profile.avatar=e.entity.avatar,t.setAvatar(l.profile.avatar),l.avatarUploader.queue=[]},function(e){r.danger("Avatar wasn't changed, try again")})},l.avatarUploader},l.updatePassword=function(){o.update(l.profile.id,l.credentials).then(function(e){r.success("Password changed")},function(e){console.log(e),r.danger(e&&e.data&&e.data.data&&e.data.data[0].message||"Passwords are not equal")})},l.updateProfile=function(){var e={name:l.profile.name,occupation:l.profile.occupation,phone:l.profile.phone,city:l.profile.city,state:l.profile.state,country:l.profile.country,birthday:+l.profile.birthday/1e3,sex:l.profile.sex,timezone:l.profile.timezone,condition:l.profile.condition,introduction:l.profile.introduction};o.update(l.profile.id,e).then(function(e){return s(e.entity),e.entity}).then(function(){return i.update(l.userSettings)}).then(function(){r.success("Profile updated")})},l.$onInit=function(){l._loadPageData().then(l.avatarLoaderBindEvents)}}e.$inject=["$q","CurrentUser","UserSettingsService","UsersResource","NotificationManager","FileUploader","API_URL"],angular.module("kw.socialNetwork").controller("MyProfileController",e)}()},function(e,t){e.exports='<div class=panel> <div class=panel-body> <h4>Profile</h4> <div class=row> <div class="col-sm-3 text-center"> <u-avatar user=$ctrl.profile></u-avatar> <label class="btn btn-inverse margin-top-15"> Replace Photo <input type=file nv-file-select="" uploader=$ctrl.avatarUploader accept=image/* class=hidden /> </label> </div> <div class=col-sm-6> <profile-settings-input label=Username> <input type=text class=form-control ng-model=$ctrl.profile.username disabled=disabled maxlength=255 /> </profile-settings-input> <profile-settings-input label=Name> <input type=text class=form-control ng-model=$ctrl.profile.name maxlength=255 /> </profile-settings-input> <profile-settings-input label=Email> <input type=text class=form-control ng-model=$ctrl.profile.email disabled=disabled maxlength=255 /> </profile-settings-input> <profile-settings-input label=Occupation> <input type=text class=form-control ng-model=$ctrl.profile.occupation maxlength=255 /> </profile-settings-input> <profile-settings-input label=Phone> <input type=text class=form-control ng-model=$ctrl.profile.phone maxlength=255 ui-mask="(999) 999-9999" ui-mask-placeholder ui-mask-placeholder-char=_ /> </profile-settings-input> </div> </div> <div class="row margin-top-30"> <div class="col-sm-6 profile-updating-password"> <h4>Change password</h4> <form class=form-horizontal ng-submit=$ctrl.updatePassword()> <profile-settings-input label=Password v-option=credentials.oldPassword> <input type=password class=form-control ng-model=$ctrl.credentials.oldPassword /> </profile-settings-input> <profile-settings-input label="New Password" v-option=credentials.password> <input type=password class=form-control ng-model=$ctrl.credentials.password /> </profile-settings-input> <profile-settings-input label="Re-type Password" v-option=credentials.confirm> <input type=password class=form-control ng-model=$ctrl.credentials.confirm /> </profile-settings-input> <div class=clearfix> <button type=submit class="btn btn-inverse padding-right-40 padding-left-40 margin-top-15 pull-right">Update</button> </div> </form> </div> <div class=col-sm-6> <profile-settings-input label=City> <input type=text class=form-control ng-model=$ctrl.profile.city maxlength=255 /> </profile-settings-input> <profile-settings-input label=State> <input type=text class=form-control ng-model=$ctrl.profile.state maxlength=255 /> </profile-settings-input> <profile-settings-input label=Country> <input type=text class=form-control ng-model=$ctrl.profile.country maxlength=255 /> </profile-settings-input> <profile-settings-input label=Timezone> <select class=form-control id=timezone ng-options="timezone for timezone in $ctrl.timezones" ng-model=$ctrl.profile.timezone> </select> </profile-settings-input> <profile-settings-input label=Birthday> <input type=text id=birthday class="hfc-datepicker form-control" ng-model=$ctrl.profile.birthday maxlength=255 /> </profile-settings-input> <profile-settings-input label=Sex> <select class=form-control id=gender ng-options="gender.id as gender.name for gender in $root.enums.genders" ng-model=$ctrl.profile.sex> </select> </profile-settings-input> <profile-settings-input label=Condition> <textarea ng-model=$ctrl.profile.condition class=form-control maxlength=1024></textarea> </profile-settings-input> <profile-settings-input label=Introduction> <textarea ng-model=$ctrl.profile.introduction class=form-control maxlength=1024></textarea> </profile-settings-input> <div class=clearfix> <button class="btn btn-mint pull-right padding-right-40 padding-left-40 margin-right-30" ng-click=$ctrl.updateProfile()>Save</button> </div> </div> </div> </div> </div>'},function(e,t,i){i(198),i(199),angular.module("kw.socialNetwork").component("myHealthGoals",{controller:"MyHealthGoalsController",bindings:{userId:"<",demoMode:"<"},template:i(200)})},function(e,t){function i(e,t,i,o,r){function n(e,t){return e instanceof Array&&(!t||"string"==typeof t)&&(t&&"string"==typeof t?e.filter(function(e,i,o){return o.map(function(e){return e[t]}).indexOf(e[t])===i}):e.filter(function(e,t,i){return i.indexOf(e)==t}))}var a=this,s=[{name:"Lose 10-20% of body weight"
},{name:"Exercise 4 or more days every week"},{name:"Miss no doses of medications"},{name:"Maintain systolic blood pressure below 130"},{name:"Stop smoking, No fast food"},{name:"Avoid unintended hospital admissions"},{name:"Maintain blood sugar goals within targets"}],l=o("user/goals-log");a.selectedGoalRow=[],a.demoMode=a.demoMode||!1,a.selectedGoal=null,a.typedGoal="",a.iss=r(l),a.ivalidGoal=!1,a.$onInit=function(){a.demoMode||c(),a.iss.init({params:{user_id:a.userId}}),a.iss.loadMore()};var c=function(){e.getUserGoals().then(function(e){a.predefinedGoals=n(s.concat(e),"name")})};a.addGoal=function(){var o;if(!a.typedGoal&&!a.selectedGoal)return void i.addToQueue("Please type goal name or choose existing goal from the list","warning");if(a.typedGoal)o=e.createUserGoal({name:a.typedGoal,type:t.goalsTypes.private}).then(function(e){return a.updateGoalsList(e)});else if("undefined"==typeof a.selectedGoal.type){var r={name:a.selectedGoal.name,type:t.goalsTypes.private};o=e.createUserGoal(r).then(function(e){return a.updateGoalsList(e)})}else o=e.createLogItem(a.selectedGoal);return o.then(function(e){var t=a.iss.getRecords();t.unshift(e),a.typedGoal="",c(),i.addToQueue("Goal added","success")}).catch(function(e){i.addToQueue(e,"danger")})},a.updateGoalsList=function(t){return a.predefinedGoals.push(t),a.predefinedGoals=n(a.predefinedGoals,"name"),e.createLogItem(t)},a.updateLogItemStatus=function(t){a.demoMode||e.toggleLogItemStatus(t).then(function(e){t.achieved=e.achieved,t.log_timestamp=e.log_timestamp,i.addToQueue("Goal was market as "+(t.achieved?"":"not")+" achieved","success")},function(e){i.addToQueue(e,"danger")})},a.removeLogItem=function(t){e.removeLogItem(t).then(function(e){if(e){var i=a.iss.getRecords();i.splice(i.indexOf(t),1),c()}}).catch(function(e){i.addToQueue(e.message,"danger")})},a.isLogItemInEditingMode=function(e){return!!e.editingMode},a.switchEditingMode=function(e){e.editingMode=!e.editingMode,e.newGoal=angular.copy(e.goal)},a.editLogItem=function(t){""==t.newGoal.name?a.ivalidGoal=!0:(t.goal.name=t.newGoal.name,e.updateGoal(t.goal).then(function(e){a.ivalidGoal=!1,t.editingMode=!1}))}}i.$inject=["myHealthGoalsRepository","enums","NotificationManager","ResourceService","InfiniteScrollService"],angular.module("kw.socialNetwork").controller("MyHealthGoalsController",i)},function(e,t){angular.module("kw.socialNetwork").factory("myHealthGoalsRepository",["ApiRequest","CurrentUser","utilities",function(e,t,i){function o(){return e.get("user/goals",{limit:9e3}).then(function(e){return e.entities},u)}function r(t){return e.put("user/goals/"+t.id,t).then(function(e){return e.entities},u)}function n(t){return e.post("user/goals",t).then(function(e){return e.entity},u)}function a(){return e.get("user/goals-log",{limit:9e3}).then(function(e){return e.entities},u)}function s(t){return e.post("user/goals-log",{goal_id:t.id,log_timestamp:i.logTimestampValueFromDate()}).then(function(e){return e.entity},u)}function l(t){return e.delete("user/goals-log/"+t.id).then(function(e){return 200==e.status},u)}function c(t){return e.put("user/goals-log/"+t.id,{goal_id:t.goal.id,achieved:+t.achieved,log_timestamp:i.logTimestampValueFromDate()}).then(function(e){return e.entity},u)}function d(t){return e.put("user/goals/"+t.goal.id,{name:t.newGoal.name}).then(function(e){return e.entity},u)}function u(e){throw e}return{getUserGoals:o,createUserGoal:n,getLog:a,createLogItem:s,removeLogItem:l,editLogItem:d,toggleLogItemStatus:c,updateGoal:r}}])},function(e,t){e.exports='<div class="panel my-health-goals"> <div class=panel-body> <h4 ng-if=!$ctrl.demoMode class=padding-15>Health Goals</h4> <div ng-if=!$ctrl.demoMode class=my-health-goals-top-panel> <h5 class=my-health-goals-top-panel-title>Enter Your Health and Wellness Goals</h5> <div class=row> <div class=col-md-5> <div class="health-goal-group form-group"> <label>Choose Goal</label> <select class=form-control ng-model=$ctrl.selectedGoal ng-options="goal.name for goal in $ctrl.predefinedGoals"> </select> </div> </div> <div class=col-md-6> <div class="health-goal-group form-group"> <label>or Type Goal</label> <input type=text class=form-control ng-model=$ctrl.typedGoal placeholder="Loose 5 pounds this week"> </div> </div> <div class=col-md-1> <button class="btn btn-mint pull-right" title="Add Goal" ng-click=$ctrl.addGoal()> <i class="fa fa-plus"></i> </button> </div> </div> </div> <div class=table-responsive> <network-loader class=margin-top-30 visible=$ctrl.pager.isLoading()></network-loader> <table ng-if=!$ctrl.pager.isLoading() class="table table-striped table-bordered data-table margin-top-30 health-goals-list-table"> <thead> <tr> <th style=width:150px>Date</th> <th>Goal</th> </tr> </thead> <tbody> <tr ng-repeat="healthGoal in $ctrl.iss.getRecords()"> <td>{{healthGoal.log_timestamp | formatTime}}</td> <td style=position:relative> <div ng-show=$ctrl.isLogItemInEditingMode(healthGoal)> <input type=text class="form-control input-sm" ng-model=healthGoal.newGoal.name /> <span ng-show=$ctrl.ivalidGoal style=color:red;font-size:12px>Please fill goal name<br/></span> <button ng-click=$ctrl.editLogItem(healthGoal) class="btn btn-mint-outline">Update</button> <button ng-click=$ctrl.switchEditingMode(healthGoal) class="btn btn-red-outline">Cancel</button> </div> <div ng-if=!$ctrl.isLogItemInEditingMode(healthGoal)> {{healthGoal.goal.name}} <div class=health-goal-btns ng-if=!$ctrl.demoMode> <button class="btn btn-mint-outline" ng-click=$ctrl.switchEditingMode(healthGoal)>Edit</button> <button class="btn btn-red-outline" ng-click=$ctrl.removeLogItem(healthGoal)>Delete</button> </div> </div> </td> <td data-ng-if=false> <div class=checkbox-custom> <input type=checkbox ng-model=healthGoal.achieved ng-change=$ctrl.updateLogItemStatus(healthGoal) ng-disabled=$ctrl.demoMode /> <label></label> </div> </td> <td data-ng-if=false ng-class="{italics: !healthGoal.isReached}">{{healthGoal | formatGoalTime}}</td> </tr> </tbody> </table> </div> <a class=load-more-snposts ng-click=$ctrl.iss.loadMore() ng-if=$ctrl.iss.paginationVisible()>Load more</a> </div> </div>'},function(e,t,i){i(202),i(203),angular.module("kw.socialNetwork").component("mySettings",{controller:"MySettingsController",template:i(204)})},function(e,t){!function(){function e(e,t,i,o,r){var n=this,a=!0,s=!0,l=o.getIdentity().id;n.userSettings={},n.user={receive_emails:!1,posts_newsletter:!1},n.userSettingsFieldsDisabled=function(){return a},n.notificationsSettingsDisabled=function(){return s},n._loadPageData=function(){e.all([t.get(),o.getUser()]).then(function(e){n.userSettings=angular.extend(e[0]);for(var t in n.user)n.user[t]=e[1][t];console.log(n.user),a=!1,s=!1})},n.updateVisibilitySettings=function(){a=!0,t.update(n.userSettings).then(function(){r.addToQueue("Settings updated","success")}).catch(function(){r.addToQueue("Settings wasn't updated","danger")}).finally(function(){a=!1})},n.updateNotificationSettings=function(){notificationsSettingsDisabled=!0,i.update(l,n.user).then(function(){r.addToQueue("Settings updated","success")}).catch(function(){r.addToQueue("Settings wasn't updated","danger")}).finally(function(){notificationsSettingsDisabled=!1})},n.$onInit=function(){n._loadPageData()}}e.$inject=["$q","UserSettingsService","UsersResource","CurrentUser","NotificationManager"],angular.module("kw.socialNetwork").controller("MySettingsController",e)}()},function(e,t){!function(){function e(e){this.get=function(){return e.get("user/settings").then(function(e){return e.entity})},this.update=function(t){return e.put("user/settings",t).then(function(e){return e.entity})}}e.$inject=["ApiRequest"],angular.module("kw.socialNetwork").service("UserSettingsService",e)}()},function(e,t){e.exports='<div class="panel my-settings"> <div class=panel-body> <div class=clearfix> <h4 class=pull-left>Settings</h4> <a ui-sref="userProfile({username: $root.CurrentUser.getIdentity().username})" class="btn btn-mint pull-right">Preview My Profile</a> </div> <h4 class=text-blue>Visible on my profile page</h4> <div class=row> <div class=col-md-3> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=biometricData ng-model=$ctrl.userSettings.biometric_data_visible ng-change=$ctrl.updateVisibilitySettings() ng-disabled=$ctrl.userSettingsFieldsDisabled() /> <label for=biometricData>Biometric Data</label> </div> </div> <div class=col-md-3> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=exerciseLog ng-model=$ctrl.userSettings.exercise_log_visible ng-change=$ctrl.updateVisibilitySettings() ng-disabled=$ctrl.userSettingsFieldsDisabled() /> <label for=exerciseLog>Exercise Log</label> </div> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=dietLog ng-model=$ctrl.userSettings.diet_log_visible ng-change=$ctrl.updateVisibilitySettings() ng-disabled=$ctrl.userSettingsFieldsDisabled() /> <label for=dietLog>Diet Log</label> </div> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=medicationLog ng-model=$ctrl.userSettings.medication_log_visible ng-change=$ctrl.updateVisibilitySettings() ng-disabled=$ctrl.userSettingsFieldsDisabled() /> <label for=medicationLog>Medication Log</label> </div> </div> <div class=col-md-3> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=healthGoals ng-model=$ctrl.userSettings.health_goals_visible ng-change=$ctrl.updateVisibilitySettings() ng-disabled=$ctrl.userSettingsFieldsDisabled() /> <label for=healthGoals>Health Goals</label> </div> </div> </div> <h4 class=text-blue>Notifications</h4> <div class=row> <div class=col-xs-12> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=newPosts ng-model=$ctrl.user.receive_emails ng-change=$ctrl.updateNotificationSettings() ng-disabled=$ctrl.notificationsSettingsDisabled() /> <label for=newPosts>New Education Posts</label> </div> </div> <div class=col-xs-12> <div class="checkbox-custom checkbox-lg checkbox-success"> <input type=checkbox id=networkUpdates ng-model=$ctrl.user.posts_newsletter ng-change=$ctrl.updateNotificationSettings() ng-disabled=$ctrl.notificationsSettingsDisabled() /> <label for=networkUpdates>Health Network Updates</label> </div> </div> </div> </div> </div>'},function(e,t){e.exports='<div class=page-header> <h1 class=page-title>My Account</h1> </div> <div class=page-content> <div class=row> <div class=col-md-3> <div class=panel> <div class="panel-body left-menu-container"> <ul class="list-group nav left-menu"> <li class=list-group-item ui-sref-active=active> <a ui-sref=my-account.profile> <i class=snsprite-profile></i> Profile </a> </li> <li class=list-group-item ui-sref-active=active> <a ui-sref=my-account.health-goals> <i class=snsprite-health_goals></i> Health Goals </a> </li> <li class=list-group-item ui-sref-active=active> <a ui-sref=my-account.settings> <i class=snsprite-settings></i> Settings </a> </li> <li class="list-group-item my-account-logout-link" ui-sref-active=active> <a ng-click=$root.logout()> <i class=snsprite-logout></i> Logout </a> </li> </ul> </div> </div> </div> <div class=col-md-9> <div ui-view></div> </div> </div> </div>'},function(e,t,i){i(207),angular.module("kw.socialNetwork").component("userProfile",{controller:"UserProfileController",bindings:{},template:i(208)})},function(e,t){!function(){function e(e,t,i,o,r,n){var a=this,s=!1,l=["biometric_data","exercise_log","diet_log","medication_log","health_goals"],c=null;a.vSettings=null,a.counters=null,a.profile=null,a.currUser=null,a.profileUsername=null,a.extendedProfileReady=function(){return s},a.profileReady=function(){return!!a.profile},a.profilePropertyVisible=function(e){return a.vSettings&&!!a.vSettings[e+"_visible"]},a.getProfile=function(){return a.currUser=i.getIdentity(),a.profileUsername=e.username,a.profileUsername===a.currUser.username?i.getUser():t.find(e.username,"username").then(function(e){return e.entity})},a.getExtendedProfile=function(){t.profile(e.username).then(function(e){a.counters=e.counters,a.vSettings=e.visiblitySettings,s=!0})},a.areAllLogsHidden=function(){return!l.map(function(e){return a.profilePropertyVisible(e)}).some(function(e){return e})},a.statsShown=function(e){return c===e},a.showStats=function(e){c=e},a.statsNotChosen=function(){return!c},a.$onInit=function(){a.getProfile().then(function(e){a.profile=e}),a.getExtendedProfile()}}e.$inject=["$stateParams","UsersResource","CurrentUser","PostEditor","partnersRepository","enums"],angular.module("kw.socialNetwork").controller("UserProfileController",e)}()},function(e,t){e.exports='<div class=page-header> <h1 class=page-title>Health Profile</h1> <div class=page-header-actions> <a ui-sref=partners class="btn btn-round btn-inverse" ng-if="$ctrl.profileUsername !== $ctrl.currUser.username">Back to partners</a> </div> </div> <div class="page-content user-profile"> <div class=row> <div class=col-md-3> <div class=panel> <div class=panel-body> <network-loader visible=!$ctrl.profileReady()></network-loader> <u-avatar user=$ctrl.profile class=avatar-nocursor ng-if=$ctrl.profileReady()></u-avatar> <div class=profile-short-info ng-if=$ctrl.profileReady()> <h3 class=profile-user-name>{{$ctrl.profile.name}}</h3> <h4 class=profile-occupation ng-if="$ctrl.profilePropertyVisible(\'occupation\')">{{$ctrl.profile.occupation}}</h4> <div class=profile-introduction ng-if="$ctrl.profilePropertyVisible(\'introduction\')">{{$ctrl.profile.introduction}}</div> </div> <network-loader visible=!$ctrl.extendedProfileReady()></network-loader> <table class=profile-extended-info ng-if=$ctrl.extendedProfileReady()> <tr ng-if="$ctrl.profilePropertyVisible(\'birthday\')"> <td><i class="fa fa-birthday-cake"></i></td> <td>{{$ctrl.profile.birthday | formatTime:"MMM DD, YYYY"}}</td> </tr> <tr ng-if="$ctrl.profilePropertyVisible(\'phone\')"> <td><i class="fa fa-mobile"></i></td> <td>{{$ctrl.profile.phone}}</td> </tr> <tr ng-if="$ctrl.profilePropertyVisible(\'email\')"> <td><i class="fa fa-envelope-square"></i></td> <td>{{$ctrl.profile.email}}</td> </tr> <tr ng-if="$ctrl.profilePropertyVisible(\'country\')"> <td><i class="fa fa-map-marker"></i></td> <td>{{$ctrl.profile | userLocation}}</td> </tr> </table> <div class=profile-counters-list ng-if=$ctrl.extendedProfileReady()> <div class=profile-counter> <div class=profile-counter-number>{{$ctrl.counters.partners}}</div> Partners </div> <div class=profile-counter> <div class=profile-counter-number>{{$ctrl.counters.posts}}</div> Posts </div> <div class=profile-counter> <div class=profile-counter-number>{{$ctrl.counters.shares}}</div> Shares </div> </div> </div> </div> </div> <div class=col-md-9> <div class=panel ng-if=!$ctrl.areAllLogsHidden()> <div class="panel-body user-logs-tabbed"> <ul class="nav nav-tabs nav-tabs-line"> <li class="nav-item uib-tab" ng-if="$ctrl.profilePropertyVisible(\'biometric_data\')" ng-class="{active: $ctrl.statsShown(\'biometric_data\')}"> <a ng-click="$ctrl.showStats(\'biometric_data\')" class=nav-link>Biometric Data</a> </li> <li class="nav-item uib-tab" ng-if="$ctrl.profilePropertyVisible(\'exercise_log\')" ng-class="{active: $ctrl.statsShown(\'exercise_log\')}"> <a ng-click="$ctrl.showStats(\'exercise_log\')" class=nav-link>Exercise Log</a> </li> <li class="nav-item uib-tab" ng-if="$ctrl.profilePropertyVisible(\'diet_log\')" ng-class="{active: $ctrl.statsShown(\'diet_log\')}"> <a ng-click="$ctrl.showStats(\'diet_log\')" class=nav-link>Diet Log</a> </li> <li class="nav-item uib-tab" ng-if="$ctrl.profilePropertyVisible(\'medication_log\')" ng-class="{active: $ctrl.statsShown(\'medication_log\')}"> <a ng-click="$ctrl.showStats(\'medication_log\')" class=nav-link>Medication Log</a> </li> <li class="nav-item uib-tab" ng-if="$ctrl.profilePropertyVisible(\'health_goals\')" ng-class="{active: $ctrl.statsShown(\'health_goals\')}"> <a ng-click="$ctrl.showStats(\'health_goals\')" class=nav-link>Health Goals Log</a> </li> </ul> <div class=tab-content> <div class="tab-pane active" ng-if="$ctrl.statsShown(\'biometric_data\')"> <biometrics demo-mode=true hide-alerts=true user-id=$ctrl.profile.id></biometrics> </div> <div class="tab-pane active" ng-if="$ctrl.statsShown(\'exercise_log\')"> <exercise-log demo-mode=true hide-alerts=true user-id=$ctrl.profile.id></exercise-log> </div> <div class="tab-pane active" ng-if="$ctrl.statsShown(\'diet_log\')"> <diet-log demo-mode=true hide-alerts=true user-id=$ctrl.profile.id></diet-log> </div> <div class="tab-pane active" ng-if="$ctrl.statsShown(\'medication_log\')"> <medication-log demo-mode=true hide-alerts=true user-id=$ctrl.profile.id></medication-log> </div> <div class="tab-pane active" ng-if="$ctrl.statsShown(\'health_goals\')"> <my-health-goals demo-mode=true hide-alerts=true user-id=$ctrl.profile.id></my-health-goals> </div> </div> <div class=well ng-if=$ctrl.statsNotChosen()> Choose user log </div> </div> </div> <div class=well ng-if=$ctrl.areAllLogsHidden()> All logs were hidden from other users </div> </div> </div> </div>'}]);
//# sourceMappingURL=network.min.js.map