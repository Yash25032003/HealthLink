function populatePostObject(e,t){var n={token:e.authResponse.accessToken,userId:e.authResponse.userID};return t.hasOwnProperty("name")&&(n.name=t.name),t.hasOwnProperty("gender")&&(n.sex="male"===t.gender?"1":"0"),t.hasOwnProperty("email")&&(n.email=t.email),n}function addPartnerByInvitationKeyAfterLogin(){var e=localStorage.getItem("invitation_key");null!==e?ApiInvoke.post("user/partners/add-partner-request-via-email",{invitation_key:e}).then(function(e){redirectToHomeAfterLogin()},redirectToHomeAfterLogin):redirectToHomeAfterLogin()}function redirectToHomeAfterLogin(){delete window.localStorage.invitation_key,location.href="/"}function addErrorAfterElement(e,t){var n='<div class="alert alert-warning alert-dismissible fade in" role="alert" id="form-error"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button><span id="login-error">'+t+"</span></div>";$(e).after(n)}function createCommentElement(e,t){var n="";return n+=t?'<div class="post-comment-children">':'<div class="post-comment">',n+='<img src="'+e.user.avatar+'" alt="" class="post-comment-avatar"><div class="post-comment-content"><a href="" class="post-comment-username">'+e.user.name+'</a><div class="post-comment-time">Just now</div><div class="post-comment-body">'+e.message+"</div>",e.level<3&&(n+='<a href="" class="post-comment-reply">Reply</a>'+generateFormMessage(e.id)),n+="</div></div></div>"}function generateFormMessage(e){return'<div class="post-reply-comment"><form class="reply-comment-form"><div class="row"><div class="col-xs-12 mb-sm"><textarea class="form-control post-new-comment-body" placeholder="Message" name="message"></textarea></div>\t<div class="col-xs-12 mb-sm text-center"><input type="hidden" name="parent_id" value="'+e+'" /><button class="btn btn-blue post-new-comment-btn" type="submit">Post comment</button></div></div></form></div>'}function addCommentMessageAndClearFormInput(e,t,n){n===!0?t.message="New reply is added successfully":t.message="New comment is added successfully",addErrorToForm($(e),t),$(e).find("textarea").val("");var o=parseInt($("#comments-counter").text());o+=1,$("#comments-counter").text(o)}function addYouTubeScript(){var e=document.createElement("script");e.src="//www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t);var n=document.getElementById("player");$(n).hide();var o=document.getElementById("thumbnail");null!==o&&(o.src="img/coming-soon-thumb.png")}$(document).ready(function(){function e(e){var t=e.attr("class"),n=t.match(/icon-[\w\d-]+_n/);if(n){n=n[0];var o=n.replace(/_n$/,"_s");e.addClass(o)}}function t(e){var t=e.attr("class"),n=t.match(/icon-[\w\d-]+_s/);n&&(hoveredClass=n[0],e.removeClass(hoveredClass))}var n=!1;$("#logout-btn").on("click",function(e){e.preventDefault(),ApiInvoke.post("auth/logout").then(function(){localStorage.removeItem("sessionId"),location.reload()})}),$(".icon").hover(function(t){n||e($(this))},function(){n||t($(this))}),$(".btn").hover(function(t){var o=$(this).find(".icon");n=!0,o.length&&e(o)},function(){var e=$(this).find(".icon");n=!1,e.length&&t(e)});var o=$(".s-navbar");$(".s-header-hamburger").on("click",function(){var e=$(this).find(".icon");o.toggleClass("m-open"),e.toggleClass("icon-s-menu-hamburger"),e.toggleClass("icon-s-menu-close")}),$(".s-dropdown > .btn").on("click",function(e){$(this).parent().hasClass("open")?$(this).parent().removeClass("open"):($(".s-dropdown").removeClass("open"),$(this).parent().addClass("open")),$(window).width()<768&&$(this).next().children().length>0&&e.preventDefault()});var a=$("body"),i=$(".loader-overlay");a.addClass("body-hidden"),0===i.length&&a.removeClass("body-hidden"),$(window).load(function(){i.length>0&&i.addClass("animated").addClass("bounceOutUp").one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){$(this).remove(),a.removeClass("body-hidden")}),window.siteAnimations&&siteAnimations()})}),function(){function e(e,t,n,o){var a=new jQuery.Deferred;o=o||{};var i={contentType:"undefined"!=typeof o.contentType?o.contentType:"application/json",processData:"undefined"!=typeof o.processData&&o.processData,type:e,url:API_URL+t,data:o.data||JSON.stringify(n),dataType:"json"};return localStorage.sessionId&&(i.headers={Authorization:localStorage.sessionId}),$(".request-loader").show(),$.ajax(i).then(function(e){200!=e.status?a.reject(e):a.resolve(e),$(".request-loader").hide()},function(e){$(".request-loader").hide(),a.reject(e.responseJSON)}),a.promise()}e.get=function(t,n){return e("GET",t,n)},e.post=function(t,n){return e("POST",t,n)},e.put=function(t,n){return e("PUT",t,n)},e.file=function(t){return e("POST","media/upload",null,{data:t,contentType:!1,processData:!1})},e.uploadAvatar=function(t){return e("POST","users/upload",null,{data:t,contentType:!1,processData:!1})},window.ApiInvoke=e}(),function(){function e(e){return{find:function(t,n){return ApiInvoke.get(e+"/"+t).then(function(e){return e.entity})},search:function(t){return ApiInvoke.get(e,t||{}).then(function(e){return e.entities})},create:function(t){return ApiInvoke.post(e,t).then(function(e){return e.entity})},update:function(t,n){return ApiInvoke.put(e+"/"+t,n).then(function(e){return e.entity})},"delete":function(t){return ApiInvoke["delete"](e+"/"+t).then(function(e){return 200===e.status})},save:function(e){return e.id?this.update(e.id,e):this.create(e)}}}window.Resource=e}();var Slider=function(){function e(e){var t=this;t.onPaginationItemClick=function(){var e=$(this).data("i");t.selectSlide(+e),t.resetAndLaunchTimer()},t.resetAndLaunchTimer=function(){clearInterval(t._timer),t._timer=setInterval(function(){t.selectSlide(t._currentSliderIndex+1)},e.interval)},t.init(e)}return e.prototype={init:function(e){this.slideClass=e.slideClass,this.$container=e.$container,this.$paginationContainer=e.$paginationContainer,this.transitionDuration=e.transitionDuration||100,this._currentSliderIndex=0,this._slidesCount=this.$container.find("."+this.slideClass).length,this._timer=null,this.makePaginationItems(this._slidesCount),this.selectSlide(0),this.addEvents(),this.resetAndLaunchTimer()},addEvents:function(){this.$paginationContainer.on("click",".item",this.onPaginationItemClick)},makePaginationItems:function(e){for(var t="",n=0;n<e;n++)t+='<span class="item" data-i="'+n+'"></span>';this.$paginationContainer.html(t)},selectSlide:function(e){var t=this;e=(e||0)%this._slidesCount;var n=this.$container.find("."+this.slideClass),o=$(n.get(this._currentSliderIndex)),a=$(n.get(e));o.fadeOut(t.transitionDuration,"linear",function(){a.fadeIn(t.transitionDuration,"linear")});var i=this.$paginationContainer.find(".item");i.removeClass("active"),$(i.get(e)).addClass("active"),this._currentSliderIndex=e}},e}(),siteAnimations=function(){function e(){$(".hp-lead-title:in-viewport").addClass("animated").addClass("fadeIn"),$(window).bind("scroll",function(){$(".ipad:in-viewport").addClass("animated").addClass("zoomIn"),$(".intro-tips:in-viewport").find(".intro-tips-item.left").addClass("fadeInLeft"),$(".intro-tips:in-viewport").find(".intro-tips-item.right").addClass("fadeInRight"),$(".solution-tips:in-viewport").find(".solution-tips-item").addClass("fadeInDown"),$(".user-story:in-viewport").find(".user-story-descr").addClass("fadeIn").addClass("animated"),$(".user-story:in-viewport").find(".user-story-video").addClass("fadeIn").addClass("animated"),$(".hp-news-items:in-viewport").find(".hp-news-item").addClass("fadeIn").addClass("animated");var e=$(".cs-timeline");$(".cs-timeline:in-viewport").find(".cs-timeline-progress").css({width:100-e.data("progress")+"%"}),$(".cs-timeline-mobile:in-viewport").addClass("fadeInDown").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){var t=600,n=+e.data("progress"),o=t/n,a=0,i=$(this).find(".cs-timeline-progress-number"),r=setInterval(function(){return a===n?void clearInterval(r):void i.text(++a)},o)})})}return e}();$(document).ready(function(){$("#scroll-to-begin").on("click",function(e){var t=500,n=8,o=$(window).height()/2,a=o/(t/n),i=0,r=setInterval(function(){i++;var e=i*a;$("body").scrollTop(e),e>o&&clearInterval(r)},n);e.preventDefault()}),$(".teaser").on("click",function(){$(this).parent().find(".teaser").removeClass("active"),$(this).toggleClass("active")})}),function(){function e(e){if(console.log(e),!e)return null;var t=e.data,n="";$(".has-error").removeClass("has-error").find(".help-block").text("");for(var o=0,a=t.length;o<a;o++){var i=$(".auth-field-"+t[o].property);i.parent().find(".help-block").text(t[o].message),i.parent().addClass("has-error")}$(".form-messages").html(n)}function t(e){var t,n,o=decodeURIComponent(window.location.search.substring(1)),a=o.split("&");for(n=0;n<a.length;n++)if(t=a[n].split("="),t[0]===e)return void 0===t[1]||t[1]}function n(e,t){if($("#form-error").length)$("#login-error").html(t.message),$(".alert-warning").show();else{var n='<div class="alert alert-warning alert-dismissible fade in" role="alert" id="form-error"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button><span id="login-error">'+t.message+"</span></div>";$(e).prepend(n)}}function o(){var e=getParameterByName("invitation_key");null!==e&&"undefined"!=typeof Storage&&localStorage.setItem("invitation_key",e)}function a(){var e=localStorage.getItem("invitation_key");null!==e?ApiInvoke.post("user/partners/add-partner-request-via-email",{invitation_key:e}).then(function(e){i()},i):i()}function i(){delete window.localStorage.invitation_key,location.href="/"}o(),$("#registrationForm").on("submit",function(t){t.preventDefault();var o=$(this).serializeObject();ApiInvoke.post("auth/register",o).then(function(e){var t={message:"We have sent an activation email to your email address. Please follow the instructions in the email to activate your account"};n($("#registrationForm"),t)},e)}),$("#loginForm").on("submit",function(e){e.preventDefault();var t=$(this).serializeObject();ApiInvoke.post("auth/login",t).then(function(e){return localStorage.sessionId=e.session_id,document.referrer.indexOf("social-network")>-1?void(location.href=document.referrer):void a()},function(e){n($("#loginForm"),e)})}),$("#forgotPasswordForm").on("submit",function(e){e.preventDefault();var t=$(this).serializeObject();ApiInvoke.post("auth/forgot-password",t).then(function(e){$("#forgotPasswordForm").hide(),$(".loginbox-body-text").html(e.message)},function(e){n($("#forgotPasswordForm"),e)})}),$("#resetPasswordForm").on("submit",function(n){n.preventDefault();var o=t("user_id"),a=t("recovery_key");$("#user_id").val(o),$("#recovery_key").val(a);var i=$(this).serializeObject();ApiInvoke.post("auth/reset-forgotten-password",i).then(function(e){$("#resetPasswordForm").hide(),$(".loginbox-body-text").html(e.message)},e)})}(),window.fbAsyncInit=function(){FB.init({appId:window.FACEBOOK_APP_ID,cookie:!0,xfbml:!0,version:"v2.5"})},function(e,t,n){var o,a=e.getElementsByTagName(t)[0];e.getElementById(n)||(o=e.createElement(t),o.id=n,o.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(o,a))}(document,"script","facebook-jssdk"),$(document).ready(function(){$("#facebook-login-button").click(function(){FB.login(function(e){FB.api("/me?fields=id,name,gender,picture,email",function(t){if(console.log(t),"connected"===e.status){var n=populatePostObject(e,t);ApiInvoke.post("auth/login-facebook",n).then(function(e){localStorage.sessionId=e.session_id,addPartnerByInvitationKeyAfterLogin()},function(e){console.log(e)})}else"not_authorized"===e.status})},{scope:"public_profile,email"})})}),$(document).ready(function(){if($(".blogpage-slider")){new Slider({$container:$(".blogpage-slider"),$paginationContainer:$(".blogpage-slider-pagination"),slideClass:"blogpage-slider-item",interval:15e3,transitionDuration:200})}if($(".newspage-slider")){new Slider({$container:$(".newspage-slider"),$paginationContainer:$(".newspage-slider-pagination"),slideClass:"newspage-slider-item",interval:15e3,transitionDuration:200})}}),/(education|blog|medical-cannabis)\/.*/.test(location.href)&&$(document).ready(function(){var e=+$(".post-entity").attr("id").match(/post-id-(\d+)/)[1];console.log("Post id: "+e),$("#new-comment-form").on("submit",function(t){t.preventDefault();var n="posts/"+e+"/comments",o=$(this).serializeObject();ApiInvoke.post(n,o).then(function(e){console.log(e);var t=createCommentElement(e.entity,!0);$(".post-comments-list").append(t),addCommentMessageAndClearFormInput($("#new-comment-form"),e)},function(e){"undefined"==typeof e&&(e={},e.message="Please login to add comment"),addErrorToForm($("#new-comment-form"),e)})}),$(".post-comments-list").on("submit",".reply-comment-form",function(t){t.preventDefault();var n=$(this),o="posts/"+e+"/comments",a=$(this).serializeObject();a.parent_id=parseInt(a.parent_id),ApiInvoke.post(o,a).then(function(e){console.log(n);var t=createCommentElement(e.entity,!0);n.closest(".post-comment-content").append(t),n.parent().hide(),addCommentMessageAndClearFormInput(n,e,!0)},function(e){"undefined"==typeof e&&(e={},e.message="Please login to add comment"),addErrorToForm($(n),e)})}),localStorage.sessionId||($(".post-new-comment").hide(),addErrorAfterElement($(".post-new-comment-title"),"You need to login to post a comment")),$(".post-comments-list").on("click",".post-comment-reply",function(e){if(e.preventDefault(),localStorage.sessionId){var t=$(this).next();$(t).toggle()}else addErrorAfterElement($(this),"You need to login to post a reply")}),$(".twitter-button").click(function(){var e=URL_TWITTER_TWEET+"url="+CURRENT_URL+"&text="+TEXT_TWWET_TITLE+"&hashtags="+TEXT_TWWET_HASHTAG;$(this).attr("href",e)}),$(".facebook-share-button").click(function(){FB.ui({method:"share",display:"popup",href:CURRENT_URL},function(e){if("object"==typeof e&&e.hasOwnProperty("post_id")&&e.post_id>0){var t=parseInt($(".facebook-count").text());$(".facebook-count").text(++t)}})}),$(".karwell-share-button").click(function(){var t=$(".post-tags");localStorage.sessionId||addErrorAfterElement(t,"You need to login to post a reply");var n={post_id:e};ApiInvoke.put("shares",n).then(function(e){console.log(e),$(".healthlink-count").text(e.entity.count)},function(e){console.log(e),addErrorAfterElement(t,"You need to login to post a reply")})})}),function(){$(".faq-accordion .faq-item-content, .faq-accordion .faq-list").hide(),$(".faq-accordion>.faq-item-icon").removeClass("closed").addClass("closed"),$(".faq-accordion .faq-item-title").on("click",function(e){$(this).parent().find(".faq-item-content, .faq-list").toggle(),$(this).parents(".faq-accordion").find(".faq-item-icon").toggleClass("closed").toggleClass("leaf-md")})}(),$(document).ready(function(){$(".form-subscribe, .form-subscribe-launch").on("submit",function(e){e.preventDefault();var t=$(this),n=$(this).serializeObject(),o=$(this).attr("class");if("form-subscribe"===o)var a="subscribe";else if("form-subscribe-launch"===o)var a="subscribe-launch";ApiInvoke.post(a,n).then(function(e){e.message="Please check your inbox and confirm your email!",addMessageAndClearFormInput(t,e)},function(e){addErrorToForm($(t),e.data[0])})}),$(document).on("click",".start-video",function(){$(this).hide(),$("#player").show(),$("#thumbnail_container").hide(),player.playVideo()})}),addYouTubeScript();var screenWidth=$(document).width();if(screenWidth<768)var playerHeight=250;else if(screenWidth<922)var playerHeight=400;else var playerHeight=500;var player,onYouTubeIframeAPIReady=function(){player=new YT.Player("player",{height:playerHeight,width:"100%",videoId:"7A4gm3yB3wA",playerVars:{autoplay:0,rel:0,showinfo:0},events:{onStateChange:onPlayerStateChange}})},onPlayerStateChange=function(e){e.data==YT.PlayerState.ENDED&&$(".start-video").fadeIn("normal")};$(document).ready(function(){$(".contact-form").on("submit",function(e){e.preventDefault();var t=$(this),n=$(this).serializeObject();ApiInvoke.post("contact",n).then(function(e){e.message="Your message has been sent. We will get back to you as soon as we can",addMessageAndClearFormInput(t,e)},function(e){addErrorToForm($(t),e)})})}),function(){function e(e){var t=e.entity.avatar;t?$("#avatar-remove").removeClass("hidden"):(t="/img/empty-avatar.png",$("#avatar-remove").addClass("hidden")),m.css({backgroundImage:"url("+t+"?"+Math.random()+")"}),m.removeClass("processing")}function t(e,t){var n,o=!0;for(n in e)o=o&&e[n]==t[n];return o}function n(){d=l.serializeObject()}function o(){c.attr("disabled",t(d,l.serializeObject()))}function a(e,t,n){e.removeClass("alert-danger").addClass("alert-success").removeClass("hidden").html(t),setTimeout(function(){e.addClass("hidden")},n||1e3)}function i(e,t){e.removeClass("hidden").addClass("alert-danger").removeClass("alert-success").html(t)}if("/profile-settings"===location.pathname){var r=$("#profile-settings-container").data("userid"),s=function(e){return ApiInvoke.put("users/"+r,e)},d=null,l=$("#personal-information-form"),c=$("#updatePersonalInfoBtn"),u={name:255,occupation:255,phone:255,country:255,city:255,state:255,condition:1024,introduction:1024},m=$("#user-avatar");$("#update-password-form").on("submit",function(e){var t=$(this),n=t.serializeObject(),o=t.find(".alert");s(n).then(function(e){t[0].reset(),a(o,"Password updated")},function(e){i(o,e.data?e.data.map(function(e){return"<li>"+e.message})+"</ul>":"Password wasn't updated. Try again.")}),e.preventDefault()}),l.on("submit",function(e){var t=$(this),r=t.serializeObject(),d=t.find(".alert"),l=[];if(e.preventDefault(),r.sex=+r.sex,r.phone&&!/^[\d.)(\-\+#]+$/.test(r.phone.trim()))return void i(d,"Phone number should contain only digits and special symbols (brackets, -, +, #)");for(var c in r)"string"==typeof r[c]&&r[c].length>u[c]&&l.push("<b>"+c+"</b> field should be less than "+u[c]+" characters");return l.length>0?void i(d,"<h4>Field entry errors</h4><ul>"+l.map(function(e){return"<li>"+e})+"</ul>"):void s(r).then(function(e){a(d,"Personal data updated"),n(),o()},function(e){console.error(e),i(d,e.data?e.data.map(function(e){return"<li>"+e.message})+"</ul>":"Personal information wasn't updated")})}),$("#avatar-remove").on("click",function(t){s({avatar:null}).then(e),t.preventDefault()}),$("#avatar-section").on("submit",function(t){var n=new FormData(this);document.querySelector("#avatar-uploader").files[0];m.addClass("processing"),ApiInvoke.uploadAvatar(n).then(function(e){return s({avatar:e.file})}).then(e),t.preventDefault()});var f=$("#user-settings-alert");$("#notifications-settings").on("change","input",function(e){var t={};t[this.id]=this.checked,s(t).then(function(){a(f,"Notification settings updated",500)},function(){i(f,"Notification settings wasn't updated")})}),$("#updatePasswordBtn").attr("disabled",!0),$("#updatePersonalInfoBtn").attr("disabled",!0),$("#avatar-update-btn").attr("disabled",!0),$("#avatar-uploader").on("change",function(){$("#avatar-update-btn").attr("disabled",!1)}),$("#update-password-form").on("keypress","input",function(){$("#updatePasswordBtn").attr("disabled",!1)}),n(),l.on("change keypress","input, textarea",o)}}();
//# sourceMappingURL=site.min.js.map
